(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"0kg4":function(e,t,a){},"4VdR":function(e,t,a){},"9s7C":function(e,t,a){},AXa2:function(e,t,a){},"E+3K":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAFm0lEQVRoQ92aW2wUVRiAv392e0WFCkp3qZcYHmwioXiJJvCgDxDjA4WokAgmElC0Qlt90FbQNCIUfdBtAQVEwQgmgAmtD2rgQR7AGwRqMJFEYlTKDmoREGhp3Z3fnGGXtMteptsuZZ2nzc6cc/5vzn8/IwzDVbFDS5w/mK5RHkK4U5WJIpShXO9OL5xT5bQIx1COio+vrPHs6ZwjPUNdXrKd4NZ3tSwaodpxqEaYoUpp4lwiXDT/qVKc5F43ym7Lot3np/33GjmdjSyDBghu0FLt5UV1eAkuvWGBHoU9YvG5OPziE2wdRbhzkfxt7lds0hvlAsGoElCLO9ThEYHpCiUxoc+JxVtSxNvhxdI9GBDPAI/vUN8+m4WqNAEBhKjAdrHYSSG7B7uweRH0MUMdHleYi+IDbBGapgX4YOcciXoB8QRQ8Z5OiPbSpnCv+8aFdvw02s/LT14WyfRMYJ1WEqFZlerYjh70FTGr8zk5kWlsRoCKtXp/JMIu89YFDomP2vBS2Z9p4mzuB9foVI3SqnC32Q2/n9mdS+S7dHOlBQiEdD7C+8YIRdhWdAOLfl0grmHm6rp9sxb3/sMmVea5TkB52q6XranWSwlghFf4GHAsWBaul9W5EjrZvMGQNjiwErAEnkwFkRTAqE00yl5VCrGYe7JWPr2awsfXKm/Vx3DYLkKfz8eDydTpCgBjsJFeDhidtywawrXy5kgIH18z2KovOw5m921/EfclGvYAANdVhvnWeBuj83adzB9J4eNrB1p0q2sTcHBakAf6u9gBAIEWfUaVDcbbFI1maq4N1uvLcQ37LPuNdxJhsV0nG+NjLwOYwOL0cMxVHR/TcuUqvQqd+JxxsU6UfUaVrBImxgPnZYBAqy5XhxUmSNl1MivbhXI5LtCibSbYicWrdq28EQt6YBKzvj5+QygVP5OSRdgpy/RRx2EdyvhcCinCGVEaD6+W9YnrmIitEY6gdBcWcptJAN0dmNCqT0UdNovwiV0n85IJWNWgfwFlwNFcAqhQKXC+o1lGJ1sn0KLbVHnCZ7HgRK1scQECId2lMMvyMTu8VNqSDZzcoCrCqY5mGTelUW8aXcTpvU0SMb8PraJLRHRKkwYPN0l4KIBVDXoGYVRHsxQkDXBrdJYTZZdAm10vs8UUI1GbLhSREsalyirjAAKVqtgKH/mFjRHlG7F4AYiow1rLYuHhVfJhthBVjXoWKE0JYNL5HroQ1BdgnATX6EwnSjvw2cl6cbNBDzvwGsrXhcV833uR5SJssXz0RqLUFFqEDqyU41kDZNgBM295SI28My0f1RJo0ZAqdWLxrF0rG9IBIJy3oCZb4byMM3EIoSDVDrgq36qL1WG9QMgAfKHKwxbMCNfLnrQAXiQYhmdEiKQDCIZ0ugO7RfhSykP6MzCxQJh0vE5+zKBC3aq8PuAZoQBlRcwnL1eIDJFhiQjl6QBuadG7/lWOAMfMDnSpMtZ/HWPjNWwmG+h//54mLY1c5IL5r6yYkr1NQ6sXqhrVJJJV6QBMjR05zynjFSUQ0l4Ex66TeIGd0YhHGsC1gxbtQbH+BwDDqEL+MYy5ufRSLyjbKxxmvwiTPavQII3YjcSpVChboRPHZfJCiUbs2Y3GU4lUACJ0KDhDBKkScDy70UBI31Go9xLIMgEMixfyEIkHBLJsUomceiEPAANSicEmc+ls4GrsgNub7Z/MuT51kOn0SO5AMDGdNsIMsaCxFCpjqYTplQ7JiE1Bg/LnD6slkMwZJC1orrGS0gZqOpqvLKxSlpSxFDV/i3oDkPdtlViClL+NLQOQ961FA3HNNXcvtdmbPTV3424rr9vrcYgBBxwWr1ztNnusrb4qqwOO/hB5e8TUX53y9pDvMkQ+H7PGIfL6oLt/UpW3nxokZoZ5+7FHshR3JD+3+Q91tAeb8JtBNAAAAABJRU5ErkJggg=="},I9yi:function(e,t,a){},"K/dW":function(e,t,a){},QUgQ:function(e,t,a){},Qb2f:function(e,t,a){},Takh:function(e,t,a){},VOqB:function(e,t,a){},WjP9:function(e,t,a){},hmue:function(e,t,a){},r7tM:function(e,t,a){"use strict";a.d(t,"a",(function(){return Z}));a("pNMO"),a("4Brf"),a("0oug"),a("+2oP"),a("sMBO"),a("pjDv"),a("tkto"),a("5DmW"),a("27RR"),a("mbEz");var n=a("wCAj"),r=(a("TfFZ"),a("3S7+")),i=(a("L/Qf"),a("2/Rp")),o=(a("qNb/"),a("PArb")),c=a("BkRI"),l=a.n(c),s=(a("pDQq"),a("TeQF"),a("2B1R"),a("rB9j"),a("EnZy"),a("FZtP"),a("4mDm"),a("07d7"),a("5s+n"),a("PKPk"),a("3bBZ"),a("p532"),a("q1tI")),u=a.n(s),d=a("xvlK"),m=a("Nlzp"),p=a("DgvE"),f=a("cu44"),v=a("TL2v"),h=a("2kug"),y=(a("k3Gp"),a("kLXV")),b=(a("QCje"),a("fyUT")),g=(a("8QGh"),a("2fM7")),E=(a("1vPl"),a("5rEg")),w=(a("ma9I"),a("yq1k"),a("SYor"),a("JTJg"),a("i6QF"),a("qePV"),a("z7Xi")),O=a("P2RN");function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function j(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,i=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw r}}return i}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return N(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var x=E.a.TextArea,P=E.a.Search,T=g.a.Option,R=[{title:"填写任务说明"},{title:"添加配置数据"},{title:"选择配置更新的设备"}],L=["待执行","执行中","成功","失败"];function F(e){var t=e.visible,a=e.productId,r=e.onCancel,o=e.configProtoclList,c=e.isDeviceRomote,d=e.getRemoteList,f=e._deviceList,v=e.editData,k=e.protocolFormat,S=D(Object(s.useState)(0),2),C=S[0],N=S[1],L=D(Object(s.useState)(v?{taskExplain:v.taskExplain}:{taskExplain:""}),2),F=L[0],A=L[1],_=D(Object(s.useState)(v?v.protocolSendData||[]:o.map((function(e){return e.defaultPropertyValue||""}))),2),V=_[0],M=_[1],J=D(Object(s.useState)(v&&v.protocolSelection||[]),2),U=J[0],W=J[1],q=D(Object(s.useState)([]),2),Y=q[0],H=q[1],K=D(Object(s.useState)(1),2),Q=K[0],z=K[1],G=D(Object(s.useState)([]),2),Z=G[0],X=G[1],$=D(Object(s.useState)({curDeviceInfoList:[],allDeviceInfoList:[],allDeviceInfoPager:{pageIndex:1,currPageRows:7}}),2),ee=$[0],te=$[1],ae=D(Object(s.useState)([]),2),ne=ae[0],re=ae[1],ie=D(Object(s.useState)(!1),2),oe=ie[0],ce=ie[1],le=D(Object(s.useState)({allList:[],successList:[],errorList:[],errorVisible:!1}),2),se=le[0],ue=le[1],de=D(Object(s.useState)(""),2),me=de[0],pe=de[1],fe=D(Object(s.useState)(!1),2),ve=fe[0],he=fe[1],ye=D(Object(s.useState)({rightAllList:v?v.deviceList:[],rightTempList:v?v.deviceList:[]}),2),be=ye[0],ge=ye[1],Ee=D(Object(s.useState)([]),2),we=Ee[0],Oe=Ee[1],ke=Object(s.useRef)(null),Ie=F.taskExplain,Se=ee.curDeviceInfoList,je=ee.allDeviceInfoList,De=ee.allDeviceInfoPager,Ce=se.allList,Ne=se.successList,xe=se.errorList,Pe=se.errorVisible,Te=be.rightAllList,Re=be.rightTempList,Le=c?1:2,Fe=l()(R);c&&Fe.splice(2,1);var Ae=function(e){Object(m.c)(m.a.getAllDeviceInfo,{productId:a,pageRows:8,pageIndex:e||De.pageIndex}).then((function(e){if(e.data){var t=e.data,a=t.list,n=void 0===a?[]:a,r=t.pager,i=void 0===r?{}:r,o=[].concat(j(je),j(n));n.forEach((function(e){e.key=e.deviceUniqueId})),te({curDeviceInfoList:n,allDeviceInfoPager:i,allDeviceInfoList:o})}}))};Object(s.useEffect)((function(){c||Ae()}),[a,c]);var _e=function(e){var t=m.a.saveRomoteConfig,n={taskExplain:Ie,productId:a,protocolJson:JSON.stringify(1!==k?U.map((function(e){var t=o[e];return delete t._type,delete t._params,delete t._index,delete t.key,I(I({},t),{},{sendData:V[e]})})):V.map((function(e,t){var a=o[t];return delete a._type,delete a._params,delete a._index,delete a.key,I(I({},a),{},{sendData:e})})))};if(c)t=m.a.saveRomoteConfigForDevice,n.deviceList=f;else{if(Te.length<1)return void Object(O.a)({description:"请至少选择一个设备"});n.deviceList=Te.map((function(e){return{deviceId:e.deviceId,deviceUniqueId:e.deviceUniqueId,macAddress:e.macAddress}})),v&&(n.taskId=v.taskId)}Object(m.d)(t,n,{needJson:!0,loading:!0,noInstance:!0}).then((function(t){if(e){var n=t.data;Object(m.c)(m.a.submitRomoteConfig,{taskId:n,productId:a},{loading:!0}).then((function(e){d(1),r()}))}else d(1),r()}))},Ve=function(e){A(I(I({},F),{},{taskExplain:e.target.value.trim()}))},Me=function(e,t){var a=j(V),n=Y.filter((function(e){return e!==t}));a[t]=e,M(a),H(n)},Be=function(e){z(+e),X([]),re([])},Je=function(e){e?(ce(!0),Object(m.c)(m.a.getDeviceInfoByIdOrMacAddress,{productId:a,query:e}).then((function(e){var t=e.data;t.key=t.deviceUniqueId,e.data&&re([t])})).finally((function(){ce(!1)}))):Object(O.a)({description:"请输入查询条件"})},Ue=function(e){var t=j(Te);if(e&&e.trim()){var a=e.trim();t=Te.filter((function(e){var t=e.deviceUniqueId,n=e.macAddress;return t.indexOf(a)>-1||n.indexOf(a)>-1}))}ge(I(I({},be),{},{rightTempList:t}))},We=function(){window.open(m.a.downloadRemoteDeviceTemplateExcel)},qe=function(e){console.log(1);var t=e.target;if(t.files&&t.files.length>0){var n=Object(p.e)(t.files,["xls","xlsx"],1e4),r=n.isOk;n.type,n.size;if(!r)return void Object(O.a)({description:"文件类型或者大小不符合要求"});var i=t.files[0];Object(m.d)(m.a.importRemoteDeviceExcel,{uploadExcel:i,productId:a},{needFormData:!0,loading:!0}).then((function(e){if(e.data){var t=e.data,a=[],n=[];t.forEach((function(e,t){var r=e.errorType,i=e.deviceUniqueId;e.key=i,r?n.push({deviceUniqueId:i,errorType:r,key:i}):a.push(I({},e))})),ue(I(I({},se),{},{allList:t,successList:a,errorList:n})),a.length>0&&(ge({rightAllList:[].concat(a),rightTempList:[].concat(a)}),Oe([])),pe(i.name),he(!0)}}))}},Ye=function(){var e=(1==Q?je:ne).filter((function(e){return Z.includes(e.deviceUniqueId)})),t=Object(p.q)([].concat(j(Te),j(e)),"deviceUniqueId");ke&&(ke.current.input.input.value=""),ge({rightAllList:t,rightTempList:t})},He=function(){if(0!==we.length){var e=Te.filter((function(e){var t=e.key;return!we.includes(t)})),t=Re.filter((function(e){var t=e.key;return!we.includes(t)}));ge(I(I({},be),{},{rightAllList:e,rightTempList:t})),Oe([])}},Ke=[{title:"数据名称",dataIndex:"propertyName",key:"propertyName",width:160},{title:"数据标识",dataIndex:"property",width:240,key:"property"},{title:"数据类型",dataIndex:"_type",key:"_type",width:140},{title:"数据属性",dataIndex:"propertyValueDesc",key:"propertyValueDesc"},{title:"下发数据",dataIndex:"execTime",key:"execTime",width:180,render:function(e,t){var a=t._type,n=t._params,r=t._index,i=t.key,o=null,c=1!==k&&!U.includes(i);switch(a){case"数值型":o=u.a.createElement(b.a,{value:V[r],min:n.min,max:n.max,disabled:c,onChange:function(e){return Me(e,r)},placeholder:"请输入参数"});break;case"字符型":o=u.a.createElement(E.a,{value:V[r],maxLength:30,disabled:c,onChange:function(e){return Me(e.target.value.trim(),r)},placeholder:"请输入参数"});break;default:o=u.a.createElement(g.a,{disabled:c,onChange:function(e){return Me(e,r)},value:V[r]||""},u.a.createElement(T,{key:-1,value:""},"请选择参数"),n&&n.map((function(e,t){return u.a.createElement(T,{key:t+a,value:e.value},e.name)})))}return u.a.createElement("span",{className:"config-send-data ".concat(Y.includes(r)?"warn":"")},o)}}],Qe=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId",width:140},{title:"物理地址",dataIndex:"macAddress",width:140,key:"macAddress"}],ze={selectedRowKeys:U,onChange:function(e){W(e)}},Ge={selectedRowKeys:Z,onChange:function(e){X(e)}},Ze={selectedRowKeys:we,onChange:function(e){Oe(e)}},Xe=1===Q?Se:2===Q?ne:[];return u.a.createElement(y.a,{visible:t,width:1e3,className:"romote-modal",title:"远程配置任务",centered:!0,closable:!1,onOk:null,destroyOnClose:!0,maskClosable:!1,footer:null},u.a.createElement("div",{className:"romote-add-content flex-column"},u.a.createElement(h.a,{type:2,flowLists:Fe,style:{padding:"12px 0"},activeItem:C}),u.a.createElement("div",{className:"content-wrapper flex1"},function(){switch(C){case 0:return u.a.createElement("div",{className:"step-0-wrapper flex-row"},u.a.createElement("div",{className:"step-0-lable"},u.a.createElement("span",{className:"pre-requst-start"},"任务说明")),u.a.createElement("div",{className:"textarea-wrapper flex1"},u.a.createElement(x,{value:Ie,maxLength:100,onChange:Ve,autoSize:{minRows:4,maxRows:6}})),u.a.createElement("div",{className:"count-wrapper"},u.a.createElement("span",null,"".concat(Ie.length,"/100"))));case 1:return u.a.createElement("div",{className:"step-1-wrapper"},u.a.createElement("p",null,1!==k?"请选中需要下发的配置数据，并配置下发数据的值":"该产品使用了CLink标准数据格式（十六进制），需全量下发配置更新数据"),u.a.createElement("div",{className:"table-wrapper"},u.a.createElement(n.a,{columns:Ke,rowSelection:1!==k?ze:null,dataSource:o,scroll:{y:300},pagination:!1})));case 2:return u.a.createElement("div",{className:"step-2-wrapper"},u.a.createElement("div",{className:"device-select-wrapper flex-row"},u.a.createElement("div",{className:"left flex1"},u.a.createElement("p",null,"选择配置更新的设备"),u.a.createElement(g.a,{value:Q,onChange:Be},u.a.createElement(T,{value:1,key:1},"全部设备"),u.a.createElement(T,{value:2,key:2},"通过设备ID/物理地址查找"),u.a.createElement(T,{value:3,key:3},"导入设备列表（本地文件）")),2===Q&&u.a.createElement(P,{enterButton:"查 找",loading:oe,onSearch:Je,maxLength:50,placeholder:"请输入设备ID/物理地址查找"}),3===Q?u.a.createElement("section",{className:"file-upload-area"},u.a.createElement("p",null,"选择本地的设备数据文件上传 ",u.a.createElement("a",{onClick:We},"设备数据模板")),u.a.createElement("p",null,"每次添加最多支持20,000个设备"),ve?u.a.createElement("div",null,u.a.createElement("div",{className:"result-area"},u.a.createElement("h3",null,me||"--"),u.a.createElement("p",null,"共".concat(Ce.length,"条数据")),u.a.createElement("p",null,"".concat(Ne.length,"台设备成功匹配")),u.a.createElement("p",null,"".concat(xe.length,"条数据匹配失败"))),u.a.createElement("div",{className:"tools"},u.a.createElement("a",{onClick:function(){return he(!1)}},"重新上传"),u.a.createElement("a",{onClick:function(){return ue(I(I({},se),{},{errorVisible:!0}))}},"错误日志"))):u.a.createElement("div",null,u.a.createElement("div",{className:"file-input-wrapper"},u.a.createElement(i.a,{type:"primary"},u.a.createElement(w.a,null)," 选择本地设备数据文件"),u.a.createElement("input",{type:"file",onInput:qe,accept:".xls,.xlsx"})),u.a.createElement("p",null,"支持xls，xlsx格式，文件大小不超过10MB"))):2===Q?u.a.createElement(n.a,{columns:Qe,dataSource:Xe,rowSelection:Ge,pagination:!1}):u.a.createElement(n.a,{columns:Qe,dataSource:Xe,rowSelection:Ge,pagination:{total:De.totalRows,defaultCurrent:1,defaultPageSize:De.currPageRows,showQuickJumper:!1,hideOnSinglePage:!0,size:"small",onChange:function(e){return Ae(e)},showTotal:function(e){return u.a.createElement("span",null,"共 ",u.a.createElement("a",null,e)," 条")}}})),u.a.createElement("div",{className:"center"},u.a.createElement(i.a,{type:"primary",disabled:0===Z.length,onClick:Ye},"选择设备")),u.a.createElement("div",{className:"right flex1"},u.a.createElement("p",null,"已选中配置更新的设备"),u.a.createElement(P,{enterButton:"查 找",ref:ke,onSearch:Ue,maxLength:50,placeholder:"请输入设备ID/物理地址查找"}),u.a.createElement("div",{className:"tools-wrapper"},u.a.createElement("a",{className:we.length>0?"":"disable",onClick:He},"取消选中")),u.a.createElement(n.a,{columns:Qe,rowSelection:Ze,dataSource:Re,pagination:{total:Re.length,defaultCurrent:1,defaultPageSize:7,showQuickJumper:!1,hideOnSinglePage:!0,size:"small",showTotal:function(e){return u.a.createElement("span",null,"共 ",u.a.createElement("a",null,e)," 条")}}}))))}}()),u.a.createElement("div",{className:"r-footer"},u.a.createElement("span",null,C>0&&u.a.createElement(i.a,{onClick:function(){return N(C-1)},type:"primary"},"上一步"),u.a.createElement(i.a,{onClick:function(){if(0===C){if(!Ie)return void Object(O.a)({description:"请输入远程配置的备注信息"})}else if(1===C){var e=[];if(1!==k){if(U.length<1)return void Object(O.a)({description:"请至少选择一条配置协议"});U.forEach((function(t){[""," ",null,void 0].includes(V[t])&&e.push(t)}))}else V.forEach((function(t,a){[""," ",null,void 0].includes(t)&&e.push(a)}));if(e.length>0)return Object(O.a)({description:"请为配置协议添加参数"}),void H(e)}else if(2===C&&Te.length<1)return void Object(O.a)({description:"请至少选择一个设备"});C===Le?_e(!c):N(C+1)},type:"primary"},C===Le?"提交执行":"下一步"),u.a.createElement(i.a,{onClick:function(){2===C?_e():r()},type:2===C?"primary":"default"},2===C?"保存":"取消"))),Pe&&u.a.createElement(B,{visible:Pe,errorList:xe,onCancel:function(){return ue(I(I({},se),{},{errorVisible:!1}))}})))}function A(e){var t=e.visible,a=e.record,r=e.statusText,c=e.onCancel,l=e.searchDeviceResult,d=e.isDeviceRomote,f=D(Object(s.useState)({selectType:1,keyWords:"",filterStatus:0}),2),v=f[0],h=f[1],b=D(Object(s.useState)({errorLogVisible:!1,errorLogRecord:{}}),2),w=b[0],O=b[1],k=a.taskId,j=a.taskExplain,C=a.status,N=a.execTime,x=a.protocolConfig,P=a.total,R=a.success,F=a.inExec,A=a.fail,_=a.list,M=void 0===_?[]:_,B=a.pager,J=void 0===B?{}:B,U=v.selectType,W=v.keyWords,q=v.filterStatus,Y=w.errorLogVisible,H=w.errorLogRecord,K=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId",width:200},{title:"物理地址",dataIndex:"macAddress",width:200,key:"macAddress"},{title:"配置结果",dataIndex:"status",key:"status",width:160,render:function(e,t){var a=t.status;return u.a.createElement("span",{className:"verify-statu-".concat(a)},L[a-1])}},{title:"操作",key:"action",width:200,render:function(e,t){var a=t.status,n=t.remoteId;t.receiveMsg,t.errorType;return u.a.createElement("span",null,""+a=="4"?u.a.createElement(u.a.Fragment,null,u.a.createElement("a",{onClick:function(){return function(e){Object(m.c)(m.a.retryByTaskId,{remoteId:e}).then((function(e){z(J.pageIndex)}))}(n)}},"重试"),u.a.createElement(o.a,{type:"vertical"}),u.a.createElement("a",{onClick:function(){return function(e){var t=e.remoteId,a=e.errorType;2==a?Object(m.c)(m.a.getReceiveMsg,{remoteId:t},{loading:!0}).then((function(e){O({errorLogVisible:!0,errorLogRecord:{errorType:a,receiveMsg:e.data&&e.data.receiveMsg}})})):O({errorLogVisible:!0,errorLogRecord:{errorType:a,receiveMsg:null}})}(t)}},"日志")):null)}}],Q=function(e,t){h(I(I({},v),{},S({},t,e)))},z=function(e){var t={};e&&(t.pageIndex=e),W&&(t[1===U?"deviceUniqueId":"macAddress"]=W),q&&(t.status=q),t.taskId=k,l(t)};return u.a.createElement(y.a,{visible:t,width:1e3,className:"romote-modal",title:"远程配置任务",centered:!0,closable:!0,onOk:null,onCancel:c,destroyOnClose:!0,maskClosable:!1,footer:null},u.a.createElement("div",{className:"romote-detail-content height-premit"},u.a.createElement("h3",null,"基础信息"),u.a.createElement("div",{className:"base-info"},u.a.createElement("p",null,u.a.createElement("span",null,"任务ID"),u.a.createElement("span",null,k||"--")),u.a.createElement("p",null,u.a.createElement("span",null,"任务说明"),u.a.createElement("span",null,j||"--")),u.a.createElement("p",null,u.a.createElement("span",null,"任务状态"),u.a.createElement("span",null,r[C]||"--")),u.a.createElement("p",null,u.a.createElement("span",null,"执行时间"),u.a.createElement("span",null,p.a.utcToDev(N)||"--"))),u.a.createElement("h3",null,"配置数据"),u.a.createElement(n.a,{columns:[{title:"数据名称",dataIndex:"propertyName",key:"propertyName",width:200},{title:"数据标识",dataIndex:"property",width:240,key:"property"},{title:"数据类型",dataIndex:"_type",key:"_type",width:120},{title:"数据属性",dataIndex:"propertyValueDesc",key:"propertyValueDesc"},{title:"下发数据",dataIndex:"sendData",key:"sendData",width:140}],dataSource:x||[],pagination:!1}),!d&&u.a.createElement(u.a.Fragment,null,u.a.createElement("h3",null,"配置设备"),u.a.createElement("div",{className:"device-wrapper"},u.a.createElement("div",null,u.a.createElement("h4",null,"配置设备数"),u.a.createElement("p",null,Number.isInteger(P)?P:"--")),u.a.createElement("div",null,u.a.createElement("h4",null,"配置成功"),u.a.createElement("p",null,Number.isInteger(R)?R:"--")),u.a.createElement("div",null,u.a.createElement("h4",null,"执行中"),u.a.createElement("p",null,Number.isInteger(F)?F:"--")),u.a.createElement("div",null,u.a.createElement("h4",null,"配置失败"),u.a.createElement("p",null,Number.isInteger(A)?A:"--")),u.a.createElement("div",null,u.a.createElement("span",{className:0==+A?"disable":"",onClick:+A>0?function(){Object(m.c)(m.a.batchRetry,{taskId:k}).then((function(e){z()}))}:null},"批量重试"))),u.a.createElement("div",{className:"filter-wrapper"},u.a.createElement(g.a,{value:U,onChange:function(e){return Q(e,"selectType")}},u.a.createElement(T,{key:"1",value:1},"设备ID"),u.a.createElement(T,{key:"2",value:2},"物理地址")),u.a.createElement(E.a,{placeholder:"支持精确查询",value:W,maxLength:50,onChange:function(e){return Q(e.target.value,"keyWords")}}),u.a.createElement("span",null,"配置结果"),u.a.createElement(g.a,{value:q,onChange:function(e){return Q(e,"filterStatus")}},u.a.createElement(T,{key:"0",value:0},"全部"),u.a.createElement(T,{key:"1",value:1},"待执行"),u.a.createElement(T,{key:"2",value:2},"执行中"),u.a.createElement(T,{key:"3",value:3},"执行成功"),u.a.createElement(T,{key:"4",value:4},"执行失败")),u.a.createElement(i.a,{type:"primary",onClick:function(){return z()}},"查找"),u.a.createElement(i.a,{type:"primary",onClick:function(){Object(m.c)(m.a.exportTaskResult,{taskId:k}).then((function(e){window.open(m.a.exportTaskResult+"?taskId=".concat(k))}))}},"导出数据")),u.a.createElement(n.a,{columns:K,dataSource:M||[],pagination:{total:J.totalRows,current:J.pageIndex,defaultCurrent:1,defaultPageSize:J.defaultPageRows,showQuickJumper:!1,hideOnSinglePage:!0,size:"small",onChange:function(e){return z(e)},showTotal:function(e){return u.a.createElement("span",null,"共 ",u.a.createElement("a",null,e)," 条")}}}),Y&&u.a.createElement(V,{visible:Y,onCancel:function(){return O({errorLogVisible:!1,errorLogRecord:{}})},record:H}))))}var _=["没问题","下发配置数据失败","上报的配置数据不一致","上报的配置数据在超时时间内未获取到","存在相同的设备在执行远程配置任务","后台数据异常"];function V(e){var t=e.visible,a=e.record,n=e.onCancel,r=a.errorType,i=a.receiveMsg;return u.a.createElement(y.a,{visible:t,width:600,className:"romote-modal",title:"日志",centered:!0,closable:!0,onOk:null,onCancel:n,destroyOnClose:!0,maskClosable:!1,footer:null},u.a.createElement("div",{className:"remote-error-wrapper"},u.a.createElement("div",null,u.a.createElement("label",null,"失败原因：")," ",u.a.createElement("span",null,_[r])),u.a.createElement("div",null,u.a.createElement("label",null,"报文信息："),u.a.createElement("div",{className:"msg-wrap"},function(e){if(!e)return u.a.createElement("h4",null,"无报文信息");var t=JSON.parse(e),a=Object.keys(t);return u.a.createElement(u.a.Fragment,null,u.a.createElement("h4",null,"报文解析列表"),a.map((function(e){return u.a.createElement("div",{className:"log-row"},u.a.createElement("span",{className:"log-left-key"},e),u.a.createElement("span",{className:"log-right-content"},t[e]))})))}(i)))))}var M=["设备ID的长度超过限制","物理地址的长度超限制","设备ID发生重复","物理地址发生重复","设备ID不存在或未联网","物理地址不存在或未联网"];function B(e){var t=e.visible,a=e.errorList,r=e.onCancel,i=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId",width:200},{title:"错误原因",dataIndex:"errorType",width:200,key:"errorType",render:function(e,t){var a=t.errorType;return u.a.createElement("span",null,M[a-1])}}];return u.a.createElement(y.a,{visible:t,width:600,className:"romote-modal",title:"设备导入错误日志",centered:!0,closable:!0,onOk:null,onCancel:r,destroyOnClose:!0,maskClosable:!1,footer:null},u.a.createElement("div",null,u.a.createElement(n.a,{columns:i,dataSource:a||[],pagination:{total:a.length,defaultCurrent:1,defaultPageSize:10,showQuickJumper:!1,hideOnSinglePage:!0,size:"small",showTotal:function(e){return u.a.createElement("span",null,"共 ",u.a.createElement("a",null,e)," 条")}}})))}a("AXa2");var J=a("FC04");function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){q(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,i=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw r}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var K=["平台支持远程更新设备的配置数据，您可以提交远程配置任务，实时对设备的系统参数等数据进行远程更新，并且获取设备配置的更新状态；详细说明可参考文档"],Q=[{title:"创建远程配置任务"},{title:"添加配置数据"},{title:"选择设备"},{title:"执行任务"}],z=["草稿","待执行","执行中","已执行"],G=["","执行中","执行成功","执行失败"];function Z(e){var t=e.productId,a=e.protocolLists,c=void 0===a?[]:a,y=e.remoteType,b=void 0===y?"product":y,g=e.deviceId,E=e.deviceUniqueId,w=e.macAddress,O=Y(Object(s.useState)(!1),2),k=O[0],I=O[1],S=Y(Object(s.useState)({detailVisible:!1,selectRecord:{}}),2),j=S[0],D=S[1],C=Y(Object(s.useState)([]),2),N=C[0],x=C[1],P=Y(Object(s.useState)({pageIndex:1}),2),T=P[0],R=P[1],L=Y(Object(s.useState)({deletevisible:!1,deleteItem:null,deleteLoading:!1}),2),_=L[0],M=L[1],B=Y(Object(s.useState)([]),2),U=B[0],q=B[1],H=Y(Object(s.useState)(0),2),Z=H[0],X=H[1],$=Y(Object(s.useState)(null),2),ee=$[0],te=$[1],ae=Y(Object(s.useState)({errorLogVisible:!1,errorLogRecord:{}}),2),ne=ae[0],re=ae[1],ie=ne.errorLogVisible,oe=ne.errorLogRecord,ce=T.totalRows,le=T.pageIndex,se=T.pageRows,ue=_.deletevisible,de=_.deleteItem,me=_.deleteLoading,pe=j.detailVisible,fe=j.selectRecord,ve="device"===b,he=l()(Q);ve&&he.splice(2,1);var ye=ve?G:z,be=[{title:"任务ID",dataIndex:"taskId",key:"taskId",width:200},{title:"任务说明",dataIndex:"taskExplain",key:"taskExplain"},{title:"更新设备数量",dataIndex:"deviceTotal",key:"deviceTotal",width:180},{title:"任务状态",dataIndex:"status",key:"status",width:180,render:function(e,t){var a=t.status;return u.a.createElement("span",{className:"h5-statu-".concat(a+1)},ye[a])}},{title:"执行时间",dataIndex:"execTime",key:"execTime",width:180,render:function(e,t){var a=t.execTime;return u.a.createElement("span",null,a?p.a.utcToDev(a):"--")}},{title:"操作",key:"action",width:200,render:function(e,t){var a=t.status,n=t.taskId;return ve?u.a.createElement("span",null,u.a.createElement("a",{onClick:function(){return we(t)}},"查看"),""+a=="3"?u.a.createElement(u.a.Fragment,null,u.a.createElement(o.a,{type:"vertical"}),u.a.createElement("a",{onClick:function(){return Se(n)}},"重试"),u.a.createElement(o.a,{type:"vertical"}),u.a.createElement("a",{onClick:function(){return je(t)}},"日志")):null):u.a.createElement("span",null,""+a=="1"?u.a.createElement(u.a.Fragment,null,u.a.createElement("a",{onClick:function(){return Ee(t)}},"编辑"),u.a.createElement(o.a,{type:"vertical"}),u.a.createElement("a",{onClick:function(){return M({deletevisible:!0,deleteItem:t})}},"删除")):u.a.createElement("a",{onClick:function(){return we(t)}},"查看"))}}];ve&&be.splice(2,1);var ge=function(e){var a=m.a.getRomoteConfigListByProduct,n={pageIndex:e||le,pageRows:10};ve?(a=m.a.getRomoteConfigListForDevice,n.deviceId=g):n.productId=t,Object(m.c)(a,n).then((function(e){var t=e.data,a=t.pager,n=void 0===a?{}:a,r=t.list,i=void 0===r?[]:r;x(Object(p.c)(i)),R(n)}))};Object(s.useEffect)((function(){ge()}),[t,le,ve,g]),Object(s.useEffect)((function(){var e=c.filter((function(e){return 5==e.dataType})),t=e[0]&&e[0].list||[],a=e[0]&&e[0].protocolFormat||0;t=(t=t.filter((function(e){return"Base_Null_Reserved_Null"!==e.property}))).map((function(e,t){var a=e.propertyValueDesc,n=null;if(a&&a.indexOf("|")>-1&&(n=a.split("|").map((function(e){var t=e.split("-");return t.length>1?{name:t[1],value:t[0]}:{}}))),a&&a.indexOf("~")>-1){var r=Y(a.split("~"),2);n={min:+r[0],max:+r[1]}}return W(W({},e),{},{_type:Object(p.o)(e),_params:n,_index:t,key:t})})),q(t),X(a)}),[c]);var Ee=function(e){if(e){var t=e.taskId;Oe(t,1).then((function(e){var t=e.data,a=t.taskExplain,n=t.taskId,r=t.protocolJson,i=t.deviceList,o=JSON.parse(r),c=o.map((function(e){return e.property})),l=U.map((function(e){return e.defaultPropertyValue||""})),s=[];U.forEach((function(e,t){var a=e.property,n=c.indexOf(a);n>-1&&(l[t]=o[n].sendData,s.push(t))})),i.forEach((function(e){return e.key=e.deviceUniqueId})),te({taskId:n,taskExplain:a,deviceList:i,protocolSendData:l,protocolSelection:s}),I(!k)}))}else U.length>0&&I(!k)},we=function(e){var t=e.taskId;ve?Object(m.c)(m.a.getRemoteDetailForDevice,{taskId:t},{loading:!0}).then((function(t){var a=t.data.protocolJson;D({detailVisible:!pe,selectRecord:W(W({},e),{},{protocolConfig:JSON.parse(a)})})})):Promise.all([Oe(t,2),ke(t),Ie({taskId:t})]).then((function(t){var a=Y(t,3),n=a[0],r=a[1],i=a[2],o=n.data.protocolJson,c=void 0===o?"[]":o,l=r.data,s=i.data,u=s.list,d=s.pager;D({detailVisible:!pe,selectRecord:W(W(W({},e),{},{protocolConfig:JSON.parse(c)},l),{},{list:u,pager:d})})}))},Oe=function(e,t){return Object(m.c)(m.a.getRemoteDetail,{taskId:e,type:t},{loading:!0})},ke=function(e){return Object(m.c)(m.a.getResultTotal,{taskId:e},{loading:!0})},Ie=function(e){return Object(m.c)(m.a.getDeviceResultList,W({},e),{loading:!0})},Se=function(e){Object(m.c)(m.a.retryByTaskIdForDevice,{taskId:e},{loading:!0}).then((function(e){ge(le)}))},je=function(e){var t=e.taskId,a=e.errorType;2==a?Object(m.c)(m.a.getReceiveMsgForDevice,{taskId:t},{loading:!0}).then((function(e){re({errorLogVisible:!0,errorLogRecord:{errorType:a,receiveMsg:e.data&&e.data.receiveMsg}})})):re({errorLogVisible:!0,errorLogRecord:{errorType:a,receiveMsg:null}})};return u.a.createElement("div",{className:"remote-config-wrapper"},u.a.createElement(f.a,{style:{margin:"0 0 24px",padding:"24px"}},u.a.createElement(v.a,{desc:K}),u.a.createElement("div",{style:{padding:"24px 0 0"},className:"use-service-flow-wrapper"},u.a.createElement(h.a,{type:3,flowLists:he}),u.a.createElement("div",{className:"extra-descs"},u.a.createElement("div",{className:"descs-item"},u.a.createElement("p",null,"创建远程配置任务，填写任务的目的或备注信息")),u.a.createElement("div",{className:"descs-item"},u.a.createElement("p",null,"添加要更新的产品配置数据字段和更新的数值")),!ve&&u.a.createElement("div",{className:"descs-item"},u.a.createElement("p",null,"可通过设备ID/物理地址，设备标签，本地导入确定要配置的设备")),u.a.createElement("div",{className:"descs-item"},u.a.createElement("p",null,"提交执行远程配置任务，设备更新结果实时可见"))))),u.a.createElement("section",{className:"remote-config-manage-wrapper section-bg"},u.a.createElement("h3",null,"远程配置任务",U.length?u.a.createElement(i.a,{style:{float:"right"},type:"primary",onClick:function(){return Ee()}},u.a.createElement(d.a,null),"创建任务"):u.a.createElement(r.a,{title:"无配置协议时不支持创建"},u.a.createElement(i.a,{style:{float:"right"},type:"primary",disabled:!0},u.a.createElement(d.a,null),"创建任务"))),u.a.createElement("div",{className:"table-wrapper"},u.a.createElement(n.a,{columns:be,className:"ant-table-fixed",dataSource:N,pagination:{total:ce,current:le,defaultCurrent:1,defaultPageSize:10,onChange:function(e){return function(e){ge(e)}(e)},showQuickJumper:!0,hideOnSinglePage:!0,showTotal:function(e){return u.a.createElement("span",null,"共 ",u.a.createElement("a",null,e)," 条")}}})),k&&u.a.createElement(F,{visible:k,productId:t,protocolFormat:Z,onCancel:function(){I(!1),te(null)},editData:ee,configProtoclList:U,getRemoteList:ge,isDeviceRomote:ve,_deviceList:[{deviceId:g,deviceUniqueId:E,macAddress:w}]}),pe&&u.a.createElement(A,{visible:pe,record:fe,statusText:ye,isDeviceRomote:ve,searchDeviceResult:function(e){Ie(e).then((function(e){var t=e.data,a=t.list,n=t.pager;D({detailVisible:pe,selectRecord:W(W({},fe),{},{list:a,pager:n})})}))},onCancel:function(){return D({detailVisible:!1,selectRecord:{}})}})),ue&&u.a.createElement(J.a,{visible:ue,modalOKHandle:function(){var e=de.taskId;M(W(W({},_),{},{deleteLoading:!0})),Object(m.c)(m.a.deleteRomoteConfig,{taskId:e}).then((function(e){ge(se>1?le:le-1>0?le-1:1)})).finally((function(){M({deletevisible:!1,deleteItem:null,deleteLoading:!1})}))},modalCancelHandle:function(){return M({deletevisible:!1,deleteItem:null,deleteLoading:!1})},targetName:de.taskId,confirmLoading:me,title:"删除任务",needWarnIcon:!0,descText:"即将删除的任务",tipText:"任务的所有信息将完全被删除，无法找回，请谨慎操作"}),ie&&u.a.createElement(V,{visible:ie,onCancel:function(){return re({errorLogVisible:!1,errorLogRecord:{}})},record:oe}))}},slUx:function(e,t,a){"use strict";a.r(t);a("rB9j"),a("Rm1S");var n=a("q1tI"),r=a.n(n),i=a("/MKj"),o=a("dL2e"),c=a("8QW8"),l=a("MeRu"),s=(a("NBAS"),a("SuFq"),a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("AUBz"),a("ZTPi")),u=(a("ma9I"),a("Nlzp")),d=(a("YKZ2"),a("mbEz"),a("wCAj")),m=(a("L/Qf"),a("2/Rp")),p=(a("qNb/"),a("PArb")),f=(a("0lcf"),a("mr32")),v=(a("k3Gp"),a("kLXV")),h=(a("1vPl"),a("5rEg")),y=(a("hByQ"),a("2B1R"),a("TL2v")),b=(a("tkto"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR"),a("zKZe"),a("8QGh"),a("2fM7")),g=(a("oVuX"),a("UxlC"),a("WsrF")),E=(a("XlDN"),a("P2RN")),w=a("rVDo"),O=a("rwTb");a("Takh");function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function D(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=T(e);if(t){var r=T(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return x(this,a)}}function x(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=b.a.Option,L=g.a.create({name:"addFirmwareDialog"})(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(o,e);var t,a,n,i=N(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).addFirmware=function(){t.props.form.resetFields(),t.addFirmwareInput.setState({fileList:[]}),t.props.addFirmware()},t.state={deviceVersionTypeList:[],deviceVersionType:"",allFirmwareVersionTypeList:[],firmwareVersionType:"",totalVersion:"",mainVersion:"",extVersion:""},t.handleSubmit=t.handleSubmit.bind(P(t)),t.deviceVersionType=t.deviceVersionType.bind(P(t)),t}return t=o,(a=[{key:"componentDidMount",value:function(){var e=this;Object(u.c)(u.a.getAllDeviceVersionType,{checkProductId:this.props.productId,bindType:this.props.bindType}).then((function(t){e.setState({deviceVersionTypeList:t.data})}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props.form;a.deviceVersionTypeList,(0,a.validateFieldsAndScroll)((function(e,a){if(!e){var n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a),r=t;if(n.productId=t.props.productId,n.upgradeFile=t.addFirmwareInput.getFileListUrl().length>0?t.addFirmwareInput.getFileListUrl().join(","):"",!n.upgradeFile)return Object(E.a)({description:"请选择文件"}),!1;var i=(n.totalVersion+"").replace(/^\s+|\s+$/g,""),o=(n.mainVersion+"").replace(/^\s+|\s+$/g,""),c=(n.extVersion+"").replace(/^\s+|\s+$/g,"");if(!/^[\w\.-]*$/.test(i))return Object(E.a)({description:"固件系列标示只能包含字母、数字、下划线、短横线、点号"}),!1;if(+o>2147483647)return Object(E.a)({description:"内部版本号大小超过范围，最大2147483647"}),!1;if(!/^[0-9]*$/.test(o))return Object(E.a)({description:"内部版本须为不小于0的整数"}),!1;if(!/^[\w\.-]*$/.test(c))return Object(E.a)({description:"外部版本只能包含字母、数字、下划线、短横线、点号"}),!1;Object(u.d)(u.a.versionAdd,n,{needFormData:!0,needVersion:1.1}).then((function(e){0==e.code&&(t.props.form.resetFields(),r.addFirmwareInput.setState({fileList:[]},(function(){t.props.addFirmware("添加固件成，请求列表")})))}))}}))}},{key:"deviceVersionType",value:function(e){var t=this;this.props.form.resetFields("firmwareVersionType"),Object(u.c)(u.a.getAllFirmwareVersionType,{deviceVersionTypeId:e}).then((function(e){t.setState({allFirmwareVersionTypeList:e.data})}))}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,n=a.deviceVersionTypeList,i=a.allFirmwareVersionTypeList;return r.a.createElement("div",{className:"add_firmware_dialog"},r.a.createElement(g.a,I({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},{onSubmit:this.handleSubmit,className:""}),r.a.createElement(g.a.Item,{label:r.a.createElement(O.a,{label:"添加固件",tip:"该产品采用的是独立MCU方案，您可以管理PCB和模组的固件程序"}),hasFeedback:!0},t("deviceVersionType",{rules:[{required:!0,message:"请选择模组固件!"}]})(r.a.createElement(b.a,{style:{width:174},placeholder:"请选择",onChange:this.deviceVersionType},n.map((function(e,t){return r.a.createElement(R,{key:e.deviceVersionTypeId+t,value:e.deviceVersionTypeId},e.deviceVersionTypeName)}))))),r.a.createElement(g.a.Item,{label:r.a.createElement(O.a,{label:"添加模块",tip:"请选择固件的细分模块，升级时将只针对该模块升级。"}),hasFeedback:!0},t("firmwareVersionType",{rules:[{required:!0,message:"请选择模块!"}]})(r.a.createElement(b.a,{style:{width:174},placeholder:"请选择"},i.map((function(e,t){return r.a.createElement(R,{key:e.firmwareVersionTypeNo+t,value:e.firmwareVersionTypeNo},e.firmwareVersionTypeName)}))))),r.a.createElement(g.a.Item,{label:r.a.createElement(O.a,{label:"固件系列标识",tip:"区分不同固件包，只有相同的固件才能升级"}),hasFeedback:!0},t("totalVersion",{rules:[{required:!0,message:"请输入固件系列标识!"}]})(r.a.createElement(h.a,{maxLength:30,placeholder:"固件系列标示只能包含字母、数字、下划线、短横线、点号"}))),r.a.createElement(g.a.Item,{label:r.a.createElement(O.a,{label:"内部版本号",tip:"同一系列的固件根据内部版本号决定是否升级"}),hasFeedback:!0},t("mainVersion",{rules:[{required:!0,message:"请输入内部版本号!"}]})(r.a.createElement(h.a,{maxLength:10,placeholder:"内部版本须为不小于0的整数"}))),r.a.createElement(g.a.Item,{label:r.a.createElement(O.a,{label:"外部版本号",tip:"升级提示时，用户可见的版本号"}),hasFeedback:!0},t("extVersion",{rules:[{required:!0,message:"请输入外部版本号!"}]})(r.a.createElement(h.a,{maxLength:30,placeholder:"外部版本只能包含字母、数字、下划线、短横线、点号"}))),r.a.createElement(g.a.Item,{label:"固件程序：",hasFeedback:!0},r.a.createElement(w.a,{onRef:function(t){return e.addFirmwareInput=t},isNotImg:!0,format:".bin,.hex,.zip,.cyacd",maxSize:20})),r.a.createElement("div",{className:"but"},r.a.createElement(m.a,{type:"primary",htmlType:"submit"},"确定"),r.a.createElement(m.a,{className:"cancel",onClick:this.addFirmware},"取消"))))}}])&&D(t.prototype,a),n&&D(t,n),o}(r.a.Component)),F=(a("7W5+"),a("8z0m")),A=(a("+2oP"),a("z7Xi"));function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function M(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=q(e);if(t){var r=q(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return U(this,a)}}function U(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?W(e):t}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){K(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function K(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Q=b.a.Option,z=h.a.TextArea,G=[{id:"0",text:"全部设备升级"},{id:"1",text:"指定设备升级"}],Z=[{id:"1",text:"普通升级"},{id:"2",text:"强制升级"},{id:"3",text:"静默升级"}],X=["","用户可感知，升级触发时用户可以在app上查看到升级提醒，确认后才能升级","用户可感知，用户可以在app上查看到升级提示，无需确认自动开始升级","用户无感知，无需确认，直接推送到设备进行升级"],$=g.a.create({name:"releaseFirmware",mapPropsToFields:function(e){return{deviceVersionId:g.a.createFormField(H(H({},e.deviceVersionId),{},{deviceVersionId:e.deviceVersionId}))}}})(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(o,e);var t,a,n,i=J(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).beforeUpload=function(e){return e.size/1024<500?(Object(u.d)(u.a.versionCheckMac,{multipartFile:e},{needFormData:!0}).then((function(e){if(0==e.code){var a=e.data,n=a.successes,r=a.fails,i="",o="无";if(n.length>0){for(var c=0;c<n.length;c++)i+=n[c]+";";i=i.slice(0,i.length-1)}if(r.length>0){o="";for(var l=r.length>4?4:r.length,s=0;s<l;s++)o+=r[s]+";";o=o.slice(0,o.length-1),r.length>4&&(o+="...")}t.setState({macList:i});var u=a.successCount>0?a.successCount:0;Object(E.a)({type:"info",message:"上传mac返回提示",description:"总共导入"+a.totalCount+"条,成功了"+u+"条，失败"+a.failCount+"条，（失败："+o+"）"})}else Object(E.a)({type:"error",message:"上传mac返回提示",description:e.msg})})),!1):(Object(E.a)({description:"文件上传大小超过500k限制"}),!1)},t.state={releaseWayId:"",upgradeType:"",file:null,macList:""},t.handleSubmit=t.handleSubmit.bind(W(t)),t.releaseWayType=t.releaseWayType.bind(W(t)),t.upgradeType=t.upgradeType.bind(W(t)),t.downloadMac=t.downloadMac.bind(W(t)),t.changeMacList=t.changeMacList.bind(W(t)),t.releaseFirmware=t.releaseFirmware.bind(W(t)),t}return t=o,(a=[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e){}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props.form;a.deviceVersionTypeList,(0,a.validateFieldsAndScroll)((function(e,a){if(!e){var n=t.props,r=n.deviceVersionId,i=n.releaseState,o=n.releaseFirmware,c=n.macListOperationRecords,l={deviceVersionId:r,status:a.upgradeWay,upgradeType:a.releaseWayId,releaseNote:a.promptInformation};if(l.macSet=c?t.state.macList:t.state.macList||i.macSet,console.log("data------999-----",l),1==l.upgradeType&&!l.macSet)return Object(E.a)({description:"请输入Mac！"}),!1;Object(u.c)(u.a.versionPublish,l).then((function(e){0==e.code?t.setState({macList:""},(function(){o("修改成功，请求列表数据","","")})):Object(E.a)({description:e.msg})}))}}))}},{key:"releaseWayType",value:function(e){this.setState({releaseWayId:e+""})}},{key:"upgradeType",value:function(e){this.setState({upgradeType:X[e]})}},{key:"downloadMac",value:function(){var e=window.location.origin+"/v1/web/open/device/mac/download?type=2";window.location.href=e}},{key:"changeMacList",value:function(e){this.props.macListOperationRecordsFunc(),this.setState({macList:e.target.value})}},{key:"releaseFirmware",value:function(e,t,a){var n=this;this.setState({macList:"",releaseWayId:"",upgradeType:"",file:null},(function(){n.props.releaseFirmware(e,t,a),n.props.form.resetFields()}))}},{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue,n={color:"#2F78FF",cursor:"pointer",padding:"5px 10px"},i=this.state,o=i.releaseWayId,c=i.macList,l=this.props,s=l.releaseState,u=l.macListOperationRecords;o=o+""?o+"":s.status?s.status+"":"0",c=u?c:c||s.macSet;var d=a("upgradeWay")||"";return r.a.createElement("div",{className:"release_firmware"},r.a.createElement(g.a,V({},{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},{onSubmit:this.handleSubmit,className:""}),r.a.createElement(g.a.Item,{label:"发布方式：",hasFeedback:!0},t("releaseWayId",{initialValue:o},{rules:[{required:!0,message:"请选择发布方式!"}]})(r.a.createElement(b.a,{style:{width:174},placeholder:"请选择",onChange:this.releaseWayType},G.map((function(e,t){return r.a.createElement(Q,{key:e.id+t,value:e.id},e.text)}))))),1==o?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("span",{style:{verticalAlign:"top",margin:"0 10px 0 23px",color:"rgba(0, 0, 0, 0.85)"}},"MAC地址:"),r.a.createElement("textarea",{value:c,rows:"10",cols:"69",style:{borderRadius:"3px",padding:"10px"},onChange:this.changeMacList})),r.a.createElement("div",{style:{position:"relative",padding:"0 0 20px 80px"}},r.a.createElement("span",{style:n,onClick:this.downloadMac},"下载模板"),r.a.createElement("span",{style:n},"批量导入"),r.a.createElement(g.a.Item,{label:""},t("file",{rules:[{required:!1}]})(r.a.createElement("div",{style:{position:"absolute",top:"-30px",left:"80px",opacity:0}},r.a.createElement(F.a,{beforeUpload:this.beforeUpload,fileList:this.state.file,accept:".xls,.xlsx"},r.a.createElement(m.a,null,r.a.createElement(A.a,null),"批量倒入"))))))):null,r.a.createElement(g.a.Item,{label:"升级方式：",hasFeedback:!0},t("upgradeWay",{initialValue:s.upgradeType?s.upgradeType+"":"1"},{rules:[{required:!0,message:"请选择升级方式!"}]})(r.a.createElement(b.a,{style:{width:174},placeholder:"请选择"},Z.map((function(e,t){return r.a.createElement(Q,{key:e.id+t,value:e.id},e.text)})))),r.a.createElement("p",{style:{height:"10px",fontSize:"12px"}},X[d||s.upgradeType])),r.a.createElement(g.a.Item,{label:"升级提示信息：",hasFeedback:!0},t("promptInformation",{initialValue:s.releaseNote},{rules:[{required:!0,message:"请输入升级提示信息!"}]})(r.a.createElement(z,null)),r.a.createElement("p",{style:{height:"10px",fontSize:"12px"}},"选择普通升级和强制升级时，用户可在app查看到升级提示")),r.a.createElement("div",{className:"but"},r.a.createElement(m.a,{type:"primary",htmlType:"submit"},"确定"),r.a.createElement(m.a,{className:"cancel",onClick:this.releaseFirmware.bind(this,"","","")},"取消"))))}}])&&M(t.prototype,a),n&&M(t,n),o}(r.a.Component));function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ae(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=ce(e);if(t){var r=ce(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return ie(this,a)}}function ie(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?le(Object(a),!0).forEach((function(t){ue(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):le(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ue(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var de,me=g.a.create({name:"validationFirmwareDialog",mapPropsToFields:function(e){return{deviceVersionId:g.a.createFormField(se(se(se(se({},e.deviceVersionId),{},{deviceVersionId:e.deviceVersionId},e.validationFirmware),{},{validationFirmware:e.validationFirmware},e.macListStr),{},{macListStr:e.validationState}))}}})(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(o,e);var t,a,n,i=re(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).beforeUpload=function(e){return e.size/1024<500?(Object(u.d)(u.a.versionCheckMac,{multipartFile:e},{needFormData:!0}).then((function(e){if(0==e.code){var a=e.data,n=a.successes,r=a.fails,i="",o="无";if(n.length>0){for(var c=0;c<n.length;c++)i+=n[c]+";";i=i.slice(0,i.length-1)}if(r.length>0){o="";for(var l=r.length>4?4:r.length,s=0;s<l;s++)o+=r[s]+";";o=o.slice(0,o.length-1),r.length>4&&(o+="...")}t.setState({macList:i});var u=a.successCount>0?a.successCount:0;Object(E.a)({message:"上传mac返回提示",description:"总共导入"+a.totalCount+"条,成功了"+u+"条，失败"+a.failCount+"条，（失败："+o+"）"})}else Object(E.a)({type:"error",message:"上传mac返回提示",description:e.msg})})),!1):(Object(E.a)({description:"文件上传大小超过500k限制"}),!1)},t.state={deviceVersionId:t.props.deviceVersionId,file:null,macList:""},t.handleSubmit=t.handleSubmit.bind(oe(t)),t.downloadMac=t.downloadMac.bind(oe(t)),t.changeMacList=t.changeMacList.bind(oe(t)),t.validationFirmware=t.validationFirmware.bind(oe(t)),t}return t=o,(a=[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(e){var t=this,a=this;e.preventDefault(),(0,this.props.form.validateFieldsAndScroll)((function(e,n){if(!e){var r=a.state.macList,i=a.props,o=i.macListValidationRecords,c=i.deviceVersionId,l=i.validationState,s={deviceVersionId:c,macSet:o?r:r||l};if(!s.macSet)return Object(E.a)({message:"请输入Mac！"}),!1;Object(u.d)(u.a.versionValidate,s).then((function(e){0==e.code?t.setState({macList:""},(function(){a.props.validationFirmware("接口成功后，关闭弹窗刷新列表")})):Object(E.a)({type:"error",message:"验证固件提示",description:e.msg})}))}}))}},{key:"downloadMac",value:function(){var e=window.location.origin+"/v1/web/open/device/mac/download?type=2";window.location.href=e}},{key:"changeMacList",value:function(e){this.props.macListValidationRecordsFunc(),this.setState({macList:e.target.value})}},{key:"validationFirmware",value:function(e,t,a){var n=this;this.setState({macList:""},(function(){n.props.validationFirmware(e,t,a)}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={color:"#2F78FF",cursor:"pointer",padding:"5px 10px"},a=this.props,n=a.deviceVersionId,i=a.validationState,o=a.macListValidationRecords,c=(a.macListValidationRecordsFunc,this.state.macList);return c=o?c:c||i,r.a.createElement("div",{className:"validation_firmware_dialog"},r.a.createElement(g.a,te({},{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},{onSubmit:this.handleSubmit,className:""}),r.a.createElement("div",null,r.a.createElement("span",{style:{verticalAlign:"top",marginRight:"10px"}},"MAC地址:"),r.a.createElement("textarea",{value:c,rows:"10",cols:"73",style:{borderRadius:"3px",padding:"10px"},onChange:this.changeMacList})),r.a.createElement("div",{style:{position:"relative",paddingLeft:"60px"}},r.a.createElement("span",{style:t,onClick:this.downloadMac},"下载模板"),r.a.createElement("span",{style:t},"批量导入"),r.a.createElement(g.a.Item,{label:""},e("file",{rules:[{required:!1}]})(r.a.createElement("div",{style:{position:"absolute",top:"-30px",left:"80px",opacity:0}},r.a.createElement(F.a,{beforeUpload:this.beforeUpload,fileList:this.state.file,accept:".xls,.xlsx"},r.a.createElement(m.a,null,r.a.createElement(A.a,null),"批量倒入")))))),r.a.createElement("div",{className:"but"},r.a.createElement(m.a,{type:"primary",htmlType:"submit"},"确定"),r.a.createElement(m.a,{className:"cancel",onClick:this.validationFirmware.bind(this,"",n,i)},"取消"))))}}])&&ae(t.prototype,a),n&&ae(t,n),o}(r.a.Component)),pe=a("wd/R"),fe=a.n(pe);a("vH1t");function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=we(e);if(t){var r=we(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return ge(this,a)}}function ge(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?Ee(e):t}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oe,ke=["温馨提示：","1. 产品支持整包以及差分包的上传升级；","2. 差分包需厂商自行完成差分包生成，以及设备的差分还原程序开发；","3. 固件包支持多批次的发布，以及发布对象设备的查看管理；","4. 可在消息中心查看设备OTA失败详细信息；"],Ie=h.a.Search,Se=v.a.confirm,je=(Object(i.connect)((function(e){return{productBaseInfo:e.getIn(["product","productBaseInfo"]).toJS()}}),(function(e){return{}}))(de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(o,e);var t,a,n,i=be(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).macListOperationRecordsFunc=function(){t.setState({macListOperationRecords:!0})},t.macListValidationRecordsFunc=function(){t.setState({macListValidationRecords:!0})},t.state={versionList:[],pager:{pageIndex:1,totalRows:1},addFirmwareDialog:!1,releaseFirmwareDialog:!1,validationFirmwareDialog:!1,deviceVersionId:"",releaseState:null,validationState:"",macListOperationRecords:!1,macListValidationRecords:!1},t.search=t.search.bind(Ee(t)),t.addFirmware=t.addFirmware.bind(Ee(t)),t.releaseFirmware=t.releaseFirmware.bind(Ee(t)),t.showDeleteConfirm=t.showDeleteConfirm.bind(Ee(t)),t.validationFirmware=t.validationFirmware.bind(Ee(t)),t.pagerIndex=t.pagerIndex.bind(Ee(t)),t.columns=[{title:"固件ID",dataIndex:"id",key:"id"},{title:"固件类型",dataIndex:"firmwareVersionTypeName",key:"firmwareVersionTypeName"},{title:"固件标识",dataIndex:"deviceVersionTypeName",key:"deviceVersionTypeName"},{title:"内部版本号",dataIndex:"mainVersion",key:"mainVersion"},{title:"外部版本号",dataIndex:"extVersion",key:"extVersion"},{title:"时间",dataIndex:"releaseTime",key:"releaseTime"},{title:"状态",key:"updateStatus",dataIndex:"updateStatus",render:function(e){return r.a.createElement("span",null,e.map((function(e,t){var a="已发布"==e?"green":"待验证"==e?"blue":"gold";return r.a.createElement(f.a,{color:a,key:"tag"+t},e)})))}},{title:"操作",key:"tags",dataIndex:"tags",render:function(e,a){return r.a.createElement("span",null,e.map((function(n,i){if(1==e.length)return r.a.createElement("span",{key:"tags"+i},r.a.createElement("a",{onClick:t.releaseFirmware.bind(Ee(t),"",a.id,a.releaseObj)},n));if(2==e.length)return 0==i?r.a.createElement("span",{key:"tags"+i},r.a.createElement("a",{onClick:t.validationFirmware.bind(Ee(t),"",a.id,"")},n),r.a.createElement(p.a,{type:"vertical"})):r.a.createElement("span",{key:"tags"+i},r.a.createElement("a",{onClick:t.showDeleteConfirm.bind(Ee(t),a.id)},n));if(3==e.length){if(0==i)return r.a.createElement("span",{key:"tags"+i},r.a.createElement("a",{onClick:t.releaseFirmware.bind(Ee(t),"",a.id,"")},n),r.a.createElement(p.a,{type:"vertical"}));if(1==i)return r.a.createElement("span",{key:"tags"+i},r.a.createElement("a",{onClick:t.validationFirmware.bind(Ee(t),"",a.id,a.macSet)},n),r.a.createElement(p.a,{type:"vertical"}));if(2==i)return r.a.createElement("span",{key:"tags"+i},r.a.createElement("a",{onClick:t.showDeleteConfirm.bind(Ee(t),a.id)},n))}})))}}],t}return t=o,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.productId&&Object(u.c)(u.a.versionList,{productId:this.props.productId,pageIndex:1,pageRows:10}).then((function(t){var a=e.listData(t.data.list);e.setState({versionList:a,bindType:e.props.productBaseInfo.bindType,pager:t.data.pager})}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.productBaseInfo.bindType&&e.productBaseInfo.productId!=this.props.productId){var a=this.state.pager.pageIndex?this.state.pager.pageIndex:1;Object(u.c)(u.a.versionList,{productId:this.props.productId,pageIndex:a,pageRows:10}).then((function(e){var a=t.listData(e.data.list);t.setState({versionList:a,bindType:t.props.productBaseInfo.bindType,pager:e.data.pager})}))}}},{key:"listData",value:function(e){var t=[];return e.map((function(e,a){return t.push({key:a,id:e.deviceVersionId,firmwareVersionTypeName:e.firmwareVersionTypeName,deviceVersionTypeName:e.totalVersion,mainVersion:e.mainVersion,extVersion:e.extVersion,releaseTime:fe()(e.releaseTime).format("YYYY-MM-DD HH:mm:ss"),updateStatus:2==e.updateStatus?["已发布"]:0==e.updateStatus?["待验证"]:["验证中"],tags:2==e.updateStatus?["修改发布"]:0==e.updateStatus?["验证","删除"]:["发布","修改验证","删除"],macSet:e.macSet,releaseObj:{upgradeType:e.status,status:e.upgradeType,releaseNote:e.releaseNote,macSet:e.macSet}})})),t}},{key:"search",value:function(e){var t=this;Object(u.c)(u.a.versionList,{totalVersion:e,productId:this.props.productId,pageIndex:1,pageRows:10}).then((function(e){var a=t.listData(e.data.list);t.setState({versionList:a,bindType:t.props.productBaseInfo.bindType,pager:e.data.pager})}))}},{key:"addFirmware",value:function(e){var t=this;e&&Object(u.c)(u.a.versionList,{productId:this.props.productId,pageIndex:1,pageRows:10}).then((function(e){var a=t.listData(e.data.list);t.setState({versionList:a,bindType:t.props.productBaseInfo.bindType,pager:e.data.pager})})),this.setState({addFirmwareDialog:!this.state.addFirmwareDialog})}},{key:"validationFirmware",value:function(e,t,a){var n=this;e&&Object(u.c)(u.a.versionList,{productId:this.props.productId,pageIndex:1,pageRows:10}).then((function(e){var t=n.listData(e.data.list);n.setState({versionList:t,bindType:n.props.productBaseInfo.bindType,pager:e.data.pager})})),this.setState({validationFirmwareDialog:!this.state.validationFirmwareDialog,deviceVersionId:t,validationState:a||"",macListValidationRecords:!1})}},{key:"releaseFirmware",value:function(e,t,a){var n=this;e&&Object(u.c)(u.a.versionList,{productId:this.props.productId,pageIndex:1,pageRows:10}).then((function(e){var t=n.listData(e.data.list);n.setState({versionList:t,bindType:n.props.productBaseInfo.bindType,pager:e.data.pager})})),this.setState({releaseFirmwareDialog:!this.state.releaseFirmwareDialog,deviceVersionId:t,releaseState:a||"",macListOperationRecords:!1})}},{key:"showDeleteConfirm",value:function(e){var t=this;Se({title:"固件删除",content:"你确定要删除此固件吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){Object(u.c)(u.a.versionDelete,{deviceVersionId:e}).then((function(e){if(0==e.code){var a=t.state.pager,n=a.totalRows,r=a.pageIndex;r=n%(10*(r-1))>1?r:r-1,Object(u.c)(u.a.versionList,{productId:t.props.productId,pageIndex:r,pageRows:10}).then((function(e){var a=t.listData(e.data.list);t.setState({versionList:a,bindType:t.props.productBaseInfo.bindType,pager:e.data.pager})}))}}))},onCancel:function(){}})}},{key:"pagerIndex",value:function(e){var t=this;Object(u.c)(u.a.versionList,{productId:this.props.productId,pageIndex:e,pageRows:10}).then((function(e){var a=t.listData(e.data.list);t.setState({versionList:a,bindType:t.props.productBaseInfo.bindType,pager:e.data.pager})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.versionList,n=t.pager,i=t.macListOperationRecords,o=t.addFirmwareDialog,c=t.releaseState,l=t.bindType,s=t.releaseFirmwareDialog,u=t.validationFirmwareDialog,p=t.validationState,f=t.deviceVersionId,h=t.macListValidationRecords;return r.a.createElement("div",{className:"firmware_management"},r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"centent"},r.a.createElement(y.a,{desc:ke})),r.a.createElement("div",{className:"fonction_fence"},r.a.createElement("span",null,"固件标识："),r.a.createElement("div",{className:"searchBox"},r.a.createElement(Ie,{placeholder:"请输入固件",onSearch:function(t){return e.search(t)},enterButton:!0})),r.a.createElement(m.a,{className:"button",onClick:this.addFirmware,type:"primary"},"添加固件")),r.a.createElement("div",{className:"listBox"},r.a.createElement(d.a,{columns:this.columns,dataSource:a,pagination:{defaultCurrent:n.pageIndex,total:n.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex}})),r.a.createElement(v.a,{title:"新建固件",visible:o,onOk:this.addFirmware,onCancel:this.addFirmware,width:600,footer:null,maskClosable:!1},r.a.createElement(L,{bindType:l,addFirmware:this.addFirmware,productId:this.props.productId})),r.a.createElement(v.a,{title:"发布固件",visible:s,onOk:this.releaseFirmware,onCancel:this.releaseFirmware,width:600,footer:null,maskClosable:!1},r.a.createElement($,{releaseState:c,deviceVersionId:f,bindType:l,releaseFirmware:this.releaseFirmware,productId:this.props.productId,macListOperationRecords:i,macListOperationRecordsFunc:this.macListOperationRecordsFunc})),r.a.createElement(v.a,{title:"验证固件",visible:u,onOk:this.validationFirmware,onCancel:this.validationFirmware,width:600,footer:null,maskClosable:!1},r.a.createElement(me,{deviceVersionId:f,validationState:p,validationFirmware:this.validationFirmware,macListValidationRecords:h,macListValidationRecordsFunc:this.macListValidationRecordsFunc}))))}}])&&he(t.prototype,a),n&&he(t,n),o}(n.Component)),a("BkRI")),De=a.n(je),Ce=(a("EnZy"),a("TfFZ"),a("3S7+")),Ne=(a("pDQq"),a("Ytl9"));function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Ae(e);if(t){var r=Ae(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Le(this,a)}}function Le(e,t){return!t||"object"!==xe(t)&&"function"!=typeof t?Fe(e):t}function Fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e=Object(i.connect)((function(e){return{}}),(function(e){return{changeDeviceDebugMacData:function(t){return e(Object(Ne.b)(t))},deleteDeviceDebugMacData:function(t,a,n){return e(Object(Ne.c)(t,a,n))},editDeviceDebugMacData:function(t){return e(Object(Ne.d)(t))},addDeviceDebugMacList:function(t,a){return e(Object(Ne.a)(t,a))},getDeviceDebugAccountInsert:function(t,a){return e(Object(Ne.a)(t,a))},getRenewalAccount:function(t){return e(Object(Ne.j)(t))},getDeviceDebugMacList:function(t){return e(Object(Ne.h)(t))},updateDeviceDebugAccountList:function(t){return e(Object(Ne.t)(t))},getDeviceDebugAccountList:function(t){return e(Object(Ne.g)(t))}}}))(Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(o,e);var t,a,n,i=Re(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).deleteMac=function(e,a){if(console.log("type ， id,",e,a),2==e){var n=t.props.deviceDebugMacList;n.data.splice(a,1),t.props.deleteDeviceDebugMacData(t.props.pid,a,n)}else t.props.deleteDeviceDebugMacData(t.props.pid,a)},t.macAdd=function(e){var a=e.target.value;t.setState({macStr:a})},t.insertMac=function(){var e=t.state.macStr;if(!e)return Object(E.a)({description:"物理地址不能为空!",type:"warn"}),!1;if(!e.match(/^[\da-zA-Z]{1,50}$/))return Object(E.a)({description:"物理地址格式错误，应为50位以内的大小写字母加数字组成!",type:"warn"}),!1;var a={physicalAddr:t.state.macStr,productId:+t.props.pid};Object(u.d)(u.a.addDebugMac,a,{loading:!0}).then((function(e){0==e.code&&t.setState({macStr:""},(function(){t.props.getDeviceDebugMacList(t.props.pid)}))}))},t.state={macStr:"",macInput:"",editAccount:"",remark:"",addAccountInput:"",addRemarkInput:""},t.eidtMac=t.eidtMac.bind(Fe(t)),t.macInput=t.macInput.bind(Fe(t)),t.deviceMacAdd=t.deviceMacAdd.bind(Fe(t)),t.addAccountDom=t.addAccountDom.bind(Fe(t)),t.deleteAccountDom=t.deleteAccountDom.bind(Fe(t)),t.accountInput=t.accountInput.bind(Fe(t)),t.productIdInput=t.productIdInput.bind(Fe(t)),t.eidtAccount=t.eidtAccount.bind(Fe(t)),t.deleteAccount=t.deleteAccount.bind(Fe(t)),t.eidtAddAccoun=t.eidtAddAccoun.bind(Fe(t)),t.remark=t.remark.bind(Fe(t)),t.addAccountInput=t.addAccountInput.bind(Fe(t)),t.addAccount=t.addAccount.bind(Fe(t)),t.addRemark=t.addRemark.bind(Fe(t)),t.cancelEdit=t.cancelEdit.bind(Fe(t)),t}return t=o,(a=[{key:"componentDidMount",value:function(){}},{key:"eidtMac",value:function(e){var t=this.props.deviceDebugMacList;t.data[e].editOrDelete=!0,this.props.changeDeviceDebugMacData(t),this.setState({macInput:t.data[e].mac})}},{key:"macInput",value:function(e,t){var a=t.target.value,n=this.props.deviceDebugMacList;n.data[e].mac=a,this.props.editDeviceDebugMacData(n)}},{key:"deviceMacAdd",value:function(){var e=this.props.deviceDebugMacList;if(e.data=e.data?e.data:[],e.data.length>19)return Object(E.a)({description:"最多只能添加20个MAC！",type:"warn"}),!1;e.data.push({}),this.props.addDeviceDebugMacList(e)}},{key:"addAccountDom",value:function(){var e=this.props.deviceDebugAccountList;if(e.data.length>19)return Object(E.a)({description:"最多只能添加20个调试账号！",type:"warn"}),!1;e.data.push({}),this.props.getRenewalAccount(e)}},{key:"eidtAccount",value:function(e){var t=this.props.deviceDebugAccountList;t.data[e].editOrDelete=!0,this.props.updateDeviceDebugAccountList(t),this.setState({editAccount:t.data[e].account,remark:t.data[e].remark})}},{key:"deleteAccount",value:function(e,t){var a=this;Object(u.d)(u.a.deviceDebugAccountDelete,{productId:e,debugAccountId:t},{needVersion:1.1,loading:!0}).then((function(t){0==t.code&&a.props.getDeviceDebugAccountList(e)}))}},{key:"deleteAccountDom",value:function(e){var t=this.props.deviceDebugAccountList;t.data.splice(e,1),this.props.getRenewalAccount(t)}},{key:"accountInput",value:function(e,t){var a=this.props.deviceDebugAccountList;a.data[e].account=t.target.value,this.props.getRenewalAccount(a)}},{key:"remark",value:function(e,t){var a=this.props.deviceDebugAccountList;a.data[e].remark=t.target.value,this.props.getRenewalAccount(a)}},{key:"cancelEdit",value:function(e){var t=this.state,a=t.editAccount,n=t.remark,r=this.props.deviceDebugAccountList;r.data[e].account=a,r.data[e].remark=n,r.data[e].editOrDelete=!1,this.props.getRenewalAccount(r)}},{key:"eidtAddAccoun",value:function(e,t,a,n,r){var i=this,o=this.state,c=o.editAccount,l=o.remark,s=!1,d={productId:n,debugAccountId:a,account:t,remark:r};if(""!=t&&c!=t&&(d.account=t,s=!0),""!=r&&l!=r&&(d.remark=r,s=!0),!d.account)return Object(E.a)({description:"账号不能为空",type:"warn"}),!1;if(s)Object(u.d)(u.a.deviceDebugAccountInsert,d,{needVersion:1.1,loading:!0}).then((function(e){0==e.code&&i.props.getDeviceDebugAccountList(n)}));else{var m=this.props.deviceDebugAccountList;m.data[e].editOrDelete=!1,this.props.getRenewalAccount(m)}}},{key:"addAccountInput",value:function(e){this.setState({addAccountInput:e.target.value})}},{key:"addRemark",value:function(e){this.setState({addRemarkInput:e.target.value})}},{key:"productIdInput",value:function(e,t){var a=this.props.deviceDebugAccountList;a.data[e].productId=t.target.value,this.props.getRenewalAccount(a)}},{key:"addAccount",value:function(){var e=this,t=this.state,a=t.addAccountInput,n=t.addRemarkInput,r=this.props.pid;if(!a)return Object(E.a)({description:"账号不能为空",type:"warn"}),!1;var i={productId:r,account:a,remark:n};Object(u.d)(u.a.deviceDebugAccountInsert,i,{needVersion:1.1,loading:!0}).then((function(t){0==t.code&&e.setState({addAccountInput:""},(function(){e.props.getDeviceDebugAccountList(r)}))}))}},{key:"render",value:function(){var e=this,t=this.state,a=(t.editAccount,t.remark,t.addAccountInput),n=t.addRemarkInput,i=this.props,o=i.visible,c=i.deviceDebugAccountList,l=i.deviceDebugMacList,s=i.pid,u=i.authorityType,d="";return 0==u?d="初级安全认证":1==u?d="中级安全认证":2==u&&(d="高级安全认证"),r.a.createElement("div",null,r.a.createElement(v.a,{title:"配置调试信息",visible:o,onOk:this.props.visibleFun,onCancel:this.props.visibleFun,width:"800px",className:"debuggingInformation self-modal",maskClosable:!1},r.a.createElement("div",{className:"debuggingInfo_box"},r.a.createElement("div",{className:"title"},"调试设备"),r.a.createElement("div",{className:"instructions"},"您的产品使用了",'"',d,'"'," 能力，","高级安全认证"===d?r.a.createElement("span",null,"每台设备需要烧录平台颁发的设备密钥，进行身份认证通过后才可以激活设备，连接平台通信。使用烧录工具烧录设备ID/设备密钥，让设备连接平台完成激活，再录入设备物理地址即可开始调试。每个产品最多可以添加20个设备进行调试。"):"中级安全认证"===d?r.a.createElement("span",null,"每台设备需要烧录所属产品的密钥，并提前在平台注册设备信息，才可以完成身份认证，可以激活设备，连接平台通信。在这里添加设备物理地址可以注册设备，设备激活成功后，即可开始调试。每个产品最多可以添加20个设备进行调试。"):r.a.createElement("span",null,"每台设备需要烧录所属产品的密钥，进行身份认证通过后才可以激活设备，连接平台通信。设备激活成功后，录入设备的物理地址即可开始调试。每个产品最多可以添加20个设备进行调试。")),r.a.createElement("div",{className:"macListBox"},l.data&&l.data.map((function(t,a){return t.physicalAddr?r.a.createElement("div",{className:"macItem",key:"debuggingInfoMacItem"+a},r.a.createElement("div",{className:"macOrImei"},r.a.createElement("p",null,r.a.createElement("span",{className:"lable"},"物理地址："),r.a.createElement(Ce.a,{title:t.physicalAddr},r.a.createElement("span",{className:"details single-text"},t.physicalAddr))),r.a.createElement("p",null,r.a.createElement("span",{className:"lable"},"设备ID："),r.a.createElement(Ce.a,{title:t.id},r.a.createElement("span",{className:"details single-text"},t.id))),r.a.createElement("p",null,r.a.createElement("span",{className:"lable"},"设备密钥："),r.a.createElement(Ce.a,{title:t.deviceSecret},r.a.createElement("span",{className:"details single-text"},t.deviceSecret))),r.a.createElement("span",{className:"operationBut delete",onClick:e.deleteMac.bind(e,1,t.id)},"删除"))):r.a.createElement("div",{className:"macItem addDom",key:"debuggingInfoMacItem"+a},r.a.createElement(h.a,{placeholder:"请输入设备物理地址",maxLength:50,defaultValue:"",onChange:e.macAdd}),r.a.createElement("span",{className:"operationBut",onClick:e.insertMac.bind(e,2)},"保存"),r.a.createElement(p.a,{type:"vertical"}),r.a.createElement("span",{className:"",onClick:e.deleteMac.bind(e,2,a)},"删除"))})),r.a.createElement("div",{className:"add",onClick:this.deviceMacAdd},r.a.createElement("span",null,"添加调试设备"))),r.a.createElement("div",null,r.a.createElement("div",{className:"title"},"调试白名单"),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"10%"}},"账号ID"),r.a.createElement("th",{style:{width:"20%"}},"手机号"),r.a.createElement("th",{style:{width:"30%"}},"备注"),r.a.createElement("th",{style:{width:"25%"}},"添加时间"),r.a.createElement("th",{style:{width:"15%"}},"操作"))),r.a.createElement("tbody",null,c.data.map((function(t,i){return t.editOrDelete?r.a.createElement("tr",{key:"account"+i},r.a.createElement("td",{colSpan:"5"},r.a.createElement("div",{className:"accountBox"},r.a.createElement(h.a,{placeholder:"请输入C-Life账号",maxLength:11,value:t.account,onChange:e.accountInput.bind(e,i)}),r.a.createElement(h.a,{placeholder:"请输入备注",maxLength:20,value:t.remark,onChange:e.remark.bind(e,i)}),r.a.createElement("div",{className:"saveTime"},fe()(t.createTime).utcOffset(-480).format("YYYY-MM-DD HH:mm:ss")),r.a.createElement("span",{className:"save",onClick:e.eidtAddAccoun.bind(e,i,t.account,t.debugAccountId,t.productId,t.remark)},"保存"),r.a.createElement(p.a,{type:"vertical"}),r.a.createElement("span",{onClick:e.cancelEdit.bind(e,i)},"取消"),r.a.createElement(p.a,{type:"vertical"}),r.a.createElement("span",{onClick:e.deleteAccount.bind(e,s,t.debugAccountId)},"删除")))):t.productId?r.a.createElement("tr",{key:"account"+i},r.a.createElement("td",null,i+1),r.a.createElement("td",null,t.account),r.a.createElement("td",null,t.remark||"-"),r.a.createElement("td",null,fe()(t.createTime).utcOffset(-480).format("YYYY-MM-DD HH:mm:ss")),r.a.createElement("td",null,r.a.createElement("span",{className:"save",onClick:e.eidtAccount.bind(e,i)},"编辑"))):r.a.createElement("tr",{key:"account"+i},r.a.createElement("td",{colSpan:"5"},r.a.createElement("div",{className:"accountBox"},r.a.createElement(h.a,{placeholder:"请输入C-Life账号",maxLength:11,onChange:e.addAccountInput,value:a}),r.a.createElement(h.a,{placeholder:"请输入备注",maxLength:20,onChange:e.addRemark,value:n}),r.a.createElement("div",{className:"saveTime"},fe()(new Date).format("YYYY-MM-DD HH:mm:ss")),r.a.createElement("span",{className:"save",onClick:e.addAccount},"保存"),r.a.createElement(p.a,{type:"vertical"}),r.a.createElement("span",{onClick:e.deleteAccountDom.bind(e,i)},"删除"))))}))))),r.a.createElement("div",{className:"accountAdd"},r.a.createElement("span",{onClick:this.addAccountDom},"添加账号")))))}}])&&Pe(t.prototype,a),n&&Pe(t,n),o}(n.Component))||Oe,Ve=a("qbnB"),Me=a.n(Ve);a("JfAA");function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function We(e,t,a){return t&&Ue(e.prototype,t),a&&Ue(e,a),e}function qe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Qe(e);if(t){var r=Qe(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Ke(this,a)}}function Ke(e,t){return!t||"object"!==Be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze=function(e){qe(a,e);var t=He(a);function a(){return Je(this,a),t.apply(this,arguments)}return We(a,[{key:"render",value:function(){var e="",t="",a="",n=this.props.jsonKey,i=Be(this.props.jsonValue),o=!1;if(this.props.jsonValue instanceof Array&&(i="array"),null===this.props.jsonValue&&(i="null"),"object"==i){var c="{",l="}";this.props.isClose?(e="icon-chevron-thin-right",a=i+c+"..."+l,t="tag"):(e="icon-chevron-thin-down",a=c,t="tag",o=!0)}else if("array"==i){c="[",l="]";this.props.isClose?(e="icon-chevron-thin-right",a=i+c+"..."+l,t="tag"):(e="icon-chevron-thin-down",a=c,t="tag",o=!0)}else"string"==i&&"tag"!=this.props.type?(a='"'+this.props.jsonValue+'"',t="string"):"number"==i?(a=this.props.jsonValue,t="number"):"string"==i&&"tag"==this.props.type?(a=this.props.jsonValue,t="tag"):"null"==i?(a="null",t="null"):"boolean"==i&&(a=this.props.jsonValue.toString(),t="boolean");return r.a.createElement("p",{className:"json-format-node",style:{"margin-left":this.props.isEndTag?"-25px":""}},r.a.createElement("i",{className:e,onClick:this.props.onCloseOrOpen}," "),r.a.createElement("span",{className:"json-format-key"},n?'"'+n+'"':""),n?":":"",r.a.createElement("span",{className:"json-format-value "+t},a),o||this.props.isLast?"":",")}}]),a}(r.a.Component),Ge=function(e){qe(a,e);var t=He(a);function a(e){var n;return Je(this,a),(n=t.call(this,e)).state={json:De()(n.props.json),jsonCode:n.props.jsonCode},n}return We(a,[{key:"componentWillReceiveProps",value:function(e){var t=De()(e.json);e.jsonCode==this.state.jsonCode&&"object"==Be(e.json)&&null!==e.json&&void 0!==e.json&&(t=Me()(!0,this.state.json,t)),this.setState({json:t,jsonCode:e.jsonCode})}},{key:"componentWillUpdate",value:function(){}},{key:"onCloseOrOpen",value:function(e){var t=this.state.json,a=t;for(var n in e){a=a[e[n]]}a._isClose=!a._isClose,this.setState(t)}},{key:"render",value:function(){var e=this;var t=function t(a,n,i,o){var c=[];if("object"!=Be(a)||null===a)return c.push(r.a.createElement(ze,{jsonValue:a,level:n,isLast:o})),c;var l=null;for(var s in a)u(s,a,!1);function u(a,o,s){if("_isClose"!=a)if(null!=l){var u=l;l=a;var d=o[u],m=i.concat();m.push(u);var p=n+1,f=u;if(o instanceof Array&&(f=null),"object"==Be(d)&&null!==d){if(c.push(r.a.createElement(ze,{jsonKey:f||null,jsonValue:d,level:p,isClose:d._isClose,onCloseOrOpen:e.onCloseOrOpen.bind(e,m),isLast:s})),!d._isClose){var v=t(d,p,m,null==a);c.push(r.a.createElement("div",{style:{"padding-left":"25px"}},v))}}else c.push(r.a.createElement(ze,{jsonKey:f||null,jsonValue:d,level:p,isLast:s}))}else l=a}if(u(null,a,!0),"object"==Be(a)&&!a._isClose){var d="}";a instanceof Array&&(d="]"),c.push(r.a.createElement(ze,{jsonValue:d,level:n+1,type:"tag",isEndTag:!0,isLast:o}))}var m=[];return"object"==Be(a)&&1==n?(m.push(r.a.createElement(ze,{jsonValue:a,level:n+1,type:"tag",isClose:a._isClose,onCloseOrOpen:e.onCloseOrOpen.bind(e,[]),isLast:o})),a._isClose||m.push(r.a.createElement("div",{style:{"padding-left":"25px"}},c)),m):c}(this.state.json,1,[],!0);return r.a.createElement("div",null,t)}}]),a}(n.Component),Ze=(a("U8R4"),a("+eQT")),Xe=a("dF/Y");function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(){return(et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function tt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=ot(e);if(t){var r=ot(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return rt(this,a)}}function rt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?it(e):t}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function lt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(a),!0).forEach((function(t){st(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ct(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function st(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ut=b.a.Option,dt=(fe()(),g.a.create({name:"exportStagerDataDialog",onFieldsChange:function(e,t){"{}"!==JSON.stringify(t)&&e.changeFormData(t)},mapPropsToFields:function(e){return{selectedMac:g.a.createFormField(lt(lt({},e.selectedMac),{},{value:e.selectedMac.value})),date:g.a.createFormField(lt(lt({},e.date),{},{value:e.date.value}))}}})(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(o,e);var t,a,n,i=nt(o);function o(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e);var a=De()(t.props.macList)||[];return t.state={macList:a||[],showWarn:!1,productId:t.props.productId,debugMacId:""},t.handleSubmit=t.handleSubmit.bind(it(t)),t}return t=o,(a=[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),(0,this.props.form.validateFieldsAndScroll)((function(e,a){if(!e){var n=a.selectedMac,r=a.date,i=window.location.origin+"/v1/web/open/protoManage/exportRunDataToExcel?mac="+n+"&searchDate="+r.format("YYYYMMDD")+"&productId="+t.props.productId;window.location.href=i,t.props.onCancel()}}))}},{key:"render",value:function(){var e=this.state.macList,t=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"exportData"},r.a.createElement(g.a,et({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit,className:""}),r.a.createElement(g.a.Item,{label:"选择Mac：",hasFeedback:!0},t("selectedMac",{rules:[{required:!0,message:"请选择Mac!"}]})(r.a.createElement(b.a,{style:{width:174},placeholder:"请选择产品"},e.map((function(e,t){return r.a.createElement(ut,{key:"mac"+t,value:e.mac||e.id},e.mac||e.id)}))))),r.a.createElement(g.a.Item,{label:"选择日期：",hasFeedback:!0},t("date",{rules:[{type:"object",required:!0,message:"请选择时间!"}]})(r.a.createElement(Ze.a,{format:"YYYY/MM/DD"}))),r.a.createElement(m.a,{type:"primary",htmlType:"submit",icon:r.a.createElement(Xe.a,null),block:!0},"下载")))}}])&&tt(t.prototype,a),n&&tt(t,n),o}(r.a.Component))),mt=a("tXLG"),pt=a("Lyp1");function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(){return(vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ht(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=wt(e);if(t){var r=wt(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return gt(this,a)}}function gt(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?Et(e):t}function Et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(e){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ot(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function kt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(a),!0).forEach((function(t){It(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ot(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function It(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var St,jt=b.a.Option,Dt=g.a.create({name:"exportStagerDataDialog",onFieldsChange:function(e,t){"{}"!==JSON.stringify(t)&&e.changeFormData(t)},mapPropsToFields:function(e){return{productId:g.a.createFormField(kt(kt({},e.productId),{},{productId:e.productId})),firmwareVersionType:g.a.createFormField(kt(kt({},e.firmwareVersionType),{},{value:e.firmwareVersionType.value})),totalVersion:g.a.createFormField(kt(kt({},e.totalVersion),{},{value:e.totalVersion.value})),mainVersion:g.a.createFormField(kt(kt({},e.mainVersion),{},{value:e.mainVersion.value}))}}})(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(o,e);var t,a,n,i=bt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).onCancel=function(){t.props.form.resetFields(),t.addUpdataDevice.setState({fileList:[]}),t.props.onCancel()},t.state={allFirmwareVersionTypeList:[]},t.handleSubmit=t.handleSubmit.bind(Et(t)),t}return t=o,(a=[{key:"componentDidMount",value:function(){var e=this;Object(u.c)(u.a.getAllFirmwareVersionType,{deviceVersionTypeId:1}).then((function(t){e.setState({allFirmwareVersionTypeList:t.data})}))}},{key:"componentDidUpdate",value:function(e){}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),(0,this.props.form.validateFieldsAndScroll)((function(e,a){if(!e){var n=kt({},a),r=t;n.deviceVersionType=t.props.deviceVersionType;for(var i=t.props.macList||[],o=0;o<i.length;o++)t.props.mac!=i[o].physicalAddr&&t.props.mac!=i[o].id||(n.id=i[o].id);t.addUpdataDevice.upToTencentCloud((function(e){var t=(n.totalVersion+"").replace(/^\s+|\s+$/g,""),a=(n.mainVersion+"").replace(/^\s+|\s+$/g,"");return/^[\w\.-]*$/.test(t)?+a>2147483647?(Object(E.a)({description:"内部版本号大小超过范围，最大2147483647"}),!1):/^[0-9]*$/.test(a)?(n.file=e[0],n.file?void Object(u.d)(u.a.upgradeDebug,n,{needFormData:!0}).then((function(e){0==e.code&&(r.onCancel(),r.props.get_clearDevData2())})):(Object(E.a)({description:"请选择文件！"}),!1)):(Object(E.a)({description:"内部版本须为不小于0的整数"}),!1):(Object(E.a)({description:"固件系列标示只能包含字母、数字、下划线、短横线、点号"}),!1)}))}}))}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.tipconts,i=a.firmwareModules;return r.a.createElement("div",{className:"add_firmware_dialog"},r.a.createElement(g.a,vt({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),r.a.createElement(g.a.Item,{label:"固件类型："},r.a.createElement("span",{className:"ant-form-text"},n)),r.a.createElement(g.a.Item,{label:r.a.createElement("span",null,"固件模块：",r.a.createElement(Ce.a,{placement:"top",title:"请选择固件的细分模块，升级时将只针对该模块升级。"},r.a.createElement(pt.a,null))),hasFeedback:!0},t("firmwareVersionType",{rules:[{required:!0,message:"请选择模块!"}]})(r.a.createElement(b.a,{style:{width:174},placeholder:"请选择"},i.map((function(e,t){return r.a.createElement(jt,{key:"固件模块："+t,value:e.firmwareVersionTypeNo},e.firmwareVersionTypeName)}))))),r.a.createElement(g.a.Item,{label:r.a.createElement("span",null,"固件系列标识：",r.a.createElement(Ce.a,{placement:"top",title:"区分不同固件包，只有相同的固件才能升级"},r.a.createElement(pt.a,null))),hasFeedback:!0},t("totalVersion",{rules:[{required:!0,message:"请输入固件系列标识!"}]})(r.a.createElement(h.a,{maxLength:30,placeholder:"只能包含字母、数字、下划线、短横线、点号"}))),r.a.createElement(g.a.Item,{label:r.a.createElement("span",null,"内部版本号：",r.a.createElement(Ce.a,{placement:"top",title:"同一系列的固件根据内部版本号决定是否升级"},r.a.createElement(pt.a,null))),hasFeedback:!0},t("mainVersion",{rules:[{required:!0,message:"请输入内部版本号!"}]})(r.a.createElement(h.a,{maxLength:10,placeholder:"内部版本须为不小于0的整数"}))),r.a.createElement(g.a.Item,{label:"固件程序：",hasFeedback:!0},r.a.createElement(mt.a,{isNotImg:!0,format:"bin,hex,zip,cyacd",maxsize:"5120",upFileShowType:!0,chooseWay:!0,onRef:function(t){return e.addUpdataDevice=t}})),r.a.createElement(m.a,{style:{position:"relative",left:"320px"},type:"primary",onClick:this.onCancel},"取消"),r.a.createElement(m.a,{style:{position:"absolute",right:"24px"},type:"primary",htmlType:"submit"},"确定")))}}])&&ht(t.prototype,a),n&&ht(t,n),o}(r.a.Component)),Ct=a("E+3K"),Nt=a.n(Ct),xt=a("DgvE");a("0kg4");function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Rt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(a),!0).forEach((function(t){Lt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Tt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Lt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function At(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _t(e,t,a){return t&&At(e.prototype,t),a&&At(e,a),e}function Vt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mt(e,t)}function Mt(e,t){return(Mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Wt(e);if(t){var r=Wt(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Jt(this,a)}}function Jt(e,t){return!t||"object"!==Pt(t)&&"function"!=typeof t?Ut(e):t}function Ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qt=s.a.TabPane;function Yt(e){Object(xt.f)(e)}var Ht,Kt,Qt,zt=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;Ft(this,a),(n=t.call(this,e))._value="",n.state={value:""};var r=n.props.value;return n.rule(n.props.ruletype,r)||(r=""),n.props.value&&(n.state.value=r),n._value=r,n.rule=n.rule.bind(Ut(n)),n}return _t(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.value;this.rule(this.props.ruletype,t)||(t=""),this.state.initValue!=e.value&&this.setState({value:t,initValue:t})}},{key:"rule",value:function(e,t){return!e||!t||(!("mac"!=(e=e.toLocaleLowerCase())||!/^[A-Fa-f0-9]{0,12}$/.test(t))||(!("long"!=e&&"integer"!=e||!/^-?[0-9]*$/.test(t))||(!("float"!=e||!/^(\d+\.\d*|\d+)$/.test(t))||(!("hexstring"!=e||!/^[A-Fa-f0-9]*$/.test(t))||"string"==e))))}},{key:"render",value:function(){var e=De()(this.props),t=this.props.onChange;return e.value=this.state.value,e.onChange=function(e){if(e){var a=e.target.value;this.rule(this.props.ruletype,a)?(t&&t(a),this.setState({value:a}),this._value=a):this.setState({value:this._value?this._value:""})}}.bind(this),r.a.createElement("input",e)}}]),a}(r.a.Component),Gt=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;Ft(this,a);var r=(n=t.call(this,e)).props.filterState?n.props.filterState:{},i=!!n.props.isFilter&&n.props.isFilter;return n.state={filterObj:r,isFilter:i,activeKey:n.props.activeKey},n._onReset=n._onReset.bind(Ut(n)),n.onClear=n.onClear.bind(Ut(n)),n._onChange=n._onChange.bind(Ut(n)),n._onChangeSelect=n._onChangeSelect.bind(Ut(n)),n._onChangeCheckbox=n._onChangeCheckbox.bind(Ut(n)),n.exportDataHandler=n.exportDataHandler.bind(Ut(n)),n}return _t(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Rt({},e._state))}},{key:"_onChange",value:function(e,t){var a=this.state.filterObj;a[e]=t,this.setState(a),this.props.onChange&&this.props.onChange(this.state.isFilter,a)}},{key:"_onChangeSelect",value:function(e,t){this._onChange(e,t.target.value)}},{key:"_onChangeCheckbox",value:function(){var e=!this.state.isFilter;this.setState({isFilter:e}),this.props.onChange&&this.props.onChange(e,this.state.filterObj)}},{key:"_onReset",value:function(){this.setState({filterObj:{}}),this.props.onChange&&this.props.onChange(this.state.isFilter,{})}},{key:"onClear",value:function(){1==this.state.activeKey?this.state.get_clearDevData1():this.state.get_clearDevData2()}},{key:"exportDataHandler",value:function(){this.props.openDialog()}},{key:"render",value:function(){var e=this.props.dataTypeList.data.map((function(e,t){return r.a.createElement("option",{key:"dataTypeOption"+t,value:e.commandList?e.commandList.join(","):""},e.typeName)})),t=this.props.activeKey;return r.a.createElement("div",{className:"dev-test-filter-panel"},r.a.createElement("form",null,r.a.createElement("div",{style:{display:1==t?"inline-block":"none"}},r.a.createElement("label",null,"命令类型："),r.a.createElement("select",{className:"has-next sclt-cont",onChange:this._onChangeSelect.bind(this,"filterCommand")},e),r.a.createElement("label",null,"数据类型："),r.a.createElement("select",{className:"has-next sclt-cont",onChange:this._onChangeSelect.bind(this,"filterDataType")},r.a.createElement("option",{value:""},"全部"),r.a.createElement("option",{value:"U"},"上行数据"),r.a.createElement("option",{value:"D"},"下行数据"))),r.a.createElement("div",{style:{display:2==t?"inline-block":"none"}},r.a.createElement("label",null,"升级类型："),r.a.createElement("select",{className:"has-next sclt-cont firm-up",onChange:this._onChangeSelect.bind(this,"bussinessType")},r.a.createElement("option",{value:""},"全部"),r.a.createElement("option",{value:"2"},"Wi-Fi固件升级"),r.a.createElement("option",{value:"3"},"PCB固件升级"))),r.a.createElement("label",null,"MAC地址："),r.a.createElement(zt,{ruletype:"mac",type:"text",className:"has-next",maxLength:"12",value:this.state.filterObj.filterMac,onChange:this._onChange.bind(this,"filterMac")}),r.a.createElement("input",{type:"reset",value:"重置",className:"has-next",onClick:this._onReset})),r.a.createElement("div",{className:"filterBox"},r.a.createElement("input",{type:"checkbox",id:"isFilter",value:"9",name:"filterIsFilter",onChange:this._onChangeCheckbox.bind(this,"filterIsFilter")}),r.a.createElement("label",{className:"by-checkbox has-next",htmlFor:"isFilter"},"过滤"),r.a.createElement("input",{type:"button",value:"清空报文列表",onClick:this.onClear}),1==t&&r.a.createElement("span",{className:"fr export-excel-btn",onClick:this.exportDataHandler},"导出数据")))}}]),a}(r.a.Component),Zt=function(e){Vt(a,e);var t=Bt(a);function a(){return Ft(this,a),t.apply(this,arguments)}return _t(a,[{key:"componentWillReceiveProps",value:function(e){}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.title,n=e.children;return r.a.createElement("div",{className:"dev-test-common-panel "+(t||"")},r.a.createElement("div",{className:"common-panel-title"},r.a.createElement("p",null,a)),r.a.createElement("div",{className:"common-panel-content"},n))}}]),a}(r.a.Component),Xt=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;Ft(this,a);var r={};return(n=t.call(this,e)).props.selectedRowId&&(r.selectedId=n.props.selectedRowId),n.state=r,n.selectRow=n.selectRow.bind(Ut(n)),n}return _t(a,[{key:"filter",value:function(e){return(this.props.filter?this.props.filter:function(){return!0})(e)}},{key:"selectRow",value:function(e,t){e&&e.id&&(this.setState({selectedId:e.id}),t&&t(e))}},{key:"generateTHead",value:function(){var e=this,t=(this.props.thead?this.props.thead:[]).map((function(t,a){return r.a.createElement("td",{key:a,width:e.props.rowsWidth&&e.props.rowsWidth[a]?e.props.rowsWidth[a]:""},t)})),a="";return this.props.thead&&(a=r.a.createElement("thead",null,r.a.createElement("tr",{key:"1"},t))),a}},{key:"generateTBody",value:function(){var e=this.props.generateRule?this.props.generateRule:"",t=function(e,t,a){return a&&"string"!=a?"json"==a?e[(this.props.rowKey?this.props.rowKey:[])[t]]:"function"==a?(this.props.rowFn?this.props.rowFn:[])[t](e):void 0:e[t]}.bind(this),a=function(e){return this.props.thead?this.props.thead.length:this.props.colCount?this.props.colCount:e&&"string"!=e?"json"==e?this.props.rowKey?this.props.rowKey.length:0:"function"==e?this.props.rowFn?this.props.rowFn.length:0:void 0:this.props.rows[0]?this.props.rows[0].length:0}.bind(this),n=this.props.minRowCount?parseInt(this.props.minRowCount):0,i=this.props.rows?this.props.rows:[],o=a(e);if(i.length<n){for(var c=[],l=0;l<o;l++)c.push("");for(var s=n-i.length,u=[],d=0;d<s;d++)u.push(c);i=i.concat(u)}for(var m=[],p=0,f=[],v=0;v<o;v++)f.push(r.a.createElement("td",{width:this.props.rowsWidth&&this.props.rowsWidth[v]?this.props.rowsWidth[v]:"",key:"tbody"+v}));for(var h=0;h<i.length;h++){var y=i[h],b=p%2==1?"odd":"";if(this.filter(y)){if(p++,this.props.maxRow&&p>=this.props.maxRow)break;var g=this.state.selectedId;g&&y&&g==y.id&&(b+=" active");for(var E=[],w=0;w<o;w++){var O=t(y,w,e);E.push(r.a.createElement("td",{key:"curValue"+w,width:this.props.rowsWidth&&this.props.rowsWidth[w]?this.props.rowsWidth[w]:""},O))}E=E&&E.length>0?E:r.a.createElement("td",null),m.push(r.a.createElement("tr",{key:h,className:b,onClick:this.selectRow.bind(this,y,this.props.selectedRow)},E))}}for(var k=m.length;k<n;k++){var I=k%2==1?"odd":"";m.push(r.a.createElement("tr",{key:f+k,className:I},f))}return m}},{key:"render",value:function(){var e=this.generateTHead(),t=this.generateTBody();return r.a.createElement("div",{className:"dev-test-table"},r.a.createElement("table",{className:this.props.tableClass?this.props.tableClass:""},e,r.a.createElement("tbody",null,t)))}}]),a}(r.a.Component),$t=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;return Ft(this,a),(n=t.call(this,e)).clearErrorMsg=function(){n.state.get_clearException1()},n.state=n.props._state,n.changeFilter=n.changeFilter.bind(Ut(n)),n.commitData=n.commitData.bind(Ut(n)),n.editJsonData=n.editJsonData.bind(Ut(n)),n.analysisData=n.analysisData.bind(Ut(n)),n.tableFilter=n.tableFilter.bind(Ut(n)),n.changeParseData=n.changeParseData.bind(Ut(n)),n.selectedTableRow=n.selectedTableRow.bind(Ut(n)),n}return _t(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Rt({},e._state))}},{key:"tableFilter",value:function(e){if(!e)return!1;if(0!=e.bussinessType&&1!=e.bussinessType)return!1;if(!this.state.isFilter)return!0;var t=this.state.filterObj;return!(t.filterMac&&t.filterMac.length>0&&(!e.macAddress||0!=e.macAddress.indexOf(t.filterMac)))&&(!(t.filterDataType&&(!e.dataType||e.dataType!=t.filterDataType))&&!(t.filterCommand&&(!e.command||t.filterCommand.indexOf(e.command)<0)))}},{key:"selectedTableRow",value:function(e){this.state.get_SelectedData1(e)}},{key:"changeParseData",value:function(e,t){this.state.selectedData1.parseData[e]=t}},{key:"analysisData",value:function(){var e=this.state.deviceAndWs.productInfo.data,t=this.state.propertyConfig.propertyConfig,a=this.state.propertyConfig.propertyConfigId;if(!(e&&a&&t&&this.state.selectedData1))return[];var n=a[[e.productVersion,e.deviceTypeId,e.deviceSubTypeId,this.state.selectedData1.command].join("-")];if(!n)return[];var i=t[n]?t[n]:{},o=this.state.selectedData1.parseData,c=[];if(1==this.state.selectedData1.dataFormat)for(var l in o)if("0104"==this.state.selectedData1.command||"0007"===this.state.selectedData1.command){c.push([l,r.a.createElement(zt,{type:"text",value:o[l],onChange:this.changeParseData.bind(this,l)})])}else c.push([l,o[l]]);else if(o)for(var s in i){var u=i[s].property,d=o[u];if(o&&void 0!==d){var m=i[s];if(m)if("0104"==this.state.selectedData1.command||"0007"===this.state.selectedData1.command){var p="text";"long"!=m.valueType&&"integer"!=m.valueType||(p="number"),c.push([m.propertyName,r.a.createElement(zt,{ruletype:m.javaType,type:p,value:d,onChange:this.changeParseData.bind(this,u)})])}else c.push([m.propertyName,d])}}return c}},{key:"editJsonData",value:function(e){var t=this.state.selectedData1,a=!t.editJson;if(a)t.editJson=a,this.setState({selectedData1:t});else{var n=this.refs.editJsonTextArea.getDOMNode().value,r=null;try{null!=(r=JSON.parse(n))&&(t.parseData=r),t.editJson=a,this.setState({selectedData1:t})}catch(e){Object(E.a)({description:"JSON格式化异常，请检查JSON字符串语法",type:"warn"})}}}},{key:"commitData",value:function(){var e=this.state.selectedData1;if(e){var t={packetStart:e.packetStart,deviceType:e.deviceType,deviceSubType:e.deviceSubType,dataVersion:e.dataVersion,command:e.command,macAddress:e.macAddress,parseData:e.parseData};Ht.send(JSON.stringify(t))}}},{key:"getExceptionDom",value:function(){var e=this.state.websocketMessage.deviceDebuggerException;if(e)return e.split("\r\n").map((function(e,t){return r.a.createElement("p",{key:"ExceptionDom"+t},e)}))}},{key:"changeFilter",value:function(e,t){this.setState({isFilter:e,filterObj:t})}},{key:"render",value:function(){var e=this.state,t=e.dataTypeList,a=e.websocketMessage,n=e.selectedData1;return r.a.createElement("div",null,r.a.createElement(Gt,{_state:this.state,dataTypeList:t,activeKey:"1",onChange:this.changeFilter,openDialog:this.props.openDialog}),r.a.createElement("div",{className:"dev-test-tab-content data-debug-page"},r.a.createElement("div",{className:"dev-test-data-wrap"},r.a.createElement("div",{className:"left-wrap"},r.a.createElement(Zt,{title:"报文列表",className:"add_data_table_scroll"},r.a.createElement(Xt,{thead:["处理时间","MAC地址","命令字","包标识","数据类型","报文长度","数据长度"],rows:a.devData,rowKey:["time","macAddress","command","packetSequence","dataTypeString","packetLengthString","dataLengthString"],rowsWidth:["","125px"],generateRule:"json",minRowCount:15,maxRow:601,tableClass:"fixed-head",filter:this.tableFilter,selectedRow:this.selectedTableRow,selectedRowId:n?n.id:null})),r.a.createElement(Zt,{title:"原始报文数据"},r.a.createElement("div",{className:"data-area"},r.a.createElement("div",{className:"data-input"},r.a.createElement("p",null,(n.packet?n.packet:"").replace(/(.{2})/g,"$1 "))),r.a.createElement("div",{className:"data-opera"},r.a.createElement("div",{className:"inner"},r.a.createElement("input",{type:"button",value:"复制",onClick:Yt.bind(this,n?n.packet:"")}))))),r.a.createElement(Zt,{title:"设备明文数据"},r.a.createElement("div",{className:"data-area"},r.a.createElement("div",{className:"data-input"},r.a.createElement("p",null,(n.data?n.data:"").replace(/(.{2})/g,"$1 "))),r.a.createElement("div",{className:"data-opera"},r.a.createElement("div",{className:"inner"},r.a.createElement("input",{type:"button",value:"复制",onClick:Yt.bind(this,n?n.data:"")}))))),r.a.createElement(Zt,{title:"调试错误信息"},r.a.createElement("div",{className:"data-area"},r.a.createElement("div",{className:"data-input exception-text"},this.getExceptionDom()),r.a.createElement("div",{className:"data-opera"},r.a.createElement("div",{className:"inner"},r.a.createElement("input",{type:"button",value:"复制",onClick:Yt.bind(this,a.deviceDebuggerException)}),r.a.createElement("p",null,r.a.createElement("input",{type:"button",value:"删除",onClick:this.clearErrorMsg}))))))),r.a.createElement("div",{className:"right-wrap"},r.a.createElement(Zt,{title:"报文解析列表"},n&&1==n.dataFormat&&null!=n.parseData?r.a.createElement("div",{className:"json-format-panel"},n&&n.editJson?r.a.createElement("div",{className:"editJsonPanel"},r.a.createElement("textarea",{defaultValue:n&&n.parseData?JSON.stringify(n.parseData):n.parseData+"",ref:"editJsonTextArea"})):r.a.createElement(Ge,{json:n.parseData,jsonCode:n.id})):r.a.createElement(Xt,{rows:this.analysisData(),minRowCount:24,rowsWidth:["60%",""],tableClass:"fixed-head"})),r.a.createElement("div",{className:"send-command-area"},r.a.createElement("div",{className:"inner"},r.a.createElement("p",null,r.a.createElement("input",{type:"button",value:n&&n.editJson?"保存编辑数据":"编辑JSON数据",style:{display:!n||1!=n.dataFormat||"0103"!=n.command&&"0104"!=n.command&&"0007"!=n.command?"none":"inline-block"},onClick:this.editJsonData}),r.a.createElement("input",{type:"button",value:"下发控制命令",style:{display:!n||"0104"!=n.command&&"0007"!=n.command?"none":"inline-block"},onClick:this.commitData}))))))))}}]),a}(r.a.Component),ea=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;return Ft(this,a),(n=t.call(this,e)).handleConfirm=function(e,t){n.setState({upgradeDialogClosable:!1,upgradeDialogTip:{},upgradeData:null})},n.handlecancel=function(){n.setState({upgradeDialogClosable:!1})},n.state=Rt({upgradeDialogClosable:!1,upgradeDialogTip:{},upgradeData:null,firmwareModules:[],deviceVersionType:"",mac:""},n.props._state),n.tableFilter=n.tableFilter.bind(Ut(n)),n.selectedTableRow=n.selectedTableRow.bind(Ut(n)),n.getOnlineDevice=n.getOnlineDevice.bind(Ut(n)),n.selectedDeviceFn=n.selectedDeviceFn.bind(Ut(n)),n.upgrade=n.upgrade.bind(Ut(n)),n.clearErrorMsg=n.clearErrorMsg.bind(Ut(n)),n.getExceptionDom=n.getExceptionDom.bind(Ut(n)),n.changeFilter=n.changeFilter.bind(Ut(n)),n}return _t(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Rt({},e._state))}},{key:"tableFilter",value:function(e){if(!e)return!1;if(2!=e.bussinessType&&3!=e.bussinessType)return!1;if(!this.state.isFilter)return!0;var t=this.state.filterObj;return!(t.filterMac&&t.filterMac.length>0&&(!e.macAddress||0!=e.macAddress.indexOf(t.filterMac)))&&(!t.bussinessType||t.bussinessType==e.bussinessType)}},{key:"selectedTableRow",value:function(e){this.state.get_SelectedData2(e)}},{key:"getOnlineDevice",value:function(){var e=[],t=0;for(var a in this.state.websocketMessage.onlineDevice)if((new Date).getTime()-this.state.websocketMessage.onlineDevice[a].time<=25e3){var n={id:++t,mac:a,packetStart:this.state.websocketMessage.onlineDevice[a].packetStart};e.push(n)}return e}},{key:"selectedDeviceFn",value:function(e){this.selectedDevice=e}},{key:"upgrade",value:function(e){var t=this;if(this.selectedDevice){var a=1==e?"模组升级":"MCU升级";Object(u.c)(u.a.getAllFirmwareVersionType,{deviceVersionTypeId:1==e?1:2}).then((function(e){0==e.code&&t.setState({firmwareModules:e.data})})),this.setState({upgradeDialogClosable:!0,tipconts:a,deviceVersionType:e,mac:this.selectedDevice.mac})}else Object(E.a)({description:"请先选择升级的设备！"})}},{key:"clearErrorMsg",value:function(){this.state.get_clearException2()}},{key:"getExceptionDom",value:function(){if(this.state.websocketMessage)return this.state.websocketMessage.deviceDebuggerException2.split("\r\n").map((function(e,t){return r.a.createElement("p",{key:"deviceDebuggerException2"+t},e)}))}},{key:"changeFilter",value:function(e,t){this.setState({isFilter:e,filterObj:t})}},{key:"render",value:function(){var e=this.state,t=e.selectedData2,a=e.upgradeDialogClosable,n=e.upgradeDialogTip,i=e.tipconts,o=e.firmwareModules,c=e.deviceVersionType,l=e.mac,s=this.props,u=s.firmwareVersionType,d=s.totalVersion,m=s.mainVersion,p=s.macList;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(Gt,{_state:this.state,dataTypeList:this.state.dataTypeList,activeKey:"2",onChange:this.changeFilter}),r.a.createElement("div",{className:"dev-test-tab-content equipment-upgrade-page"},r.a.createElement("div",{className:"dev-test-data-wrap"},r.a.createElement("div",{className:"left-wrap"},r.a.createElement(Zt,{title:"在线设备列表"},r.a.createElement("div",{className:"device-list"},r.a.createElement(Xt,{rows:this.getOnlineDevice(),rowKey:["id","mac"],generateRule:"json",minRowCount:26,rowsWidth:["25%",""],selectedRow:this.selectedDeviceFn})),0==this.props.hardwareType?r.a.createElement("div",{className:"device_upgrade_opera"},r.a.createElement("p",null,r.a.createElement("input",{type:"button",value:"模组升级",onClick:this.upgrade.bind(this,"1")})),r.a.createElement("p",{className:"line"}),r.a.createElement("p",null,r.a.createElement("input",{type:"button",value:"MCU升级",onClick:this.upgrade.bind(this,"2")}))):r.a.createElement("div",{className:"device_upgrade_opera"},r.a.createElement("p",null,r.a.createElement("input",{type:"button",value:"模组升级",onClick:this.upgrade.bind(this,"1")}))))),r.a.createElement("div",{className:"right-wrap"},r.a.createElement(Zt,{title:"报文列表",className:"add_data_table_scroll"},r.a.createElement(Xt,{thead:["处理时间","MAC地址","命令字","包标识","数据类型","报文长度","数据长度"],rows:this.state.websocketMessage.devData2,rowKey:["time","macAddress","command","packetSequence","dataTypeString","packetLengthString","dataLengthString"],rowsWidth:["","125px"],generateRule:"json",minRowCount:15,maxRow:601,tableClass:"fixed-head",filter:this.tableFilter,selectedRow:this.selectedTableRow,selectedRowId:this.state.selectedData1?this.state.selectedData1.id:null})),r.a.createElement(Zt,{title:"原始报文数据"},r.a.createElement("div",{className:"data-area"},r.a.createElement("div",{className:"data-input"},r.a.createElement("p",null,(t.packet?t.packet:"").replace(/(.{2})/g,"$1 "))),r.a.createElement("div",{className:"data-opera"},r.a.createElement("div",{className:"inner"},r.a.createElement("input",{type:"button",value:"复制",onClick:Yt.bind(this,t?t.packet:"")}))))),r.a.createElement(Zt,{title:"设备明文数据"},r.a.createElement("div",{className:"data-area"},r.a.createElement("div",{className:"data-input"},r.a.createElement("p",null,(t.data?t.data:"").replace(/(.{2})/g,"$1 "))),r.a.createElement("div",{className:"data-opera"},r.a.createElement("div",{className:"inner"},r.a.createElement("input",{type:"button",value:"复制",onClick:Yt.bind(this,t?t.data:"")}))))),r.a.createElement(Zt,{title:"调试信息控制台"},r.a.createElement("div",{className:"data-area"},r.a.createElement("div",{className:"data-input exception-text"}," ",this.getExceptionDom()," "),r.a.createElement("div",{className:"data-opera"},r.a.createElement("div",{className:"inner"},r.a.createElement("input",{type:"button",value:"复制",onClick:Yt.bind(this,this.state.websocketMessage.deviceDebuggerException2)}),r.a.createElement("p",null,r.a.createElement("input",{type:"button",value:"删除",onClick:this.clearErrorMsg})))))))))),r.a.createElement(v.a,{className:"upgradeDialog",title:n.tipconts||"",visible:a,footer:null,onCancel:this.handlecancel,maskClosable:!1},r.a.createElement(Dt,{tipconts:i,onCancel:this.handlecancel,deviceVersionType:c,macList:p,mac:l,firmwareModules:o,firmwareVersionType:u,totalVersion:d,mainVersion:m,changeFormData:this.props.changeFormData,get_clearDevData2:this.state.get_clearDevData2})))}}]),a}(r.a.Component),ta=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;return Ft(this,a),(n=t.call(this,e)).state={param:{command:n.props.code,mac:n.props.defaultMac}},n.vaild=n.vaild.bind(Ut(n)),n.onConfirm=n.onConfirm.bind(Ut(n)),n.onCancel=n.onCancel.bind(Ut(n)),n.bindParam=n.bindParam.bind(Ut(n)),n}return _t(a,[{key:"onConfirm",value:function(){var e=this.vaild();if(e)Object(E.a)({type:"error",description:e});else{var t=De()(this.state.param);t.command=this.props.code,this.props.onConfirm&&this.props.onConfirm(t),this.setState({param:{}})}}},{key:"onCancel",value:function(){this.setState({param:{}}),this.props.onCancel()}},{key:"vaild",value:function(){return!0}},{key:"bindParam",value:function(e,t,a){var n=Object.assign({},this.state.param),r=t;!t&&a&&(r=a.target.value),n[e]=r,this.setState({param:n})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"modal-body"},function(t){switch(t){case"0102":return e.vaild=function(){return e.state.param.mac?/[A-Fa-f\d]{12}/.test(e.state.param.mac)?void 0:"请输入正确的MAC地址":"请输入设备的MAC地址"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")})));case"0103":return e.vaild=function(){if(!e.state.param.mac)return"请输入设备的MAC地址";if(!/[A-Fa-f\d]{12}/.test(e.state.param.mac))return"请输入正确的MAC地址";try{JSON.parse(e.state.param.json)}catch(e){return"json格式错误，请校验"}},r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"JSON"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement("textarea",{onChange:e.bindParam.bind(e,"json",null)}))));case"0104":return e.vaild=function(){if(!e.state.param.mac)return"请输入设备的MAC地址";if(!/[A-Fa-f\d]{12}/.test(e.state.param.mac))return"请输入正确的MAC地址";if(!e.state.param.mac)return"请输入硬件配置信息";try{JSON.parse(e.state.param.json)}catch(e){return"json格式错误，请校验"}},r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"JSON"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement("textarea",{onChange:e.bindParam.bind(e,"json",null)}))));case"0107":return e.vaild=function(){if(!e.state.param.mac)return"请输入设备的MAC地址";if(!/[A-Fa-f\d]{12}/.test(e.state.param.mac))return"请输入正确的MAC地址";if(!e.state.param.json)return"请输入硬件配置信息";try{JSON.parse(e.state.param.json)}catch(e){return"json格式错误，请校验"}},r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"硬件配置信息(json)"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement("textarea",{onChange:e.bindParam.bind(e,"json",null)}))));case"0109":return e.vaild=function(){return e.state.param.mac?/[A-Fa-f\d]{12}/.test(e.state.param.mac)?e.state.param.ip?e.state.param.port?void 0:"请输入服务器端口":"请输入服务器IP地址":"请输入正确的MAC地址":"请输入设备的MAC地址"},r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"服务器IP地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement("input",{type:"text",value:e.state.param.ip,onChange:e.bindParam.bind(e,"ip",null)}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"服务器端口"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"integer",type:"number",maxLength:"4",value:e.state.param.port,onChange:e.bindParam.bind(e,"port")}))));case"010A":return e.vaild=function(){return e.state.param.mac?/[A-Fa-f\d]{12}/.test(e.state.param.mac)?e.state.param.uploadCycle?e.state.param.collectCycle?e.state.param.heatBeatCycle?void 0:"请输入心跳周期":"请输入采集周期":"请输入上传周期":"请输入正确的MAC地址":"请输入设备的MAC地址"},r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"上传周期(秒)"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"integer",type:"number",value:e.state.param.uploadCycle,onChange:e.bindParam.bind(e,"uploadCycle")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"采集周期(秒)"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"integer",type:"number",value:e.state.param.collectCycle,onChange:e.bindParam.bind(e,"collectCycle")}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"心跳周期(秒)"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"integer",type:"number",value:e.state.param.heatBeatCycle,onChange:e.bindParam.bind(e,"heatBeatCycle")}))));case"010B":case"0405":case"1405":case"0404":case"1404":case"1403":case"140E":return e.vaild=function(){return e.state.param.mac?/[A-Fa-f\d]{12}/.test(e.state.param.mac)?void 0:"请输入正确的MAC地址":"请输入设备的MAC地址"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"设备MAC地址"),r.a.createElement("div",{className:"form-group-input-out"},r.a.createElement(zt,{ruletype:"mac",type:"text",maxLength:"12",value:e.state.param.mac,onChange:e.bindParam.bind(e,"mac")})));default:return null}}(this.props.code)),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(m.a,{type:"primary",onClick:this.onConfirm},"确定"),r.a.createElement(m.a,{className:"cancel",onClick:this.onCancel},"取消")))}}]),a}(r.a.Component),aa=function(e){Vt(a,e);var t=Bt(a);function a(){return Ft(this,a),t.apply(this,arguments)}return _t(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"dev-test-header"},this.props.children)}}]),a}(r.a.Component),na=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;return Ft(this,a),(n=t.call(this,e)).state={},n}return _t(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"dev-test-item dev-test-receive "+this.props.className},r.a.createElement("p",null,r.a.createElement("input",{id:"btnReceive",type:"checkbox",checked:this.props.value,onChange:this.props.onChange}),r.a.createElement("label",{htmlFor:"btnReceive"},"接收报文")))}}]),a}(r.a.Component),ra=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;return Ft(this,a),(n=t.call(this,e)).state={focus:!1},n.selectCommand=n.selectCommand.bind(Ut(n)),n._onFocusHandler=n._onFocusHandler.bind(Ut(n)),n._onBlurHandler=n._onBlurHandler.bind(Ut(n)),n}return _t(a,[{key:"_onFocusHandler",value:function(e){e.nativeEvent.stopImmediatePropagation(),this.setState({focus:!this.state.focus})}},{key:"_onBlurHandler",value:function(){this.setState({focus:!1})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this._onBlurHandler,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._onBlurHandler,!1)}},{key:"selectCommand",value:function(e,t){this.props.onSelect&&this.props.onSelect(e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"dev-test-item dev-test-command "+this.props.className,onClick:this._onFocusHandler,style:{display:1==this.props.activeKey?"block":"none"}},r.a.createElement("div",{className:"command-select",style:{display:this.state.focus?"block":"none"}},r.a.createElement("ul",null,r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0102")},r.a.createElement("span",{className:"num"},"0102-"),r.a.createElement("span",{className:"txt",title:"请求加密"},"请求加密")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0103")},r.a.createElement("span",{className:"num"},"0103-"),r.a.createElement("span",{className:"txt",title:"非WIF实时数据"},"非WIF实时数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0104")},r.a.createElement("span",{className:"num"},"0104-"),r.a.createElement("span",{className:"txt",title:"控制数据"},"控制数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0107")},r.a.createElement("span",{className:"num"},"0107-"),r.a.createElement("span",{className:"txt",title:"硬件配置"},"硬件配置")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0109")},r.a.createElement("span",{className:"num"},"0109-"),r.a.createElement("span",{className:"txt",title:"切换服务器"},"切换服务器")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"010A")},r.a.createElement("span",{className:"num"},"010A-"),r.a.createElement("span",{className:"txt",title:"更改上传周期"},"更改上传周期")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"010B")},r.a.createElement("span",{className:"num"},"010B-"),r.a.createElement("span",{className:"txt",title:"解绑命令"},"解绑命令")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0405")},r.a.createElement("span",{className:"num"},"0405-"),r.a.createElement("span",{className:"txt",title:"上传运行数据"},"上传运行数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"1405")},r.a.createElement("span",{className:"num"},"1405-"),r.a.createElement("span",{className:"txt",title:"上传历史运行数据"},"上传历史运行数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"0404")},r.a.createElement("span",{className:"num"},"0404-"),r.a.createElement("span",{className:"txt",title:"上传控制数据"},"上传控制数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"1404")},r.a.createElement("span",{className:"num"},"1404-"),r.a.createElement("span",{className:"txt",title:"上传历史控制数据"},"上传历史控制数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"1403")},r.a.createElement("span",{className:"num"},"1403-"),r.a.createElement("span",{className:"txt",title:"非Wi-Fi设备数据"},"非Wi-Fi设备数据")),r.a.createElement("li",{onClick:this.selectCommand.bind(this,"140E")},r.a.createElement("span",{className:"num"},"140E-"),r.a.createElement("span",{className:"txt",title:"上传历史故障数据"},"上传历史故障数据")))))}}]),a}(r.a.Component),ia=window.location.protocol;Kt=ia.replace(/https?/,"wss");Object(i.connect)((function(e){return{deviceAndWs:e.getIn(["deviceDebug","deviceAndWs"]).toJS(),websocketMessage:e.getIn(["deviceDebug","websocketMessage"]).toJS(),dataTypeList:e.getIn(["deviceDebug","dataTypeList"]).toJS(),propertyConfig:e.getIn(["deviceDebug","propertyConfig"]).toJS(),deviceDebugAccountList:e.getIn(["deviceDebug","deviceDebugAccountList"]).toJS(),deviceDebugMacList:e.getIn(["deviceDebug","deviceDebugMacList"]).toJS(),selectedData1:e.getIn(["deviceDebug","selectedData1"]).toJS(),selectedData2:e.getIn(["deviceDebug","selectedData2"]).toJS(),productBaseInfo:e.getIn(["product","productBaseInfo"]).toJS()}}),(function(e){return{updateDevice:function(t){return e(Object(Ne.f)(t))},getwebsocketMessage:function(t){return e(Object(Ne.l)(t))},getToken:function(){return e(Object(Ne.k)())},resetData:function(){return e(Object(Ne.s)())},getDataTypeList:function(t){return e(Object(Ne.e)(t))},getPropertyConfig:function(t){return e(Object(Ne.i)(t))},get_SelectedData1:function(t){return e(Object(Ne.m)(t))},get_SelectedData2:function(t){return e(Object(Ne.n)(t))},get_clearException1:function(){return e(Object(Ne.q)())},get_clearException2:function(){return e(Object(Ne.r)())},get_clearDevData1:function(){return e(Object(Ne.o)())},get_clearDevData2:function(){return e(Object(Ne.p)())},updateDeviceDebugAccountList:function(t){return e(Object(Ne.t)(t))},updateDeviceDebugMacList:function(t){return e(Object(Ne.u)(t))}}}))(St=function(e){Vt(a,e);var t=Bt(a);function a(e){var n;return Ft(this,a),(n=t.call(this,e)).bindEvent=function(){Ht.onopen=function(){n.webSocketStatu=1,clearInterval(Qt),Qt=setInterval((function(){Ht.send("33")}),5e3);var e=n.props.deviceAndWs.productInfo.data,t="["+n.props.deviceAndWs.token.data+"|"+e.customerCode+"|"+e.deviceTypeId+"#"+e.deviceSubTypeId+"#"+e.productVersion+"]";Ht.send(t)},Ht.onmessage=function(e){n.state.isReceive&&n.props.getwebsocketMessage(JSON.parse(e.data))},Ht.onclose=function(e){n.webSocketStatu=0,clearInterval(Qt),n._mount&&"1006"==e.code&&setTimeout(function(){this.props.getToken()}.bind(Ut(n)),5e3),Ht=null}},n.goout=function(){console.log("---销毁---"),n.props.resetData(),Ht&&Ht.close(),clearInterval(Qt),Ht=null,n._mount=!1},n.setVisibleTestInfo=function(){n.setState({visibleTestInfo:!n.state.visibleTestInfo})},n.debugVisible=function(){n.setState({visibleTestInfo:!0})},n.changeFormData=function(e){n.setState(Rt({},e))},n.state={visibleTestInfo:!1,visibleExportData:!1,isReceive:!0,macList:[],command:{active:!1},activeKey:"1",selectedMac:{value:void 0},date:{value:void 0},firmwareVersionType:{value:void 0},mainVersion:{value:void 0},totalVersion:{value:void 0}},n.webSocketStatu=null,n.onCloseDialog=n.onCloseDialog.bind(Ut(n)),n.onSendCommand=n.onSendCommand.bind(Ut(n)),n.handleCancel=n.handleCancel.bind(Ut(n)),n.onSelectTab=n.onSelectTab.bind(Ut(n)),n.changeReceiveState=n.changeReceiveState.bind(Ut(n)),n.selectCommand=n.selectCommand.bind(Ut(n)),n.openDialog=n.openDialog.bind(Ut(n)),n}return _t(a,[{key:"componentDidMount",value:function(){var e=this;this.props.onRef&&this.props.onRef(this);var t=Object(xt.i)("productId")||this.props.productId,a=[],n=[];Object(u.d)(u.a.deviceDebugAccountGetList,{productId:t},{loading:!0}).then((function(r){0==r.code&&(a=r.data||[],e.props.updateDeviceDebugAccountList(r),Object(u.d)(u.a.debugSecretList,{productId:t},{loading:!0}).then((function(r){0==r.code&&(n=r.data||[],e.props.updateDeviceDebugMacList(r),a.length>0&&n.length>0&&(e._mount=!0,e.props.updateDevice(t),e.props.getDataTypeList(t),e.props.getPropertyConfig(t)),n.length||e.setVisibleTestInfo())})))}))}},{key:"componentWillUpdate",value:function(e,t){var a=e.deviceAndWs.wsUrl.data.ip,n=this.props.deviceAndWs.wsUrl.data.ip;if(a&&a!==n){if(!WebSocket||Ht)return;Ht=new WebSocket(Kt+"//"+a),this.bindEvent()}var r=t.token,i=this.state.token;null==Ht&&r&&r!==i&&(Ht=new WebSocket(Kt+"//"+e.queryServerConfig.ip),this.bindEvent())}},{key:"componentWillUnmount",value:function(){this.goout()}},{key:"onSelectTab",value:function(e){this.setState({activeKey:e})}},{key:"selectCommand",value:function(e){this.setState({command:{active:!0,code:e,mac:this.props.selectedData1?this.props.selectedData1.macAddress:""}})}},{key:"onSendCommand",value:function(e){var t={command:e.command,macAddress:e.mac,parseData:{}},a=null;for(var n in e)if("mac"==n)t.macAddress=e.mac;else if("command"==n)t.command=e.command;else if("json"==n){var r=JSON.parse(e.json);for(var i in null===a&&(a={}),r)a[i]=r[i]}else null===a&&(a={}),a[n]=e[n];t.parseData=a,Ht?this.setState({command:{active:!1}},(function(){return Ht.send(JSON.stringify(t))})):Object(E.a)({description:"没有已连接的设备"})}},{key:"onCloseDialog",value:function(){this.setState({command:{active:!1}})}},{key:"changeReceiveState",value:function(){var e=this.state.isReceive;this.setState({isReceive:!e})}},{key:"openDialog",value:function(){this.refs.dialog.openDialog()}},{key:"handleCancel",value:function(e){1==e?this.setState({visibleExportData:!this.state.visibleExportData}):this.setState({command:{active:!this.state.command.active}})}},{key:"render",value:function(){var e=this.state,t=e.visibleTestInfo,a=e.visibleExportData,n=e.activeKey,i=e.selectedMac,o=e.date,c=e.firmwareVersionType,l=e.mainVersion,u=e.totalVersion,d=e.isReceive,m=this.props,p=m.deviceDebugAccountList,f=m.deviceDebugMacList,h=m.productBaseInfo,y=m.productId,b=Object(xt.i)("productId")||y,g=Object(xt.i)("hardwareType")||h.hardwareType;return r.a.createElement("div",{className:"devDebuggingBox commonContentBox"},r.a.createElement("div",{className:"title"},r.a.createElement("div",{className:"titleName"},"在线设备调试工具"),r.a.createElement("div",{className:"titleOperation",onClick:this.setVisibleTestInfo},r.a.createElement("img",{src:Nt.a}),r.a.createElement("span",null,"配置调试信息"))),r.a.createElement("div",{className:"msui-wrapper-devDeviceList centent"},r.a.createElement("div",{className:"dev-test-content"},r.a.createElement(aa,null,r.a.createElement(s.a,{defaultActiveKey:n,onChange:this.onSelectTab},r.a.createElement(qt,{tab:"数据设备调试",key:"1"}),r.a.createElement(qt,{tab:"升级调试",key:"2"})),r.a.createElement("div",{className:1==this.webSocketStatu?"linkState":"linkState linkError"},1==this.webSocketStatu?"链接成功":"链接失败"),r.a.createElement("div",{className:"dev-test-header-right"},r.a.createElement(na,{className:1==n?"line":"",value:d,onChange:this.changeReceiveState}),r.a.createElement(ra,{onSelect:this.selectCommand,activeKey:n}))),r.a.createElement("div",{style:{display:1==n?"block":"none"}},r.a.createElement($t,{_state:this.props,openDialog:this.handleCancel.bind(this,1)})),r.a.createElement("div",{style:{display:2==n?"block":"none"}},r.a.createElement(ea,{_state:this.props,productBaseInfo:h,hardwareType:g,firmwareVersionType:c,totalVersion:u,mainVersion:l,changeFormData:this.changeFormData,macList:f.data}))),r.a.createElement(v.a,{className:"commandsDebugSytle",title:this.state.command.code+"命令调试",visible:this.state.command.active,maskClosable:!1,onCancel:this.onCloseDialog,footer:null},r.a.createElement(ta,{code:this.state.command.code,defaultMac:this.state.command.mac,onConfirm:this.onSendCommand,onCancel:this.onCloseDialog})),r.a.createElement("textarea",{id:"copyInput"}),a&&r.a.createElement(v.a,{title:"导出数据",visible:a,onCancel:this.handleCancel.bind(this,1),footer:null,maskClosable:!1},r.a.createElement(dt,{macList:f.data,productId:b,selectedMac:i,date:o,onCancel:this.handleCancel.bind(this,1),changeFormData:this.changeFormData}))),r.a.createElement(_e,{visibleFun:this.setVisibleTestInfo,pid:b,authorityType:h.authorityType,visible:t,deviceDebugAccountList:p,deviceDebugMacList:f}))}}]),a}(n.Component)),a("bLJM"),a("3fcW"),a("ZoxL"),a("pjDv"),a("sMBO");var oa=a("3NWV"),ca=a("yqJg"),la=(a("Jmwx"),a("BMrR")),sa=(a("rO+z"),a("kPKH"));function ua(e){var t=e.showDialog,a=e.registerImport,i=e.productBaseInfo,o=e.registerDialog,c=Object(n.useRef)(),l=function(e){t(e)};return r.a.createElement(v.a,{width:"50%",visible:o,centered:!0,title:"注册设备",className:"register-device-modal",onCancel:function(){return l("registerDialog")},maskClosable:!1,footer:[r.a.createElement(m.a,{key:"submit",type:"primary",onClick:function(){var e=c.current.getFileListUrl()[0];if(!e)return Object(E.a)({description:"请选择文件"}),!1;a(e)}},"确认"),r.a.createElement(m.a,{key:"cancel",onClick:function(){return l("registerDialog")}},"取消")]},r.a.createElement("div",{className:"register-device-form-wrapper"},0===i.accessModeId?r.a.createElement("div",{className:"tips"},r.a.createElement("div",null,"您已选择“初级认证”安全机制； "),r.a.createElement("div",null,"可选择“指定数据生成”机制，从本地导入数据，例如设备的物理地址、SN号、序列号、MAC列表；",r.a.createElement("a",{href:"http://skintest.hetyj.com/31438/6b0b20891e06ac31d0eed37a5083cca9.xlsx"},"导入模版")),r.a.createElement("div",null,"平台将生成12位的设备ID，总量最多生成2万条数据；")):r.a.createElement("div",{className:"tips"},r.a.createElement("div",null,"您的产品选择了云对云接入，需要从本地导入数据，例如设备的物理地址、SN号、序列号、MAC列表。",r.a.createElement("a",{href:"http://skintest.hetyj.com/31438/6b0b20891e06ac31d0eed37a5083cca9.xlsx"},"导入模版")),r.a.createElement("div",null," 平台将根据设备物理地址生成12位设备ID， 本次最多可以注册2万台设备。")),r.a.createElement("div",{className:"register-file"},r.a.createElement(la.a,{gutter:8,align:"middle"},r.a.createElement(sa.a,{span:3},r.a.createElement("span",{className:"address"},"地址附件：")),r.a.createElement(sa.a,{span:21},r.a.createElement(w.b,{ref:c,maxSize:10,format:".xls,.xlsx",isNotImg:!0}))))))}a("I9yi");function da(e){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ma(e){return function(e){if(Array.isArray(e))return pa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return pa(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return pa(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function fa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function va(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fa(Object(a),!0).forEach((function(t){ha(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ha(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ya(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ba(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ga(e,t,a){return t&&ba(e.prototype,t),a&&ba(e,a),e}function Ea(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wa(e,t)}function wa(e,t){return(wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Ia(e);if(t){var r=Ia(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return ka(this,a)}}function ka(e,t){return!t||"object"!==da(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ia(e){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sa=b.a.Option,ja=h.a.Search,Da={pageRows:10,pageIndex:1},Ca=(n.PureComponent,function(e){Ea(a,e);var t=Oa(a);function a(){var e;ya(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleSubmit=function(t,a){a.preventDefault();var n=e.props.form.validateFieldsAndScroll,r=e.props.getDeviceList;n((function(e,t){if(!e){console.log("Received values of form: ",t);var a=va({},Da);t.id&&(a.id=t.id),(t.status||0===t.status)&&(a.status=t.status),r(a)}}))},e}return ga(a,[{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a="请输入设备ID号";return 2===this.props.productBaseInfo.authorityType&&(a="请输入设备ID号"),r.a.createElement(g.a,{layout:"inline",className:"search-form"},r.a.createElement(g.a.Item,{label:"",colon:!1,style:{marginRight:0}},t("status",{initialValue:""})(r.a.createElement(b.a,{style:{width:"150px"},optionFilterProp:"children"},r.a.createElement(Sa,{key:"allStatus",value:""},"全部状态"),r.a.createElement(Sa,{key:"unRegistered",value:0},"未入网"),r.a.createElement(Sa,{key:"register",value:1},"已入网")))),r.a.createElement(g.a.Item,{label:"",colon:!1},t("id",{rules:[{max:100,message:"最多可以输入100个字符"}]})(r.a.createElement(ja,{placeholder:a,enterButton:!0,onSearch:function(t,a){return e.handleSubmit(t,a)}}))))}}]),a}(n.Component)),Na=g.a.create({name:"deviceSearch"})(Ca),xa=a("Ty5D"),Pa=a("v7xx"),Ta=a("M7r8");a("hmue");function Ra(e){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(){return(La=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Fa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Aa(e,t){return(Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Ma(e);if(t){var r=Ma(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Va(this,a)}}function Va(e,t){return!t||"object"!==Ra(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ma(e){return(Ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ba=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aa(e,t)}(o,e);var t,a,n,i=_a(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).click_1=function(){t.props.upData()},t.click_2=function(e){e.preventDefault();var a=t.props.form,n=a.validateFieldsAndScroll;a.resetFields;n((function(e,a){if(!e){var n=a,r={productId:t.props.productId};for(var i in n.productPic=t.imgForm.getFileList(),n.productPic.length>0?n.productPic=JSON.stringify(n.productPic.map((function(e,t){return{file:null,filename:e.name,filesrc:e.url}}))):n.productPic="",n.instruction=t.fileForm.getFileList(),n.instruction.length>0?n.instruction=JSON.stringify(n.instruction.map((function(e,t){return{file:null,filename:e.name,filesrc:e.url}}))):n.instruction="",n)n[i]?r[i]=n[i]:r[i]="";Object(u.d)(u.a.saveCommerceInfo,r,{needFormData:!0,loading:!0}).then((function(e){0==e.code&&t.props.upData(!0)}))}}))},t.weightCheck=function(e,t,a){0!=+t&&!+t||+t>2147483647?a("重量的输入值应为数字且小于2147483647"):a()},t.state={size:"",weight:"",productParam:"",introduction:"",supplier:"",contact:"",tel:"",productPic:[],instruction:[]},t.imgBack=!1,t.fileBack=!1,t}return t=o,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.props.productId;t&&Object(u.d)(u.a.getCommerceInfo,{productId:t},{loading:!0}).then((function(t){if(0==t.code){var a=t.data;e.setState({size:a.size,weight:a.weight,productParam:a.productParam,introduction:a.introduction,supplier:a.supplier,contact:a.contact,tel:a.tel});var n=t.data.productPic?JSON.parse(t.data.productPic):[],r=Object(xt.b)(n);n&&n.length>0&&(""==n[0]&&(r=[]),e.imgForm.setState({fileList:r}));var i=t.data.instruction?JSON.parse(t.data.instruction):[],o=Object(xt.b)(i);i&&i.length>0&&(""==i[0]&&(o=[]),e.fileForm.setState({fileList:o}))}}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.size,n=t.weight,i=t.productParam,o=t.introduction,c=t.supplier,l=t.contact,s=t.tel,u=this.props.form,d=u.getFieldDecorator,m=u.getFieldValue;return r.a.createElement(g.a,La({},{labelCol:{xs:{span:2},sm:{span:2}},wrapperCol:{xs:{span:18},sm:{span:18}}},{onSubmit:this.click_2,className:"commercialInfo"}),r.a.createElement("div",{className:"commercialInfo"},r.a.createElement("div",{className:"commonContentBox marginFR"},r.a.createElement("div",{className:"title"},"商业化信息",r.a.createElement("span",{className:"explain"},"填写商业化信息，以便于确保您的产品真实合法有效")),r.a.createElement("div",{className:"centent"},r.a.createElement("div",{className:"common_title_input"},r.a.createElement(g.a.Item,{label:"成品照片："},r.a.createElement(w.a,{onRef:function(t){return e.imgForm=t},maxCount:"9",format:".jpg,.png",maxSize:10}))),r.a.createElement(g.a.Item,{label:"尺寸："},d("size",{rules:[{max:20,message:"最大输入长度为20"}],initialValue:a})(r.a.createElement(h.a,{style:{width:"350px"},placeholder:"请输入您的尺寸 例:50*30*20",suffix:"mm"}))),r.a.createElement(g.a.Item,{label:"重量："},d("weight",{rules:[{validator:this.weightCheck,message:"重量的输入值应为数字且小于2147483647"}],initialValue:n&&n+""})(r.a.createElement(h.a,{style:{width:"350px"},placeholder:"请输入您的重量 例:10",suffix:"Kg"}))),r.a.createElement(Ta.a,{label:"产品参数：",formId:"productParam",astrictNub:"1000",rows:"5",placeholder:"产品参数,1000字符以内",getFieldDecorator:d,initialVal:i,getFieldValue:m}),r.a.createElement(Ta.a,{label:"产品介绍：",formId:"introduction",astrictNub:"1000",rows:"5",placeholder:"产品介绍,1000字符以内",getFieldDecorator:d,initialVal:o,getFieldValue:m}))),r.a.createElement("div",{className:"commonContentBox marginFR"},r.a.createElement("div",{className:"title"},"产品附件"),r.a.createElement("div",{className:"centent"},r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"产品说明书："),r.a.createElement("div",{className:"common_content"},r.a.createElement(w.a,{onRef:function(t){return e.fileForm=t},maxCount:"5",isNotImg:!0,format:".doc,.docx,.pdf,.jpg,.png",maxSize:20}))))),r.a.createElement("div",{className:"commonContentBox marginFR"},r.a.createElement("div",{className:"title"},"供应链信息",r.a.createElement("span",{className:"explain"},"填写商业化信息，以便于确保您的产品真实合法有效")),r.a.createElement("div",{className:"centent"},r.a.createElement(g.a.Item,{label:"供应商公司："},d("supplier",{rules:[{max:40,message:"最大输入长度为40"}],initialValue:c})(r.a.createElement(h.a,{style:{width:"350px"},placeholder:"请输入您的供应商公司名称"}))),r.a.createElement(g.a.Item,{label:"联系人："},d("contact",{rules:[{max:20,message:"最大输入长度为20"}],initialValue:l})(r.a.createElement(h.a,{style:{width:"350px"},placeholder:"请输入您的联系人姓名"}))),r.a.createElement(g.a.Item,{label:"联系方式："},d("tel",{rules:[{max:20,message:"最大输入长度为20"}],initialValue:s})(r.a.createElement(h.a,{style:{width:"350px"},placeholder:"请输入您的联系人方式"}))))),r.a.createElement(Pa.a,{preHandle:this.click_1,nextText:this.props.isEdit?"更新":"发布产品",nextHandle:this.click_2})))}}])&&Fa(t.prototype,a),n&&Fa(t,n),o}(n.Component),Ja=g.a.create({name:"UpDataCommercialInfo"})(Ba),Ua=a("k5nK");a("K/dW");function Wa(e){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ya(e,t){return(Ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=za(e);if(t){var r=za(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Ka(this,a)}}function Ka(e,t){return!t||"object"!==Wa(t)&&"function"!=typeof t?Qa(e):t}function Qa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function za(e){return(za=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ga=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ya(e,t)}(o,e);var t,a,n,i=Ha(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).state={publishProductInfo:{commerceInfo:{},moduleInfo:{},productBaseInfo:{}},upDataShow:!1},t.clickFile=t.clickFile.bind(Qa(t)),t.upData=t.upData.bind(Qa(t)),t.getPublishProductInfoFun=t.getPublishProductInfoFun.bind(Qa(t)),t}return t=o,(a=[{key:"getPublishProductInfoFun",value:function(){var e=this;Object(u.d)(u.a.getPublishProductInfo,{productId:this.props.productId},{loading:!0}).then((function(t){0==t.code&&e.setState({publishProductInfo:t.data})}))}},{key:"componentDidMount",value:function(){this.props.productId&&this.getPublishProductInfoFun()}},{key:"componentDidUpdate",value:function(e){this.props.productId&&e.productId!=this.props.productId&&this.getPublishProductInfoFun()}},{key:"clickFile",value:function(e){window.open(e)}},{key:"upData",value:function(e,t){e&&this.getPublishProductInfoFun(),this.setState({upDataShow:!this.state.upDataShow})}},{key:"render",value:function(){var e=this,t=this.state,a=t.publishProductInfo,n=t.upDataShow,i=null,o=a.moduleInfo,l=o.createTime,s=o.modifyTime,u=a.commerceInfo?a.commerceInfo.mode:null;if(a.commerceInfo){var d=a.commerceInfo,m=d.supplier,p=d.contact,f=d.tel,v=d.size,h=d.weight,y=d.introduction,b=d.productParam,g=d.instruction,E=d.productPic;i=r.a.createElement("div",null,r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"商业化信息",0==u?r.a.createElement("div",{className:"update_box"},r.a.createElement("span",{className:"update under_review"},"审核中")):r.a.createElement("div",{className:"update_box"},r.a.createElement("span",{className:"createTime"},fe()(s||l).format("YYYY-MM-DD HH:mm:ss")),r.a.createElement("span",{className:"update",onClick:this.upData.bind(this,!1)},r.a.createElement(Ua.a,{style:{marginRight:"10px"}}),"更新"))),r.a.createElement("div",{className:"centent"},r.a.createElement("div",{className:"introductionBar"},r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"成品图片："),r.a.createElement("div",{className:"common_content"},E?JSON.parse(E).map((function(e,t){return r.a.createElement("img",{className:"productPic",key:"成品图片"+t,src:e.filesrc})})):"--")),r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"尺寸："),r.a.createElement("div",{className:"common_content"},r.a.createElement("span",null,v||"--"," mm"))),r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"重量："),r.a.createElement("div",{className:"common_content"},r.a.createElement("span",null,h||"--"," Kg"))),r.a.createElement("div",{className:"common_title_input"},r.a.createElement("div",{className:"common_title"},"产品参数："),r.a.createElement("div",{className:"common_content"},b)),r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"产品介绍："),r.a.createElement("div",{className:"common_content"},r.a.createElement("span",null,y||"--")))))),r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"产品附件"),r.a.createElement("div",{className:"centent"},r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"产品附件："),r.a.createElement("div",{className:"common_content"},g?JSON.parse(g).map((function(t,a){return r.a.createElement("div",{className:"links",key:"产品附件"+a,onClick:e.clickFile.bind(e,t.filesrc)},t.filename)})):null)))),r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"供应链信息"),r.a.createElement("div",{className:"centent"},r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"供应商公司："),r.a.createElement("div",{className:"common_content"},r.a.createElement("span",null,m||"--"))),r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"联系人："),r.a.createElement("div",{className:"common_content"},r.a.createElement("span",null,p||"--"))),r.a.createElement("div",{className:"common_title_input"},r.a.createElement("span",{className:"common_title"},"联系方式："),r.a.createElement("div",{className:"common_content"},r.a.createElement("span",null,f||"--"))))))}return r.a.createElement("div",null,n?r.a.createElement(Ja,{upData:this.upData,productId:this.props.productId,isEdit:!0}):r.a.createElement("div",{className:"product_info"},a.commerceInfo?i:r.a.createElement("div",null,r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"商业化信息"),r.a.createElement("div",{className:"centent"},r.a.createElement(c.a,null))),r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"产品附件"),r.a.createElement("div",{className:"centent"},r.a.createElement(c.a,null))),r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"供应链信息"),r.a.createElement("div",{className:"centent"},r.a.createElement(c.a,null))))))}}])&&qa(t.prototype,a),n&&qa(t,n),o}(n.Component),Za=(Object(xa.withRouter)(Ga),a("nXTq")),Xa=a.n(Za);function $a(e){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function en(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tn(e,t){return(tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function an(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=on(e);if(t){var r=on(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return nn(this,a)}}function nn(e,t){return!t||"object"!==$a(t)&&"function"!=typeof t?rn(e):t}function rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function on(e){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tn(e,t)}(o,e);var t,a,n,i=an(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).state={publishProductInfo:{commerceInfo:{},moduleInfo:{},productBaseInfo:{}}},t.moduleDetails=t.moduleDetails.bind(rn(t)),t.download=t.download.bind(rn(t)),t.getPublishProductInfoFun=t.getPublishProductInfoFun.bind(rn(t)),t}return t=o,(a=[{key:"getPublishProductInfoFun",value:function(){var e=this;Object(u.d)(u.a.getPublishProductInfo,{productId:this.props.productId},{loading:!0}).then((function(t){0==t.code&&e.setState({publishProductInfo:t.data})}))}},{key:"componentDidMount",value:function(){this.props.productId&&this.getPublishProductInfoFun()}},{key:"componentDidUpdate",value:function(e){this.props.productId&&e.productId!=this.props.productId&&this.getPublishProductInfoFun()}},{key:"moduleDetails",value:function(e){window.open(e)}},{key:"download",value:function(e){if(!e)return Object(E.a)({description:"下载地址为空！"}),!1;window.location=e}},{key:"render",value:function(){var e=this.state.publishProductInfo,t=e.moduleInfo,a=t.burnFileName,n=t.burnFileVersion,i=t.hetModuleTypeName,o=t.bindTypeName,c=t.netTypeName,l=t.supportFileTransfer,s=t.communicateSpeed,u=t.applyScope,d=t.originalModuleTypeName,m=t.readmePdf,p=t.modulePicture,f=t.burnFile,v=t.sourceCodeName,h=t.sourceCodeVersion,y=t.sourceCode,b=e.moduleInfo,g=(b.sizeHeight||"- * ")+(b.sizeThickness||"- * ")+(b.sizeWidth||"-"),E=e.productBaseInfo,w=E.hardwareType,O=E.commFreq;return r.a.createElement("div",null,r.a.createElement("div",{className:"product_info"},r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"硬件方案"),r.a.createElement("div",{className:"centent"},r.a.createElement("h4",null,"独立MCU方案"),r.a.createElement("p",null,"通信模组负责与云端信息的交互，通过串口与主控板（即MCU）进行通信，需要在MCU上进行协议解析与外设控制的开发。独立MCU方案能提供更丰富的系统资源，适合复杂的智能硬件设备。"))),r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"title"},"通信模组"),r.a.createElement("div",{className:"centent"},r.a.createElement("div",{className:"strategy"},r.a.createElement("div",{className:"strategy-content"},r.a.createElement("img",{className:"strategy-img",src:p||Xa.a}),r.a.createElement("div",{className:"moduleTypeName"},i),r.a.createElement("div",{className:"moduleDetails"},r.a.createElement("span",null,"芯片： "),r.a.createElement("span",null,d||"--")),r.a.createElement("div",{className:"moduleDetails"},r.a.createElement("span",null,"尺寸： "),r.a.createElement("span",null,g||"--")),r.a.createElement("div",{className:"moduleDetails single-text"},r.a.createElement("span",null,"适用： "),r.a.createElement(Ce.a,{placement:"topLeft",title:u||"--"},r.a.createElement("span",null,u||"--"))),r.a.createElement("div",{className:"moduleLink",onClick:this.moduleDetails.bind(this,m)},"模组详情"))),r.a.createElement("div",{className:"table"},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"支持通信技术"),r.a.createElement("td",null,o||"--")),r.a.createElement("tr",null,r.a.createElement("td",null,"支持配网方式"),r.a.createElement("td",null,c||"--")),r.a.createElement("tr",null,r.a.createElement("td",null,"文件传输能力"),r.a.createElement("td",null,null==l?"--":0==l?"否":"是")),r.a.createElement("tr",null,r.a.createElement("td",null,"通信通讯速率"),r.a.createElement("td",null,s||"--")),r.a.createElement("tr",null,r.a.createElement("td",null,"数据上报频率"),r.a.createElement("td",null,O||"--"))))),r.a.createElement("div",{className:"download"},r.a.createElement("p",null,"您选择的模组有通用固件程序，您可以下载固件程序自行烧录。"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{width:"25%"},"已选模组："),r.a.createElement("td",{width:"75%"},i)),r.a.createElement("tr",null,r.a.createElement("td",{width:"25%"},"固件程序："),r.a.createElement("td",{width:"75%"},0==w?a:v)),r.a.createElement("tr",null,r.a.createElement("td",{width:"25%"},"固件版本："),r.a.createElement("td",{width:"75%"},0==w?n:h)))),r.a.createElement("div",{className:"commonButBox"},r.a.createElement("div",{className:"commonButs",onClick:this.download.bind(this,0==w?f:y)},0==w?"下载固件程序":"下载模组源码")))))))}}])&&en(t.prototype,a),n&&en(t,n),o}(n.Component),ln=(Object(xa.withRouter)(cn),a("r7tM"),a("YQTV"),a("NUBc")),sn=(a("bipt"),a("lrIw")),un=(a("5s+n"),a("p532"),a("FC04"));a("4VdR");function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pn(e,t){return(pn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=hn(e);if(t){var r=hn(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return vn(this,a)}}function vn(e,t){return!t||"object"!==dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yn=["温馨提示：","产品标签是您给产品自定义的标识，标签的结构为：Key：value，您可以使用标签功能实现产品的分类统一管理。"],bn=(n.Component,a("75Mp"),a("55Ip"));a("VOqB");function gn(e){return(gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function On(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=In(e);if(t){var r=In(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return kn(this,a)}}function kn(e,t){return!t||"object"!==gn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function In(e){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sn=h.a.Search,jn=b.a.Option,Dn=(n.Component,a("Qb2f"),a("Y2jk"),a("zeV3")),Cn=(a("O+5t"),a("wFql")),Nn=(a("k994"),a("NJEC")),xn=(a("tULf"),a("Vl3Y")),Pn=(a("QCje"),a("fyUT")),Tn=(a("ls82"),a("x0AG"),["editing","dataIndex","title","inputType","record","index","children"]);function Rn(e){return function(e){if(Array.isArray(e))return Bn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(e,t,a,n,r,i,o){try{var c=e[i](o),l=c.value}catch(e){return void a(e)}c.done?t(l):Promise.resolve(l).then(n,r)}function Fn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function An(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(a),!0).forEach((function(t){_n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,i=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw r}}return i}(e,t)||Mn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mn(e,t){if(e){if("string"==typeof e)return Bn(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Bn(e,t):void 0}}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Jn(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}for(var Un=[],Wn=0;Wn<5;Wn++)Un.push({key:Wn.toString(),name:"Edrward ".concat(Wn),age:32,address:"London Park no. ".concat(Wn)});var qn=function(e){var t=e.editing,a=e.dataIndex,n=e.title,i=e.inputType,o=(e.record,e.index,e.children),c=Jn(e,Tn),l="number"===i?r.a.createElement(Pn.a,null):r.a.createElement(h.a,null);return r.a.createElement("td",c,t?r.a.createElement(xn.a.Item,{name:a,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(n,"!")}]},l):o)};function Yn(){var e=Vn(xn.a.useForm(),1)[0],t=Vn(Object(n.useState)(Un),2),a=t[0],i=t[1],o=Vn(Object(n.useState)(""),2),c=o[0],l=o[1],s=Vn(Object(n.useState)({actionType:0,actionRecord:{},actionLoading:!1}),2),u=(s[0],s[1],function(e){return e.key===c});Object(n.useEffect)((function(){}),[]);var p=function(t){e.setFieldsValue(An({name:"",age:""},t)),l(t.key)},f=function(){l("")},v=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var r,o,c,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.validateFields();case 3:r=t.sent,o=Rn(a),(c=o.findIndex((function(e){return n===e.key})))>-1?(s=o[c],o.splice(c,1,An(An({},s),r)),i(o),l("")):(o.push(r),i(o),l("")),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log("Validate Failed:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})),function(){var e=this,a=arguments;return new Promise((function(n,r){var i=t.apply(e,a);function o(e){Ln(i,n,r,o,c,"next",e)}function c(e){Ln(i,n,r,o,c,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}(),h=[{title:"标签Key",dataIndex:"name",editable:!0},{title:"标签Value",dataIndex:"age",editable:!0},{title:"操作",dataIndex:"operation",render:function(e,t){return u(t)?r.a.createElement("span",null,r.a.createElement("a",{href:"#!",onClick:function(){return v(t.key)},style:{marginRight:8}},"保存"),r.a.createElement(Nn.a,{title:"Sure to cancel?",onConfirm:f},r.a.createElement("a",{href:"#!"},"取消"))):r.a.createElement(Dn.b,null,r.a.createElement(Cn.a.Link,{disabled:""!==c,onClick:function(){return p(t)}},"编辑"),r.a.createElement(Cn.a.Link,{disabled:""!==c},"删除"))}}].map((function(e){return e.editable?An(An({},e),{},{onCell:function(t){return{record:t,inputType:"text",dataIndex:e.dataIndex,title:e.title,editing:u(t)}}}):e}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(xn.a,{form:e,component:!1},r.a.createElement(d.a,{components:{body:{cell:qn}},dataSource:a,columns:h,rowClassName:"editable-row",pagination:!1})),r.a.createElement(m.a,{type:"primary",ghost:!0,className:"edit-table-btn",onClick:function(){!function(){if(!c){var e=JSON.parse(JSON.stringify(a)),t={key:"".concat(e.length+1),name:"面对疾风吧",age:9999};e.push(t),i(e),p(t)}}()}},"添加标签"))}function Hn(){return r.a.createElement("div",{id:"product-info"},r.a.createElement("div",{className:"product-info-item"},r.a.createElement("h3",{className:"product-info-title"},"产品信息"),r.a.createElement("div",{className:"product-info-content"},r.a.createElement("div",{className:"product-info-conten-wrap"},r.a.createElement("img",{className:"product-top-left-img"}),r.a.createElement("div",{className:"product-info-content-text"},r.a.createElement("div",null,r.a.createElement("span",null,"产品型号："),r.a.createElement("span",null,"HTSL-BB100]")),r.a.createElement("div",null,r.a.createElement("span",null,"网关子设备："),r.a.createElement("span",null,"HTSL-BB100]")),r.a.createElement("div",null,r.a.createElement("span",null,"通信安全验证："),r.a.createElement("span",null,"HTSL-BB100]")),r.a.createElement("div",null,r.a.createElement("span",null,"配网方式："),r.a.createElement("span",null,"HTSL-BB100]")))),r.a.createElement("div",{className:"product-info-conten-wrap"},r.a.createElement("div",{className:"product-info-content-text"},r.a.createElement("div",null,r.a.createElement("span",null,"配网方式："),r.a.createElement("span",null,"HTSL-BB100]")),r.a.createElement("div",null,r.a.createElement("span",null,"AP-SSID："),r.a.createElement("span",null,"HTSL-BB100]")),r.a.createElement("div",null,r.a.createElement("span",null,"AP-密码："),r.a.createElement("span",null,"HTSL-BB100]")))),r.a.createElement("div",{className:"product-info-conten-wrap",style:{paddingTop:"12px"}},r.a.createElement("div",{className:"product-top-right-text"},"配网方式："),r.a.createElement("img",{className:"product-top-right-img"})))),r.a.createElement("div",{className:"product-info-item"},r.a.createElement("h3",{className:"product-info-title"},"引导图"),r.a.createElement("div",{className:"product-info-content"},r.a.createElement("div",{className:"product-info-conten-wrap"},r.a.createElement("span",{className:"middle-text"},"配网引导图："),r.a.createElement("img",{className:"middle-img"})),r.a.createElement("div",{className:"product-info-conten-wrap"},r.a.createElement("span",{className:"middle-text"},"失败引导图："),r.a.createElement("img",{className:"middle-img"})),r.a.createElement("div",{className:"product-info-conten-wrap"},r.a.createElement("span",{className:"middle-text"},"帮助轮播图："),r.a.createElement("img",null)))),r.a.createElement("div",{className:"product-info-item"},r.a.createElement("h3",{className:"product-info-title"},"标准功能",r.a.createElement(O.a,{tip:"产品标签是您给产品自定义的标识，您可以使用标签功能实现产品的分类统一管理。"})),r.a.createElement("div",{className:"product-info-table"},r.a.createElement(Yn,null))))}var Kn=a("KPg2");a("QUgQ");function Qn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,i=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw r}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zn(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Gn(){var e=[{title:"DP ID",dataIndex:"name",key:"name"},{title:"功能名称",dataIndex:"age",key:"age"},{title:"标识符",dataIndex:"address",key:"address"},{title:"数据传输类型",dataIndex:"address",key:"action"},{title:"数据长度",dataIndex:"address",key:"action"},{title:"数据类型",dataIndex:"address",key:"action"},{title:"数据属性",dataIndex:"address",key:"action"}],t=Qn(Object(n.useState)([]),2),a=t[0];t[1];return r.a.createElement("div",{id:"product-detail-fun-defin"},r.a.createElement("div",null,r.a.createElement(m.a,{style:{padding:0},type:"link",icon:r.a.createElement(Kn.a,null)},"导出完整协议")),r.a.createElement("div",{className:"table-item"},r.a.createElement("h3",null,"标准功能"),r.a.createElement("div",null,r.a.createElement(d.a,{columns:e,dataSource:a}))),r.a.createElement("div",{className:"table-item"},r.a.createElement("h3",null,"自定义功能"),r.a.createElement("div",null,r.a.createElement(d.a,{columns:e,dataSource:a}))))}var Zn;a("9s7C");function Xn(e){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function er(e,t){return(er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=nr(e);if(t){var r=nr(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return ar(this,a)}}function ar(e,t){return!t||"object"!==Xn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rr=s.a.TabPane,ir=Object(i.connect)((function(e){return{deviceDebugAccountList:e.getIn(["deviceDebug","deviceDebugAccountList"]).toJS(),deviceDebugMacList:e.getIn(["deviceDebug","deviceDebugMacList"]).toJS()}}),(function(e){return{updateDeviceDebugAccountList:function(t){return e(Object(Ne.t)(t))},updateDeviceDebugMacList:function(t){return e(Object(Ne.u)(t))}}}))(Zn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&er(e,t)}(o,e);var t,a,n,i=tr(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).callback=function(e){var a=t.props.productId;window.location.hash="#/open/product/proManage/details/".concat(a,"?step=").concat(e)},t.state={steps:Object(xt.i)("step")||"1"},t}return t=o,(a=[{key:"render",value:function(){var e=this,t=this.props,a=t.productId,n=t.productBaseInfo;return t.protocolLists,n.authorityType,n.accessModeId,r.a.createElement("div",null,r.a.createElement(s.a,{defaultActiveKey:this.state.steps,onChange:function(t){return e.callback(t)}},r.a.createElement(rr,{key:"1",tab:"基本信息"},r.a.createElement(Hn,{productId:a})),r.a.createElement(rr,{key:"2",tab:"功能定义"},r.a.createElement(Gn,null))))}}])&&$n(t.prototype,a),n&&$n(t,n),o}(n.Component))||Zn;a("WjP9"),a("aTcW");t.default=Object(i.connect)((function(e){return{productBaseInfo:e.getIn(["product","productBaseInfo"]).toJS(),protocolLists:e.getIn(["product","productProtocolLists"]).toJS()}}),(function(e){return{getProductBaseInfo:function(t){return e(Object(o.d)(t))},getProtocolLists:function(t){return e(Object(o.f)(t))}}}))((function(e){var t=e.productBaseInfo,a=e.match,i=e.getProductBaseInfo,o=e.getProtocolLists,s=e.protocolLists,u=function(e){return+e.params.id}(a);if(Object(n.useEffect)((function(){u&&(i(u),o(u))}),[i,o,u]),!u)return r.a.createElement(c.a,{tipText:"没有传入产品ID哦"});var d=r.a.createElement("div",{className:"product_title_baseinfo_list"},r.a.createElement("div",null,r.a.createElement("div",null,"品类："),r.a.createElement("div",null,"睡眠监测")),r.a.createElement("div",null,r.a.createElement("div",null,"产品ID："),r.a.createElement("div",null,"睡眠监测")),r.a.createElement("div",null,r.a.createElement("div",null,"通讯协议："),r.a.createElement("div",null,"睡眠监测")),r.a.createElement("div",null,r.a.createElement("div",null,"产品编码："),r.a.createElement("div",null,"睡眠监测")),r.a.createElement("div",null,r.a.createElement("div",null,"产品密钥："),r.a.createElement("div",null,"睡眠监测")));return r.a.createElement("div",{className:"eidt-wrapper"},r.a.createElement(l.a,{title:"开发流程",titleTag:"免开发方案",btnTxt:"编辑",backTitle:"开发流程",children:d}),r.a.createElement("div",{className:"comm-shadowbox product-detail-wrap"},r.a.createElement(ir,{productId:u,protocolLists:s,productBaseInfo:t})))}))},vH1t:function(e,t,a){},yqJg:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=0}}]);