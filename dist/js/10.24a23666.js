(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"0eIn":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAACB0lEQVQ4T32ST2sTQRjGn9nZTTEKBeOtbv1T7zUHi8vmZMCw/QCBYsGT+DH88wEUeoseVTx4USyJFWpVYldaEJQEFROxCVqbi1Q0oWZnXpmZ3XRz0IXd2d2Z9/c+7/s+7HmzFzBChUi4RACZBwgYX6X6p/bQJViXS2fcmjrCXjS+d6QkdywoDdBAA44BitwtzZ2Y1oC1d9uUZDVJyagAYDGrcC4/9Up/AHi6ueVLIepqNzh7kmnAs7ffVISWTFI/RxDObb+Yn1pPA4QCEGHem0kAXzskyTWZk7pjFUlP0srUIYbuvHfKlLD6ZjsgiAqRdEe1GpIGDiWwvjOJ97uHMIhsHJ6IkJsYLu9QtvygzAZaxr8u7wYdsA5i1bbgZSzAYYATrxmOcJhB8b+Awm26agNXksCFWeBRA9Awc19jK5tfAoBVSKoS4mbGXrj1aRq/hw4cbrI/vAhcuLuvwrHQZisbWx1Vf9pAyfvSxxlwMCzmgYXT+4U+bgC1plbyhz15/Vm3jBMvnPeOjWZeDVv+nZZb74uMzq5k31sELt03CjKqHxxtVg3b2jWcc780d3w08+rLD/7Gj1y9uXtk1LzyLLDcMOUooK16UAvb2srGpuPzjyTDWu8ofkbZ8QmY4HBPoMiqYSsgQRWpfBAbJu0HQQytXzn09iYhyEaWiz5jfKkfWddvltngL3uXRG6qfr/OAAAAAElFTkSuQmCC"},"17x9":function(e,t,a){e.exports=a("WUjv")(13)},"4ZAH":function(e,t,a){},RGxR:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return re}));a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("+2oP"),a("sMBO"),a("pjDv"),a("tkto"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR"),a("mbEz");var n=a("wCAj"),r=(a("L/Qf"),a("2/Rp")),c=(a("Y2jk"),a("zeV3")),i=(a("tULf"),a("Vl3Y")),l=(a("1vPl"),a("5rEg")),o=(a("RKNx"),a("L41K")),u=(a("8QGh"),a("2fM7")),s=(a("zKZe"),a("q1tI")),f=a.n(s),m=a("MeRu"),d=a("0eIn"),p=a.n(d),b=(a("K4yd"),a("9yH6")),y=(a("k3Gp"),a("kLXV")),v=(a("AUBz"),a("ZTPi")),E=(a("JfAA"),a("2B1R"),a("ma9I"),a("4ZAH"),a("rwTb")),h=a("Nlzp");function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,c=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(c.push(n.value),!t||c.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var w=o.a.Step,N=v.a.TabPane;function C(e){var t=e.isModalVisible,a=e.colseMoadl,n=e.cancelModel,c=j(Object(s.useState)("0"),2),i=c[0],l=c[1],u=j(Object(s.useState)({one:{},two:{},three:{}}),2),m=u[0],d=u[1],p=Object(s.useRef)(null),b=Object(s.useRef)(null),E=Object(s.useRef)(null),O=[f.a.createElement("div",{key:"a"},i-0>0&&f.a.createElement(r.a,{style:{margin:"0 8px"},onClick:function(){l((i-0-1).toString())}},"上一步"),i-0<2&&f.a.createElement(r.a,{type:"primary",onClick:function(){0==i?p.current.onFinish():1==i&&b.current.onFinish()}},"下一步"),i-0==2&&f.a.createElement(r.a,{type:"primary",onClick:function(){E.current.onFinish()}},"完成"))],S=function(e,t){0==i?d((function(e){var a=JSON.parse(JSON.stringify(e));return a.one=JSON.parse(JSON.stringify(t)),a})):1==i&&d((function(e){var a=JSON.parse(JSON.stringify(e));return a.two=JSON.parse(JSON.stringify(t)),a})),l(e)};return f.a.createElement(y.a,{title:"新增订阅",visible:t,onCancel:n,width:"900px",wrapClassName:"add-subscribe-modal",footer:O},f.a.createElement("div",{className:"add-subscribe"},f.a.createElement("div",{className:"add-subscribe-main"},f.a.createElement("div",{className:"edit-left-protocol-wrap"}," ",f.a.createElement(v.a,{activeKey:i,renderTabBar:function(e,t){return f.a.createElement(o.a,{current:i-0},f.a.createElement(w,{title:"选择订阅对象"}),f.a.createElement(w,{title:"配置订阅内容"}),f.a.createElement(w,{title:"确定订阅方式"}))}},f.a.createElement(N,{tab:"Tab 1",key:"0"},f.a.createElement(A,{ref:p,continueStep:S})),f.a.createElement(N,{tab:"Tab 2",key:"1"},f.a.createElement(k,{ref:b,continueStep:S,oneData:m.one})),f.a.createElement(N,{tab:"Tab 3",key:"2"},f.a.createElement(T,{ref:E,finishSub:function(e){console.log(m,e,"=========");var t=g(g({},m.one),{},{devicePushDataConfList:m.two},e);Object(h.c)(h.a.addsubscribe,t).then((function(e){a()}))}})))))))}function A(e,t){var a=e.continueStep,n=j(i.a.useForm(),1)[0],r=j(Object(s.useState)([]),2),c=r[0],o=r[1];Object(s.useEffect)((function(){m()}),[]);var m=function(){Object(h.b)(h.a.productList).then((function(e){o(e.data)}))},d=function(){n.validateFields().then((function(e){var t="";c.forEach((function(a){a.productId==e.productId&&(t=a.productName)})),e.productName=t,localStorage.SELECT_SUBSCRI_NAME=t,a("1",e)}))},p=j(Object(s.useState)("0"),2),y=(p[0],p[1]),v=j(Object(s.useState)([]),2);v[0],v[1];return Object(s.useImperativeHandle)(t,(function(){return{onFinish:d}})),f.a.createElement("div",{className:"step-one"},f.a.createElement(i.a,{form:n,labelAlign:"right"},f.a.createElement(i.a.Item,{name:"subscription",label:"订阅名称",rules:[{required:!0}]},f.a.createElement(l.a,null)),f.a.createElement(i.a.Item,{name:"productId",label:"归属产品",rules:[{required:!0}]},f.a.createElement(u.a,{onChange:function(e){!function(e){Object(h.c)(h.a.getLabelByAddress,{productId:e,developerId:1}).then((function(e){var t=[];e.data.forEach((function(e){t.push({label:"Apple",value:"Apple"})}))}))}(e)}},c.map((function(e){return f.a.createElement(u.a.Option,{value:e.productId,key:e.productId},e.productName)})))),f.a.createElement(i.a.Item,{name:"radio-group",label:"选择设备"},f.a.createElement(b.a.Group,{onChange:function(e){y(e.target.value)}},f.a.createElement(b.a,{value:"a"},"全部设备"),f.a.createElement(b.a,{value:"b"},"根据标签筛选设备")))))}function k(e,t){var a=e.continueStep,r=e.oneData,c=[{title:"数据名称",dataIndex:"funcName",key:"funcName"},{title:"数据标识",dataIndex:"funcIdentifier",key:"funcIdentifier"}],i=j(Object(s.useState)({one:[],two:[],three:[]}),2),l=i[0],o=i[1],u=j(Object(s.useState)("a"),2),m=u[0],d=u[1];Object(s.useEffect)((function(){p()}),[]);var p=function(){Object(h.c)(h.a.standardFnList,{productId:r.productId}).then((function(e){var t=e.data.standard.concat(e.data.custom),a={};a.one=t.filter((function(e){if("properties"===e.funcType)return e})),a.two=t.filter((function(e){if("event"===e.funcType)return e})),a.three=t.filter((function(e){if("services"===e.funcType)return e})),o(a)}))},b=j(Object(s.useState)([]),2),y=b[0],E=b[1],O=j(Object(s.useState)([]),2),S=O[0],I=O[1],w=j(Object(s.useState)([]),2),C=w[0],A=w[1],k={onChange:function(e,t){var a=[];t.forEach((function(e){var n={dataType:5,dataTypeScope:t.length==l.one.length?2:1,protocolProperty:e.funcIdentifier};a.push(n)})),E(a)},getCheckboxProps:function(e){return{funcIdentifier:e.funcIdentifier}}},T={onChange:function(e,t){var a=[];t.forEach((function(e){var n={dataType:6,dataTypeScope:t.length==l.two.length?2:1,protocolProperty:e.funcIdentifier};a.push(n)})),I(a)},getCheckboxProps:function(e){return{name:e.funcIdentifier}}},P={onChange:function(e,t){var a=[];t.forEach((function(e){var n={dataType:7,dataTypeScope:t.length==l.three.length?2:1,protocolProperty:e.funcIdentifier};a.push(n)})),A(a)},getCheckboxProps:function(e){return{name:e.funcIdentifier}}},x=function(){a("2","a"==m?y:"b"==m?S:C)};return Object(s.useImperativeHandle)(t,(function(){return{onFinish:x}})),f.a.createElement("div",{className:"step-two"},f.a.createElement("div",{className:"product-title"},"已选择产品：",r.productName),f.a.createElement("div",{className:"select-tip"},"选择协议类型"),f.a.createElement(v.a,{defaultActiveKey:"a",activeKey:m,onChange:function(e){d(e)}},f.a.createElement(N,{tab:"属性",key:"a"},f.a.createElement(n.a,{rowSelection:g({},k),dataSource:l.one,columns:c,rowKey:"funcIdentifier"})),f.a.createElement(N,{tab:"事件",key:"b"},f.a.createElement(n.a,{dataSource:l.two,rowSelection:g({},T),columns:c,rowKey:"funcIdentifier"})),f.a.createElement(N,{tab:"服务",key:"c"},f.a.createElement(n.a,{dataSource:l.three,rowSelection:g({},P),columns:c,rowKey:"funcIdentifier"}))))}function T(e,t){var a=e.finishSub,n=j(i.a.useForm(),1)[0],r=function(){n.validateFields().then((function(e){a(e)}))};Object(s.useImperativeHandle)(t,(function(){return{onFinish:r}}));var c=j(Object(s.useState)("0"),2),o=c[0],u=c[1];return f.a.createElement("div",{className:"step-one"},f.a.createElement(i.a,{form:n,labelAlign:"right"},f.a.createElement(i.a.Item,{name:"pushWay",label:"订阅方式",rules:[{required:!0}]},f.a.createElement(b.a.Group,{onChange:function(e){u(e.target.value)}},f.a.createElement(b.a,{value:"0"},"API数据PUSH形式"),f.a.createElement(b.a,{value:"1"},"MQTT主题订阅"))),"0"===o&&f.a.createElement(i.a.Item,{name:"url",label:f.a.createElement(E.a,{label:"数据订阅URL",tip:"第三方云服务接口的唯一标识，供C-life云推送服务给第三方云推送数据使用，现仅支持http方式"}),rules:[{required:!0,message:"请输入"}]},f.a.createElement(l.a,null)),"0"===o&&f.a.createElement(i.a.Item,{name:"pushToken",label:f.a.createElement(E.a,{label:"Token",tip:"第三方云服务接口对接C-life云推送服务的凭证，用来验证厂商服务接口的合法性"}),rules:[{required:!0,message:"请输入"}]},f.a.createElement(l.a,null)),f.a.createElement(i.a.Item,{label:" ",colon:!1},f.a.createElement("a",null,"订阅帮助文档"))))}function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){R(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,c=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(c.push(n.value),!t||c.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}A=Object(s.forwardRef)(A),k=Object(s.forwardRef)(k),T=Object(s.forwardRef)(T);var M=o.a.Step,J=v.a.TabPane;function H(e){var t=e.editModelVis,a=e.colseMoadl,n=e.cancelModel,c=e.id,i=e.editData,l=D(Object(s.useState)("0"),2),u=l[0],m=l[1],d=D(Object(s.useState)({one:{},two:{},three:{}}),2),p=d[0],b=d[1],E=Object(s.useRef)(null),O=Object(s.useRef)(null),g=Object(s.useRef)(null),S=[f.a.createElement("div",{key:"a"},u-0>0&&f.a.createElement(r.a,{style:{margin:"0 8px"},onClick:function(){m((u-0-1).toString())}},"上一步"),u-0<2&&f.a.createElement(r.a,{type:"primary",onClick:function(){0==u?E.current.onFinish():1==u&&O.current.onFinish()}},"下一步"),u-0==2&&f.a.createElement(r.a,{type:"primary",onClick:function(){g.current.onFinish()}},"完成"))],j=function(e,t){0==u?b((function(e){var a=JSON.parse(JSON.stringify(e));return a.one=JSON.parse(JSON.stringify(t)),a})):1==u&&b((function(e){var a=JSON.parse(JSON.stringify(e));return a.two=JSON.parse(JSON.stringify(t)),a})),m(e)};return f.a.createElement(y.a,{title:"编辑订阅",visible:t,onCancel:n,width:"900px",wrapClassName:"add-subscribe-modal",footer:S},f.a.createElement("div",{className:"add-subscribe"},f.a.createElement("div",{className:"add-subscribe-main"},f.a.createElement("div",{className:"edit-left-protocol-wrap"}," ",f.a.createElement(v.a,{activeKey:u,renderTabBar:function(e,t){return f.a.createElement(o.a,{current:u-0},f.a.createElement(M,{title:"选择订阅对象"}),f.a.createElement(M,{title:"配置订阅内容"}),f.a.createElement(M,{title:"确定订阅方式"}))}},f.a.createElement(J,{tab:"Tab 1",key:"0"},f.a.createElement(U,{ref:E,continueStep:j,editData:i})),f.a.createElement(J,{tab:"Tab 2",key:"1"},f.a.createElement(L,{ref:O,continueStep:j,oneData:p.one,editData:i})),f.a.createElement(J,{tab:"Tab 3",key:"2"},f.a.createElement(W,{ref:g,finishSub:function(e){console.log(p,e,"=========");var t=x(x(x({},p.one),{},{devicePushDataConfList:p.two},e),{},{urlConfId:c});Object(h.c)(h.a.addsubscribe,t).then((function(e){a()}))},editData:i})))))))}function U(e,t){var a=e.continueStep,n=e.editData,r=D(i.a.useForm(),1)[0],c=D(Object(s.useState)([]),2),o=c[0],m=c[1];Object(s.useEffect)((function(){d(),r.setFieldsValue({subscription:n.subscription,productId:n.productId})}),[]);var d=function(){Object(h.b)(h.a.productList,{developerId:1}).then((function(e){m(e.data)}))},p=function(){r.validateFields().then((function(e){var t="";o.forEach((function(a){a.productId==e.productId&&(t=a.productName)})),e.productName=t,localStorage.SELECT_SUBSCRI_NAME=t,a("1",e)}))};return Object(s.useImperativeHandle)(t,(function(){return{onFinish:p}})),f.a.createElement("div",{className:"step-one"},f.a.createElement(i.a,{form:r,labelAlign:"right"},f.a.createElement(i.a.Item,{name:"subscription",label:"订阅名称",rules:[{required:!0}]},f.a.createElement(l.a,null)),f.a.createElement(i.a.Item,{name:"productId",label:"归属产品",rules:[{required:!0}]},f.a.createElement(u.a,null,o.map((function(e){return f.a.createElement(u.a.Option,{value:e.productId,key:e.productId},e.productName)})))),f.a.createElement(i.a.Item,{name:"radio-group",label:"选择设备"},f.a.createElement(b.a.Group,null,f.a.createElement(b.a,{value:"a"},"全部设备"),f.a.createElement(b.a,{value:"b"},"根据标签筛选设备"))),"a"===r.getFieldValue("radio-group")&&f.a.createElement(i.a.Item,{name:"address",label:""},f.a.createElement("div",null,f.a.createElement("div",null,"标签")))))}function L(e,t){var a=e.continueStep,r=e.oneData,c=[{title:"数据名称",dataIndex:"funcName",key:"funcName"},{title:"数据标识",dataIndex:"funcIdentifier",key:"funcIdentifier"}],i=D(Object(s.useState)({one:[],two:[],three:[]}),2),l=i[0],o=i[1],u=D(Object(s.useState)("a"),2),m=u[0],d=u[1];Object(s.useEffect)((function(){p()}),[]);var p=function(){Object(h.c)(h.a.standardFnList,{productId:r.productId}).then((function(e){var t=e.data.standard.concat(e.data.custom),a={};a.one=t.filter((function(e){if("properties"===e.funcType)return e})),a.two=t.filter((function(e){if("event"===e.funcType)return e})),a.three=t.filter((function(e){if("services"===e.funcType)return e})),o(a)}))},b=D(Object(s.useState)([]),2),y=b[0],E=b[1],O=D(Object(s.useState)([]),2),g=O[0],S=O[1],j=D(Object(s.useState)([]),2),I=j[0],w=j[1],N={onChange:function(e,t){var a=[];t.forEach((function(e){var n={dataType:5,dataTypeScope:t.length==l.one.length?2:1,protocolProperty:e.funcIdentifier};a.push(n)})),E(a)},getCheckboxProps:function(e){return{funcIdentifier:e.funcIdentifier}}},C={onChange:function(e,t){var a=[];t.forEach((function(e){var n={dataType:6,dataTypeScope:t.length==l.two.length?2:1,protocolProperty:e.funcIdentifier};a.push(n)})),S(a)},getCheckboxProps:function(e){return{name:e.funcIdentifier}}},A={onChange:function(e,t){var a=[];t.forEach((function(e){var n={dataType:7,dataTypeScope:t.length==l.three.length?2:1,protocolProperty:e.funcIdentifier};a.push(n)})),w(a)},getCheckboxProps:function(e){return{name:e.funcIdentifier}}},k=function(){a("2","a"==m?y:"b"==m?g:I)};return Object(s.useImperativeHandle)(t,(function(){return{onFinish:k}})),f.a.createElement("div",{className:"step-two"},f.a.createElement("div",{className:"product-title"},"已选择产品：",r.productName),f.a.createElement("div",{className:"select-tip"},"选择协议类型"),f.a.createElement(v.a,{defaultActiveKey:"a",activeKey:m,onChange:function(e){d(e)}},f.a.createElement(J,{tab:"属性",key:"a"},f.a.createElement(n.a,{rowSelection:x({},N),dataSource:l.one,columns:c,rowKey:"funcIdentifier"})),f.a.createElement(J,{tab:"事件",key:"b"},f.a.createElement(n.a,{dataSource:l.two,rowSelection:x({},C),columns:c,rowKey:"funcIdentifier"})),f.a.createElement(J,{tab:"服务",key:"c"},f.a.createElement(n.a,{dataSource:l.three,rowSelection:x({},A),columns:c,rowKey:"funcIdentifier"}))))}function W(e,t){var a=e.finishSub,n=e.editData;console.log(n,"liek");var r=D(Object(s.useState)("0"),2),c=r[0],o=r[1],u=D(i.a.useForm(),1)[0],m=function(){u.validateFields().then((function(e){a(e)}))};Object(s.useEffect)((function(){o(n.pushWay.toString()),0==n.pushWay?u.setFieldsValue({pushWay:n.pushWay.toString(),url:n.url,pushToken:n.pushToken}):u.setFieldsValue({pushWay:n.pushWay.toString()})}),[]),Object(s.useImperativeHandle)(t,(function(){return{onFinish:m}}));return f.a.createElement("div",{className:"step-one"},f.a.createElement(i.a,{form:u,labelAlign:"right"},f.a.createElement(i.a.Item,{name:"pushWay",label:"订阅方式",rules:[{required:!0}]},f.a.createElement(b.a.Group,{onChange:function(e){o(e.target.value)}},f.a.createElement(b.a,{value:"0"},"API数据PUSH形式"),f.a.createElement(b.a,{value:"1"},"MQTT主题订阅"))),"0"===c&&f.a.createElement(i.a.Item,{name:"url",label:f.a.createElement(E.a,{label:"数据订阅URL",tip:"第三方云服务接口的唯一标识，供C-life云推送服务给第三方云推送数据使用，现仅支持http方式"}),rules:[{required:!0,message:"请输入"}]},f.a.createElement(l.a,null)),"0"===c&&f.a.createElement(i.a.Item,{name:"pushToken",label:f.a.createElement(E.a,{label:"Token",tip:"第三方云服务接口对接C-life云推送服务的凭证，用来验证厂商服务接口的合法性"}),rules:[{required:!0,message:"请输入"}]},f.a.createElement(l.a,null)),f.a.createElement(i.a.Item,{label:" ",colon:!1},f.a.createElement("a",null,"订阅帮助文档"))))}U=Object(s.forwardRef)(U),L=Object(s.forwardRef)(L),W=Object(s.forwardRef)(W);var K=a("P2RN"),V=a("FC04");function Q(e){var t=e.operate,a=e.visible,n=e.updateOkHandle,r=e.updateCancelHandle,c=e.actionObj,i=null;switch(t){case 1:i={title:"启动数据订阅",desc:"启动",needWarnIcon:!1};break;case 2:i={title:"停用数据订阅",desc:"停用",needWarnIcon:!0}}return f.a.createElement(V.a,{visible:a,modalOKHandle:function(){return n(t)},modalCancelHandle:r,targetName:c.subscription,title:i.title,descGray:!0,needWarnIcon:i.needWarnIcon,descText:i.desc,tipText:i.tip})}a("qSPm");function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,c=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(c.push(n.value),!t||c.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Z=[{title:"数据名称",dataIndex:"funcName",key:"funcName"},{title:"数据标识",dataIndex:"funcIdentifier",key:"funcIdentifier"},{title:"数据属性",dataIndex:"funcType",key:"funcType"}];function Y(e){var t=e.rightVisible,a=e.onCloseRight,r=e.id,c=B(Object(s.useState)({devicePushDataConfList:[]}),2),i=c[0],l=c[1];Object(s.useEffect)((function(){o()}),[]);var o=function(){var e=h.a.subscribeDetail+"?urlConfId="+r;Object(h.c)(e).then((function(e){l(e.data)}))};return f.a.createElement(y.a,{title:"远程配置任务",footer:!1,visible:t,onOk:a,onCancel:a,width:"900px"},f.a.createElement("div",{className:"subscrbe-info"},f.a.createElement("div",{className:"subscrbe-c"},f.a.createElement("div",{className:"subscrbe-t"},"订阅对象"),f.a.createElement("div",{className:"subscrbe-item"},f.a.createElement("div",{className:"item-label"},"订阅名称："),f.a.createElement("div",{className:"item-value"},i.subscription)),f.a.createElement("div",{className:"subscrbe-item"},f.a.createElement("div",{className:"item-label"},"归属产品："),f.a.createElement("div",{className:"item-value"},i.productName)),f.a.createElement("div",{className:"subscrbe-item"},f.a.createElement("div",{className:"item-label"},"订阅设备："),f.a.createElement("div",{className:"item-value"},i.subscription)),f.a.createElement("div",{className:"subscrbe-t"},"配置数据"),f.a.createElement(n.a,{dataSource:i.devicePushDataConfList,columns:Z}),f.a.createElement("div",{className:"subscrbe-t",style:{marginTop:"22px"}},"订阅方式"),f.a.createElement("div",{className:"subscrbe-item"},f.a.createElement("div",{className:"item-label"},"订阅方式："),f.a.createElement("div",{className:"item-value"},i.pushWay?"MQTT主题订阅":"API数据PUSH形式")),f.a.createElement("div",{className:"subscrbe-item"},f.a.createElement("div",{className:"item-label"},"数据订阅URL："),f.a.createElement("div",{className:"item-value"},i.url)),f.a.createElement("div",{className:"subscrbe-item"},f.a.createElement("div",{className:"item-label"},"Token："),f.a.createElement("div",{className:"item-value"},i.pushToken)))))}a("rvOk");var q=a("wd/R"),G=a.n(q);function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){$(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function $(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,c=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(c.push(n.value),!t||c.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ae=u.a.Option,ne=o.a.Step;l.a.Search;function re(){var e=ee(i.a.useForm(),1)[0],t=ee(Object(s.useState)([]),2),a=(t[0],t[1],ee(Object(s.useState)({}),2)),d=(a[0],a[1],ee(Object(s.useState)([]),2)),b=d[0],y=d[1],v=ee(Object(s.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),E=v[0],O=v[1],g=ee(Object(s.useState)(!1),2),S=g[0],j=g[1],I=ee(Object(s.useState)(null),2),w=I[0],N=I[1],A=ee(Object(s.useState)({}),2),k=A[0],T=A[1],P=function(e,t){j(!0),T(t),N(e)},x=ee(Object(s.useState)(!1),2),R=x[0],D=x[1];Object(s.useEffect)((function(){F()}),[E.pageRows,E.pageIndex]);var F=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a={devicePushUrlConf:_(_({},e.getFieldsValue()),{},{developerId:1}),pager:E};Object(h.c)(h.a.subscribeList,a,{loading:t}).then((function(e){y(e.data.list),O((function(t){var a=JSON.parse(JSON.stringify(t));return Object.assign(a,{totalRows:e.data.pager.totalRows})}))}))},M=ee(Object(s.useState)(!1),2),J=M[0],U=M[1],L=ee(Object(s.useState)(!1),2),W=L[0],V=L[1],B=ee(Object(s.useState)({devicePushDataConfList:[]}),2),z=B[0],Z=B[1],q=[{title:"订阅ID",dataIndex:"urlConfId",key:"urlConfId"},{title:"订阅名称",dataIndex:"subscription",key:"subscription"},{title:"订阅方式",dataIndex:"pushWay",key:"pushWay",render:function(e){return f.a.createElement("span",null,e?"MQTT主题订阅":"API数据PUSH形")}},{title:"归属产品名称",dataIndex:"productName",key:"productName"},{title:"订阅更新时间",dataIndex:"updateTime",key:"updateTime",render:function(e){return f.a.createElement("span",null,e&&G()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"状态",dataIndex:"pushState",key:"pushState",render:function(e){return f.a.createElement("span",null,e?"正常":"停用")}},{title:"操作",render:function(e,t){return f.a.createElement(c.b,{size:"middle"},f.a.createElement("a",{onClick:function(){var e;e=t,console.log(e,99),T(e),D(!0)}},"查看"),f.a.createElement("a",{onClick:function(){!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=h.a.subscribeDetail+"?urlConfId="+e.urlConfId;Object(h.c)(a,{},{loading:t}).then((function(t){Z(t.data),T(e),V(!0)}))}(t)}},"编辑"),t.pushState?f.a.createElement("a",{onClick:function(){P(2,t)}},"停用"):f.a.createElement("a",{onClick:function(){P(1,t)}},"启动"))}}];return f.a.createElement("div",{id:"subscribe-data"},f.a.createElement(m.a,{title:"数据订阅"},f.a.createElement("div",{className:"top-select"},f.a.createElement(u.a,{style:{width:200},allowClear:!0},f.a.createElement(ae,{value:"0"},"API数据PUSH形式 "),f.a.createElement(ae,{value:"1"},"MQTT主题订阅")))),f.a.createElement("div",{className:"comm-shadowbox setp-ttip"},f.a.createElement("div",{className:"step-title"},f.a.createElement("img",{src:p.a,alt:""}),f.a.createElement("span",null,"数据订阅步骤")),f.a.createElement(o.a,{current:-1,initial:0},f.a.createElement(ne,{title:"选择产品",description:"可根据产品订阅以及设备性能标签，选择需要的数据对象。"}),f.a.createElement(ne,{title:"配置订阅内容",description:"可知产品或设备的物模型，订阅详细的功能点数据信息。"}),f.a.createElement(ne,{title:"确定订阅方式",description:"支持数据发送服务或MQTT订阅，两种不同的方式。"}))),f.a.createElement("div",{className:"comm-shadowbox device-content"},f.a.createElement("div",{className:"content-top"},f.a.createElement("div",{className:"content-top-left"},f.a.createElement(i.a,{className:"device-filter-form",form:e,layout:"inline"},f.a.createElement(i.a.Item,{name:"push_way",label:"订阅方式"},f.a.createElement(u.a,{allowClear:!0,style:{width:"200px"}},f.a.createElement(ae,{value:"1"},"API数据PUSH形式"),f.a.createElement(ae,{value:"0"},"MQTT主题订阅"))),f.a.createElement(i.a.Item,{label:"订阅名称"},f.a.createElement(i.a.Item,{name:"subscription",noStyle:!0},f.a.createElement(l.a,{style:{width:"228px"}})),f.a.createElement(r.a,{type:"primary",onClick:function(){1==E.pageIndex?F():O((function(e){var t=JSON.parse(JSON.stringify(e));return Object.assign(t,{pageIndex:1})}))}},"查询")))),f.a.createElement(r.a,{type:"primary",onClick:function(){U(!0)}},"添加订阅")),f.a.createElement(n.a,{rowKey:"urlConfId",dataSource:b,columns:q,pagination:{defaultCurrent:1,current:E.pageIndex,onChange:function(e,t){t==E.pageRows?O((function(a){var n=JSON.parse(JSON.stringify(a));return Object.assign(n,{pageIndex:e,pageRows:t})})):O((function(e){var a=JSON.parse(JSON.stringify(e));return Object.assign(a,{pageIndex:1,pageRows:t})}))},pageSize:E.pageRows,total:E.totalRows,showQuickJumper:!0,pageSizeOptions:[10],showTotal:function(){return f.a.createElement("span",null,"共 ",f.a.createElement("a",null,E.totalRows)," 条")}}})),J&&f.a.createElement(C,{isModalVisible:J,cancelModel:function(){U(!1)},colseMoadl:function(){Object(K.a)({type:"success",description:"新增成功！"}),F(),U(!1)}}),S&&f.a.createElement(Q,{visible:S,operate:w,actionObj:k,updateOkHandle:function(){return function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(1===w){var t=h.a.subscribeStart+"?urlConfId="+k.urlConfId;Object(h.c)(t,{},{loading:e}).then((function(e){j(!1),Object(K.a)({type:"success",description:"操作成功！"}),F()}))}else{var a=h.a.subscribeClose+"?urlConfId="+k.urlConfId;Object(h.c)(a,{},{loading:e}).then((function(e){j(!1),Object(K.a)({type:"success",description:"操作成功！"}),F()}))}}()},updateCancelHandle:function(){j(!1)}}),R&&f.a.createElement(Y,{rightVisible:R,onCloseRight:function(){D(!1)},id:k.urlConfId}),W&&f.a.createElement(H,{editModelVis:W,colseMoadl:function(){Object(K.a)({type:"success",description:"编辑成功！"}),F(),V(!1)},editData:z,cancelModel:function(){V(!1)},id:k.urlConfId}))}},qSPm:function(e,t,a){},rvOk:function(e,t,a){}}]);