(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"17x9":function(e,t,n){e.exports=n("WUjv")(13)},GZn0:function(e,t,n){},UfPf:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAACe0lEQVQ4T12SW0hUQRjH/9/sOWdrvZWIlZeyTaIgtKtgYAh2kaALuBiJbyHBEtFj+NbSQ9KDD2I+ZBAkIXSBEMRd9aGlXKmUlixZckXR0lhQVtN11z3zxTnHNd15mZlv5v/j+/9nCGnDG5zPsBPXM8smyZzJkjvtinxRVXZgMf2usadU0R+MnNSx3sTMDcyczcYBM5jZuBRj5rcsxdOLFcXvt4LIG5zP1wgvWeo1lsYSbVuzVd+oBaEortpTxRNmB/4fkX2O1fVo1MYNDHaD+cQmZIsQjAkCOqT+9zm0THvt6ZI5EzD49VccjDc2G7dVlxUFBkZnK6Wuu0FwsYQKyF4Gnlw6U+L1BcKVEnSHwXWXz5baTcDA6KzRtOkXwAgxtyVy9nfvjM5lSbGW0TO9Ozq2kN2sCtySknJz7UkczV7Gt7Vcx6t6ilH/yIyhtjxutMzgCDPdXkraRHd4T+dCXN2lCUAlQN2YNRsC6xpqyPdlmlMBbQKM5AV52scL85YTqntvJnDlCHCzHHj3HegPAStxE/aAfJ8tgNWBacZaEzyPx5yNCuB8Vgfk7AD8k8A5J7C4Cjz0moAweT9NJZhZTQcQyNM67ryvErS2q0DwN/A6CNw4DpQXAC39gCaQoL7hSR8DF/5nIK08BTwdodJGheBsvw5k2YEPk0CVE1hJAI/6ANWGMPUMhQoVUruYZbVlxfqBIPZ0Tx3Mi0vVne8Azh8Grh0DfOPAxzAQiwOKkUHqW/YMhSoE0z2WcBmWSMATSwjFHyloXko6tr+AMMWBuI6aTUAK1Dv8s0hP6HdBNJ/UdUWXSuHgn0MxkHBpAsWqwIxC6IrraGmtp9g/2iRbbsfn9mgAAAAASUVORK5CYII="},q18a:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Q}));n("tkto"),n("pNMO"),n("5DmW"),n("27RR"),n("4Brf"),n("07d7"),n("0oug"),n("4mDm"),n("PKPk"),n("3bBZ"),n("+2oP"),n("sMBO"),n("pjDv"),n("mbEz");var a=n("wCAj"),r=(n("L/Qf"),n("2/Rp")),c=(n("1vPl"),n("5rEg")),i=(n("tULf"),n("Vl3Y")),o=(n("RKNx"),n("L41K")),l=(n("8QGh"),n("2fM7")),u=n("BkRI"),s=n.n(u),d=(n("FZtP"),n("qePV"),n("SYor"),n("ma9I"),n("TeQF"),n("2B1R"),n("q1tI")),f=n.n(d),m=n("MeRu"),p=n("UfPf"),y=n.n(p),v=n("Nlzp"),h=n("DgvE"),E=n("P2RN"),b=n("FC04"),O=(n("GZn0"),n("k3Gp"),n("kLXV")),g=(n("MKzF"),n("kaz8")),N=n("rwTb");function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=g.a.Group,P=l.a.Option;function C(e,t){var n=[];return e.forEach((function(e){e.funcParamList&&e.funcParamList.length&&e.funcParamList.forEach((function(a){var r=JSON.parse(JSON.stringify(e));t?r.funcParamList[0].statusQueryId||n.push(k(k({},r),a)):r.funcParamList[0].deviceFunctionId||n.push(k(k({},r),a))}))})),n.forEach((function(e,n){e.typeS=t,e.label=e.funcName,e.value=e.funcIdentifier,e.key=n})),n}function x(e){var t=e.addVisible,n=e.optionArr,a=e.addOk,c=e.CancelAdd,i=j(Object(d.useState)(n[0].productId),2),o=i[0],u=i[1],m=j(Object(d.useState)([]),2),p=m[0],y=m[1],h=j(Object(d.useState)([]),2),E=h[0],b=h[1],A=j(Object(d.useState)({}),2),S=A[0],k=A[1],w=j(f.a.useState({}),2),x=w[0],T=w[1],D=j(f.a.useState({}),2),M=D[0],B=D[1],V=j(Object(d.useState)({}),2),z=V[0],F=V[1],R=j(f.a.useState({}),2),U=R[0],Q=R[1],K=j(f.a.useState({}),2),L=K[0],Z=K[1];Object(d.useEffect)((function(){o&&H()}),[o]);var G=function(e){if(!e.length)return[];var t=[],n=[];return e.forEach((function(e){var a=n.indexOf(e.dataTypCN);a>-1?t[a].content.push(e):(n.push(e.dataTypCN),t.push({content:[e],title:e.dataTypCN}))})),t},H=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={filter:!1};t.productId=o,t.id&&t.id.trim()||delete t.id,Object(v.c)(v.a.scenceList,t,{loading:e}).then((function(e){var t=C(e.data.conditionFunc,!0),n=C(e.data.controlFunc,!1);y(G(t)),b(G(n))}))},W=function(){k({}),T({}),B({})};return f.a.createElement("div",null,f.a.createElement(O.a,{title:"自定义",visible:t,onOk:function(){var e=[];for(var t in S)e=e.concat(S[t]);var n=[];for(var r in z)n=n.concat(z[r]);var c={};c.productId=o,c.controlFunc=n,c.conditionFunc=e,Object(v.c)(v.a.saveScenceData,c).then((function(e){a(o)}))},onCancel:c,width:"905px",wrapClassName:"add-protocols-wrap"},f.a.createElement("div",{className:"scene-sevice-model"},f.a.createElement("div",{className:"top"},f.a.createElement("span",null,"产品名称："),f.a.createElement(l.a,{style:{width:220},value:o,onChange:function(e){u(e),W()},showSearch:!0,optionFilterProp:"children"},n.map((function(e){return f.a.createElement(P,{value:e.productId,key:e.productId},e.productName)})))),f.a.createElement("div",{className:"middle"},f.a.createElement("div",{className:"middle-clear"},f.a.createElement("span",{className:"middle-title"}," 场景触发条件设置",f.a.createElement(N.a,{tip:"物模型的可上行、可下行、可上行可下行3种数据类型都支持条件"})),f.a.createElement(r.a,{type:"primary",ghost:!0,onClick:W},"清空")),f.a.createElement("div",{className:"middle-tip"},"场景触发条件设置以后该功能点即可出现在App-场景-我的场景-添加条件处，作为场景的触发条件来设置")),f.a.createElement("div",{className:"content"},p.map((function(e,t){return f.a.createElement("div",{key:t,className:"content-item"},f.a.createElement("h3",null,e.title),f.a.createElement("div",null,f.a.createElement("div",{className:"scene-all-select"},f.a.createElement(g.a,{indeterminate:x[e.title]||!1,onChange:function(t){return function(e,t,n){k((function(a){var r=s()(a),c=[];return e.target.checked&&n.forEach((function(e){c.push(e.value)})),r[t]=c,r})),B((function(n){var a=s()(n);return a[t]=e.target.checked,a})),T((function(e){var n=s()(e);return n[t]=!1,n}))}(t,e.title,e.content)},checked:M[e.title]||!1},"全选")),f.a.createElement(I,{options:e.content,value:S[e.title]||[],onChange:function(t){return function(e,t,n){k((function(n){var a=s()(n);return a[t]=e,a})),T((function(a){var r=s()(a),c=!!e.length&&e.length<n.length;return r[t]=c,r})),B((function(a){var r=s()(a);return r[t]=e.length===n.length,r}))}(t,e.title,e.content)}})))}))),f.a.createElement("div",{className:"middle dev-dotted-line"},f.a.createElement("div",{className:"middle-clear"},f.a.createElement("span",{className:"middle-title"}," 场景执行动作设置",f.a.createElement(N.a,{tip:"物模型的仅可下行、可上行可下行2种数据类型支持动作"})),f.a.createElement(r.a,{type:"primary",ghost:!0,onClick:function(){F({}),Q({}),Z({})}},"清空")),f.a.createElement("div",{className:"middle-tip "},"场景执行动作设置以后，该功能点即可出现在APP-场景-我的场景-添加动作处，作为场景的执行动作来设置")),f.a.createElement("div",{className:"content"},E.map((function(e,t){return f.a.createElement("div",{key:t,className:"content-item"},f.a.createElement("h3",null,e.title),f.a.createElement("div",null,f.a.createElement("div",{className:"scene-all-select"},f.a.createElement(g.a,{indeterminate:U[e.title]||!1,onChange:function(t){return function(e,t,n){F((function(a){var r=s()(a),c=[];return e.target.checked&&n.forEach((function(e){c.push(e.value)})),r[t]=c,r})),Z((function(n){var a=s()(n);return a[t]=e.target.checked,a})),Q((function(e){var n=s()(e);return n[t]=!1,n}))}(t,e.title,e.content)},checked:L[e.title]||!1},"全选")),f.a.createElement(I,{options:e.content,value:z[e.title]||[],onChange:function(t){return function(e,t,n){F((function(n){var a=s()(n);return a[t]=e,a})),Q((function(a){var r=s()(a),c=!!e.length&&e.length<n.length;return r[t]=c,r})),Z((function(a){var r=s()(a);return r[t]=e.length===n.length,r}))}(t,e.title,e.content)}})))}))))))}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=l.a.Option,F=o.a.Step,R=[{value:"条件",key:!0},{value:"动作",key:!1}];function U(e,t){var n=[];return e.forEach((function(e){e.funcParamList&&e.funcParamList.length&&e.funcParamList.forEach((function(t){var a=JSON.parse(JSON.stringify(e));n.push(B(B({},a),t))}))})),n.forEach((function(e,n){e.typeS=t,e.key=n})),n}function Q(){var e=T(i.a.useForm(),1)[0],t=T(Object(d.useState)([]),2),n=t[0],u=t[1],p=T(Object(d.useState)([]),2),O=p[0],g=p[1],N=T(Object(d.useState)(""),2),j=N[0],A=N[1],S=T(Object(d.useState)([]),2),k=S[0],w=S[1];Object(d.useEffect)((function(){V()}),[]);var I=T(Object(d.useState)(!1),2),P=I[0],C=I[1],D=T(Object(d.useState)({}),2),M=D[0],B=D[1],V=function(){Object(v.c)(v.a.getProductPlus,{},{loading:!0}).then((function(e){var t=e.data||[],n=Object(h.h)("productId");n?(n=Number(n),A(n),t.forEach((function(e){n==e.productId&&L(e.productName)}))):(A(t[0].productId),L(t[0].productName)),g(t)}))},Q=T(Object(d.useState)(""),2),K=Q[0],L=Q[1],Z=function(e){A(e)};Object(d.useEffect)((function(){j&&(G(),O.forEach((function(e){e.productId==j&&L(e.productName)})))}),[j]);var G=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={filter:!0};t.productId=j,t.id&&t.id.trim()||delete t.id,Object(v.c)(v.a.scenceList,t,{loading:e}).then((function(e){var t=U(e.data.conditionFunc,!0),n=U(e.data.controlFunc,!1),a=t.concat(n);a.forEach((function(e,t){e.unikey=t})),w(s()(a)),H(s()(a))}))},H=function(t){var n=e.getFieldsValue(),a=t?s()(t):s()(k);"boolean"==typeof n.typeS&&(a=a.filter((function(e){if(n.typeS==e.typeS)return e}))),n.funcName&&n.funcName.trim()&&(a=a.filter((function(e){if(e.funcName.indexOf(n.funcName.trim())>-1)return e}))),u(a)},W=T(Object(d.useState)(!1),2),J=W[0],X=W[1],Y=[{title:"类型",dataIndex:"type",render:function(e,t){return f.a.createElement("span",null,t.typeS?"条件":"动作")}},{title:"数据类型",dataIndex:"dataTypCN",key:"dataTypCN"},{title:"归属产品名称",dataIndex:"authorityType",key:"authorityType",render:function(){return f.a.createElement("span",null,K)}},{title:"状态",dataIndex:"status",key:"status",render:function(e){return f.a.createElement("span",null,function(e){return"UNCOMMITED"==e?"未审核":"COMMITED"==e?"审核中":"OK"==e?"已通过":"REJECTED"==e?"驳回":"--"}(e))}},{title:"功能名称",dataIndex:"funcName",key:"funcName"},{title:"操作",dataIndex:"activeTime",key:"activeTime",render:function(e,t){return f.a.createElement("a",{onClick:function(){B(t),C(!0)}},"删除")}}];return f.a.createElement("div",{id:"device-regist2"},f.a.createElement(m.a,{title:"场景服务"},f.a.createElement("div",{className:"top-select"},f.a.createElement(l.a,{style:{width:150},value:j,onChange:Z,showSearch:!0,optionFilterProp:"children"},O.map((function(e){return f.a.createElement(z,{value:e.productId,key:e.productId},e.productName)}))))),f.a.createElement("div",{className:"comm-shadowbox comm-setp-ttip"},f.a.createElement("div",{className:"step-title"},f.a.createElement("img",{src:y.a,alt:""}),f.a.createElement("span",null,"配置场景步骤")),f.a.createElement(o.a,{current:-1,initial:0},f.a.createElement(F,{title:"配置自动化",description:"可进入产品设备联动服务，配置自动化条件和动作。"}),f.a.createElement(F,{title:"验证自动化",description:"可通过调试验证工具，对条件和动作进行功能验证。"}),f.a.createElement(F,{title:"发布自动化",description:"提交后，此功能点将出现在App的智能场景条件或动作内。"}),f.a.createElement(F,{title:"配置场景",description:"使用已发布的自动化条件和动作配置场景。"}))),f.a.createElement("div",{className:"comm-shadowbox device-content"},f.a.createElement("div",{className:"content-top"},f.a.createElement("div",{className:"content-top-left"},f.a.createElement(i.a,{className:"device-filter-form",form:e,layout:"inline"},f.a.createElement(i.a.Item,{name:"typeS",label:"类型"},f.a.createElement(l.a,{allowClear:!0,style:{width:"200px"}},R.map((function(e){return f.a.createElement(z,{value:e.key,key:e.key},e.value)})))),f.a.createElement(i.a.Item,{label:"功能名称"},f.a.createElement(i.a.Item,{name:"funcName",noStyle:!0},f.a.createElement(c.a,{style:{width:"465px"},placeholder:"功能名称"})),f.a.createElement(r.a,{type:"primary",onClick:function(){H()}},"查询")))),f.a.createElement(r.a,{type:"primary",onClick:function(){X(!0)}},"自定义")),f.a.createElement(a.a,{rowKey:"unikey",dataSource:n,columns:Y})),J&&f.a.createElement(x,{addVisible:J,addOk:function(e){Object(E.a)({type:"success",description:"提交成功！"}),e==j?G():Z(e),X(!1)},optionArr:O,CancelAdd:function(){X(!1)}}),P&&f.a.createElement(b.a,{visible:P,modalOKHandle:function(){var e="";e=M.typeS?v.a.delScenceRun+"?statusQueryId="+M.statusQueryId:v.a.delScenceControl+"?deviceFunctionId="+M.deviceFunctionId,Object(v.c)(e).then((function(e){Object(E.a)({type:"success",description:"删除成功！"}),C(!1),G()}))},modalCancelHandle:function(){C(!1)},targetName:M.funcName,title:"删除",descGray:!0,needWarnIcon:!0,descText:"确定删除此数据"}))}}}]);