(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"vT3+":function(e,t,a){"use strict";a.r(t);a("vxpS"),a("ThRY"),a("h4PX"),a("6wma"),a("8OWE"),a("L4wC"),a("KzFV"),a("2Kt1"),a("tpKs"),a("rsdX"),a("oCJ0"),a("L8Gl"),a("eVIo"),a("EO5n"),a("Y5Ue");var n=a("xc0u"),r=(a("7fbo"),a("LCR/")),l=(a("72Pr"),a("O4+N")),c=(a("sbOf"),a("spxj")),i=(a("gsuU"),a("q+fq")),o=a.n(i),u=a("DgvE"),d=a("Nlzp"),s=a("MeRu"),m=a("FC04"),f=(a("U4At"),a("KiF4")),p=(a("rJH4"),a("nKmx")),g=(a("mvry"),a("2L3m")),v=(a("bjE3"),a("wty1")),E=a("v7xx"),b=a("P2RN");function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var w=function(e){var t=e.warningInof,a=e.closeDetailMod,n=e.delwithWarn,r=t.alarmTime,l=t.warningTitle,c=t.state,s=t.warningWay,m=t.ruleName,h=t.warningDetail,w=t.deviceIds,O=t.dealDetail,x=t.id,j=y(Object(i.useState)(""),2),I=j[0],C=j[1],N=y(Object(i.useState)(""),2),k=N[0],S=N[1],T=1==c&&o.a.createElement(E.a,{style:{padding:"0"},preText:"取消",nextText:"提交",preHandle:a,nextHandle:function(){I?n({id:x,dealDetail:I}):Object(b.a)({description:"请填写处理记录",type:"warn"})}})||o.a.createElement(E.a,{style:{padding:"0"},nextBtn:!1,preText:"关闭",preHandle:a}),W=[12,24];return o.a.createElement(f.a,{className:"warningdetail-page",title:l,visible:!!l,width:700,onCancel:a,footer:T},o.a.createElement(g.a,{gutter:W},o.a.createElement(v.a,{span:5,className:"detail-label"},"告警时间："),o.a.createElement(v.a,{span:18},u.a.utcToDev(r)||"--")),o.a.createElement(g.a,{gutter:W},o.a.createElement(v.a,{span:5,className:"detail-label"},"告警消息类型："),o.a.createElement(v.a,{span:18},{0:"站内",1:"站内+邮件"}[s])),o.a.createElement(g.a,{gutter:W},o.a.createElement(v.a,{span:5,className:"detail-label"},"关联的告警规则："),o.a.createElement(v.a,{span:18},m||"--")),o.a.createElement(g.a,{gutter:W},o.a.createElement(v.a,{span:5,className:"detail-label"},"告警内容："),o.a.createElement(v.a,{span:18},o.a.createElement("div",{className:"border-texarea"},h||"--"))),o.a.createElement(g.a,{gutter:W},o.a.createElement(v.a,{span:5,className:"detail-label"},"告警设备ID："),o.a.createElement(v.a,{span:16},o.a.createElement("div",{className:"border-texarea"},k||w||"")),o.a.createElement(v.a,{span:2},o.a.createElement("a",{href:"javascript:",onClick:function(){Object(d.c)(d.a.getWarningInfo,{warningId:x},{loading:!0}).then((function(e){S(e.data.deviceIds)}))}},"刷新"))),o.a.createElement(g.a,{gutter:W},o.a.createElement(v.a,{span:5,className:"detail-label"},"处理记录："),o.a.createElement(v.a,{span:18},1==c&&o.a.createElement(p.a.TextArea,{rows:3,value:I||O||"",placeholder:"处理记录",onChange:function(e){C(e.target.value)}})||o.a.createElement("div",{className:"border-texarea"},I||O||""))))};function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var N=c.a.TabPane,k={pageRows:10,pageIndex:1},S=(t.default=function(e){var t=I(Object(i.useState)({}),2),a=t[0],n=t[1];Object(i.useEffect)((function(){r()}),[]);var r=function(){Object(d.c)(d.a.getDeviceWarningTotal,{loading:!0}).then((function(e){var t=e.data;n(t)}))};return o.a.createElement("section",{className:"device-secret-wrapper device-warningpage"},o.a.createElement("div",{className:"device-secret-header"},o.a.createElement(s.a,{noback:!0,title:"设备告警"}),o.a.createElement("div",{className:"device-secret-statistic clearfix"},o.a.createElement("div",{className:"common-id"},o.a.createElement("div",null,"待处理告警"),o.a.createElement("div",null,a.pendingCount)),o.a.createElement("div",{className:"used"},o.a.createElement("div",null,"已处理告警"),o.a.createElement("div",null,a.processedCount)),o.a.createElement("div",{className:"register"},o.a.createElement("div",null,"已发送告警"),o.a.createElement("div",null,a.sentCount)),o.a.createElement("div",{className:"unregistered time"},o.a.createElement("div",null,"最近告警时间"),o.a.createElement("div",null,a.leastWaringDate&&u.a.utcToDev(a.leastWaringDate)||"无")))),o.a.createElement(c.a,{defaultActiveKey:e.location.page||"1",tabBarStyle:{background:"#fff",padding:"0 24px",margin:"0"}},o.a.createElement(N,{tab:"告警列表",key:"1"},o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(S,null)))),o.a.createElement(N,{tab:"告警配置",key:"2"},o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(T,{_props:e}))))))},function(e){var t=I(Object(i.useState)({pager:{},list:[]}),2),a=t[0],n=t[1],r=I(Object(i.useState)({}),2),c=r[0],s=r[1];Object(i.useEffect)((function(){m(k)}),[]);var m=function(e){Object(d.c)(d.a.getWarningList,e,{loading:!0}).then((function(e){n(e.data)}))},f=[{title:"告警时间",dataIndex:"alarmTime",key:"alarmTime",render:function(e){return e?u.a.utcToDev(e):"--"}},{title:"告警标题",dataIndex:"warningTitle",key:"warningTitle"},{title:"告警状态",dataIndex:"state",key:"state",render:function(e){return o.a.createElement("span",null,{1:"待处理",2:"已处理",3:"已发送"}[e])}},{title:"告警消息类型",dataIndex:"warningWay",key:"warningWay",render:function(e){return o.a.createElement("span",null,{0:"站内",1:"站内+邮件"}[e])}},{title:"关联的告警规则",dataIndex:"ruleName",key:"ruleName"},{title:"操作",dataIndex:"id",key:"id",render:function(e,t){var a=t.state;return o.a.createElement("a",{onClick:function(){g(e)},href:"javascript:"},"1"==a?"处理":"查看")}}],p=function(e){m(x(x({},k),{},{pageIndex:e}))},g=function(e){Object(d.c)(d.a.getWarningInfo,{warningId:e},{loading:!0}).then((function(e){s(e.data)}))},v=function(){s({})},E=a.list,b=a.pager;return o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{rowKey:"id",columns:f,dataSource:E,pagination:{defaultCurrent:b.pageIndex,total:b.totalRows,onChange:p,current:b.pageIndex}}),o.a.createElement("p",null,"备注：仅限站内消息类型有“待处理”和“已处理状态”，站内消息+邮件均为“已发送”状态"),o.a.createElement(w,{warningInof:c,closeDetailMod:v,getIndexPage:p,delwithWarn:function(e){Object(d.d)(d.a.dealWithWarning,e,{loading:!0}).then((function(e){p(a.pager.pageIndex||1),v()}))}}))}),T=function(e){var t=I(Object(i.useState)({pager:{},list:[]}),2),a=t[0],c=t[1],s=I(Object(i.useState)([]),2),f=s[0],p=s[1];Object(i.useEffect)((function(){g(k)}),[]);var g=function(e){Object(d.c)(d.a.getWarningConfigLi,e,{loading:!0}).then((function(e){c(e.data)}))},v=[{title:"规则名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"运行状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"初始状态",1:"运行中",2:"已停止"}[e])}},{title:"最近编辑时间",dataIndex:"updateTime",key:"updateTime",render:function(e){return e?u.a.utcToDev(e):"--"}},{title:"操作",dataIndex:"id",key:"id",render:function(e,t){var a=t.id,n=t.name,l=t.status;return o.a.createElement("span",null,o.a.createElement("a",{href:"#/open/base/device/warningConfig/".concat(a)},"编辑"),o.a.createElement(r.a,{type:"vertical"}),1==l&&o.a.createElement("a",{onClick:function(){p([a,n,"stop"])},href:"javascript:"},"停止")||o.a.createElement("a",{onClick:function(){b(a)},href:"javascript:"},"启动"),o.a.createElement(r.a,{type:"vertical"}),o.a.createElement("a",{onClick:function(){p([a,n,"del"])},href:"javascript:"},"删除"))}}],E=function(e){g(x(x({},k),{},{pageIndex:e}))},b=function(e){Object(d.c)(d.a.startWarningConfigLi,{ruleId:e},{loading:!0}).then((function(e){E(a.pager.pageIndex||1)}))},y=a.list,h=a.pager;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"addwarning-btn"},o.a.createElement(n.a,{href:"#/open/base/device/addWarningConfig",icon:"plus",type:"primary"},"新增")),o.a.createElement(l.a,{rowKey:"id",columns:v,dataSource:y,pagination:{defaultCurrent:h.pageIndex,total:h.totalRows,onChange:E,current:h.pageIndex}}),o.a.createElement(m.a,{visible:f.length>0,modalOKHandle:function(){var e="del"==f[2]&&d.a.delWarningConfig||d.a.stopWarningConfig;Object(d.c)(e,{ruleId:f[0]},{loading:!0}).then((function(e){E(a.pager.pageIndex||1),p([])}))},modalCancelHandle:function(){p([])},title:"del"==f[2]?"删除":"停止",descText:"即将".concat("del"==f[2]?"删除":"停止","告警配置"),needWarnIcon:!0,targetName:f[1]}))}}}]);