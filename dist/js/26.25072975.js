(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"+tVk":function(e,t,a){},hmqF:function(e,t,a){"use strict";a.r(t);a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("+2oP"),a("sMBO"),a("pjDv"),a("tkto"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR"),a("mbEz");var n=a("wCAj"),r=(a("L/Qf"),a("2/Rp")),o=(a("tULf"),a("Vl3Y")),c=(a("8QGh"),a("2fM7")),i=(a("U8R4"),a("+eQT")),l=(a("1vPl"),a("5rEg")),u=a("BkRI"),s=a.n(u),m=(a("zKZe"),a("SYor"),a("2B1R"),a("q1tI")),d=a.n(m),f=a("55Ip"),p=a("Nlzp"),b=a("DgvE"),w=a("MeRu"),y=a("Wgwc"),g=a.n(y),h=a("wd/R"),O=a.n(h),v=(a("+tVk"),a("P2RN"));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,o=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}l.a.Search;var k=i.a.RangePicker,R=c.a.Option,P={1:"初始化",2:"运行中",3:"运行成功",4:"运行失败",5:"创建作业失败"};t.default=function(){Object(f.useHistory)();var e=I(o.a.useForm(),1)[0],t=I(Object(m.useState)(""),2),a=t[0],i=(t[1],I(Object(m.useState)([]),2)),u=i[0],y=i[1],h=I(Object(m.useState)([]),2),S=h[0],x=h[1],T=I(Object(m.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),D=T[0],C=T[1],N=[{title:"序号",dataIndex:"id",key:"id",width:80},{title:"名称",dataIndex:"name",key:"name",width:300},{title:"参数",dataIndex:"params",key:"params",width:"28%"},{title:"状态",dataIndex:"status",key:"status",width:120,render:function(e){return d.a.createElement("span",null,P[e])}},{title:"日志",dataIndex:"msg",key:"msg",width:"25%"},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:220,render:function(e){return e&&b.a.utcToDev(e)}},{title:"操作",key:"action",width:80,render:function(e,t){return d.a.createElement("div",{className:"operation"},d.a.createElement("a",{onClick:function(){return M(t.result)}},"下载"))}}],M=function(e){if(!e)return Object(v.a)({type:"warn",message:"暂无数据"});window.open(e)},A=function(){Object(p.c)(p.a.downDeviceDataList,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({origin:"open"},D),{loading:!0}).then((function(e){y(e.data.list),C((function(t){var a=s()(t);return a.totalRows=e.data.pager.totalRows,a}))}))};Object(m.useEffect)((function(){A()}),[D.pageIndex,D.pageRows,a]),Object(m.useEffect)((function(){F()}),[]);var F=function(){Object(p.b)(p.a.getProductType).then((function(e){x(e.data)}))};return d.a.createElement("div",{className:"download-data-page"},d.a.createElement(w.a,{title:"下载数据"}),d.a.createElement("div",{className:"comm-shadowbox filter"},d.a.createElement(o.a,{className:"device-filter-form",form:e,layout:"inline",autoComplete:"off"},d.a.createElement(o.a.Item,{name:"productId",label:"选择产品"},d.a.createElement(c.a,{showSearch:!0,optionFilterProp:"children",placeholder:"搜索产品名称",style:{width:200}},S&&S.map((function(e){return d.a.createElement(R,{value:e.productId,key:e.productId},e.productName)})))),d.a.createElement(o.a.Item,{name:"macStrs",label:"设备Mac"},d.a.createElement(l.a,{placeholder:"输入多个时以英文逗号隔开",allowClear:!0,style:{width:220}})),d.a.createElement(o.a.Item,{name:"times",label:"时间"},d.a.createElement(k,{showTime:!0,allowClear:!0,disabledDate:function(e){var t=g()().format("YYYY-MM-DD");return e&&(e<g()(t).subtract(7,"day")||e>=g()(t).subtract(-1,"day").second(1))}})),d.a.createElement(o.a.Item,{label:" ",colon:!1,style:{marginRight:"2px"}},d.a.createElement(r.a,{type:"primary",onClick:function(){var t=e.getFieldsValue(),a=t.productId,n=t.macStrs,r=t.times;if(!a||!n||!r)return Object(v.a)({type:"warn",messgae:"请输入查询条件"});var o={};r&&r.length&&(o.startTime=O()(r[0]).valueOf(),o.endTime=O()(r[1]).valueOf()),a&&(o.productId=a),n&&(o.macStrs=n.trim());var c={productId:a,originEnum:"open",macStrs:o.macStrs,startTime:o.startTime,endTime:o.endTime};Object(p.c)(p.a.createExport,c).then((function(e){0===e.code&&A()}))}},"查询")),d.a.createElement(o.a.Item,{label:" ",colon:!1,style:{marginRight:"0px"}},d.a.createElement(r.a,{onClick:function(){e.resetFields()}},"重置")))),d.a.createElement("div",{className:"comm-shadowbox pd22"},d.a.createElement(n.a,{columns:N,className:"ant-table-fixed",rowKey:"id",dataSource:u,pagination:{defaultCurrent:1,current:D.pageIndex,pageSize:D.pageRows,total:D.totalRows,showSizeChanger:!1,showQuickJumper:D.totalPages>5,onChange:function(e,t){C((function(a){return Object.assign(s()(a),{pageIndex:t===D.pageRows?e:1,pageRows:t})}))},showTotal:function(e){return d.a.createElement("span",null,"共 ",d.a.createElement("a",null,e)," 条")}}})))}}}]);