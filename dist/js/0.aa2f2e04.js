(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"11ds":function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAOKADAAQAAAABAAAAQAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/9sAhAAICAgICQgJCgoJDQ4MDg0TERAQERMcFBYUFhQcKxsfGxsfGysmLiUjJS4mRDUvLzVETkI+Qk5fVVVfd3F3nJzRAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wgARCABAADgDASIAAhEBAxEB/8QAGwAAAQUBAQAAAAAAAAAAAAAAAAECAwQFBgf/2gAIAQEAAAAAtgAOLTFrimh6B5rCO6V7HZOcvWSMdiZa97NFJzOGumqFWsoAH//EABkBAAIDAQAAAAAAAAAAAAAAAAIEAQMFBv/aAAgBAhAAAADsgKas91hFO7TAZs//xAAZAQADAQEBAAAAAAAAAAAAAAACAwUEBgf/2gAIAQMQAAAA8bcAvvxcFq1g5hjQR//EAC8QAAEDAwEFBwMFAAAAAAAAAAECAwQABRESICFRU5EGEBMVIjFBI3GSFDBUYrH/2gAIAQEAAT8A/ZbhSnWvFaZU4nODo9RH3FCJKJ0iO6Tw0mn4r8fR4yCgqGQk++Pts224PW+Sl5vePZafhQqXfobNvRJaIUpwYQj5zT77sh1brqipajknYstiauUdx1by0FLhTgU92fabdWgPqwDwoWFvnq6UOz7X8hXSrlBTCdbQlZVqTnvsF4iW+K609r1KdKtwz8Cn73CW8tY14J4UL1D4OdKF7hcHOlXWY1LdbU1nATg5rHd2UabXBe1IB+sf8FSWWf1Dv00e/AUGWeUjoKDDPKR0FX1CEPs6Ugej474V2mwW1Nx1hKVKKjuzS7xPWsqLgyf6ivN53MH4ivOJ/NH4ipMp6SpKnVZIGBuxsYrGx//EACMRAAIBAgYCAwAAAAAAAAAAAAECAwARBBASEyIxIZFRU2H/2gAIAQIBAT8ArWnnkPFAhhcEEZSzJCmpzYXqYYSdkkLH12KjnhYhEOWPKCDmpIuOjStBpXg3XzWHMW8NKkHJ0RxZ1BH7WzF9a+qWONSCEAOX/8QAJREAAgEDAwQCAwAAAAAAAAAAAQIDAAQREhMhBRAxUSNBMkJx/9oACAEDAQE/AM1szYU7b4PjimVkYqwII+jWatLSa8l2oVy2M1ZN1aximgWNTnxk/iaubK8jVpph98nPvt0ATtfgQuqtoPLDNPHfbr/PHnUf1rqSXQtGMkqFcjgLjtDPLA+uKRkb2po3t2Tnfkz/AGnubiRdLyuR6J7f/9k="},Cr9J:function(e,t,n){"use strict";n.d(t,"a",(function(){return $t}));n("vxpS"),n("ThRY"),n("h4PX"),n("6wma"),n("8OWE"),n("L4wC"),n("KzFV"),n("2Kt1"),n("gsuU"),n("tpKs"),n("rsdX"),n("L8Gl"),n("eVIo"),n("EO5n");var r,a,o,i=n("+Gi7"),A=n.n(i),c=n("E7L/"),u=n.n(c),l=(n("oCJ0"),n("M+R0"),n("N4lb"),n("SnyF"),n("wlSd"),n("WWzu"),n("kCMX"),n("q+fq")),s=n.n(l),d=(n("CAwR"),n("rhD2")),f=(n("3EvH"),n("n1yf"),n("WpQE")),p=n.n(f),m=n("11ds"),g=n.n(m),y=n("Fw8H"),b=n.n(y),v=n("vPre"),E=n.n(v),h=n("Q1S+"),O=n.n(h),w=n("qEOn"),C=n.n(w);function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=2101,Q=2201,B=2202,D=2301,S=2302,N=2401,P=(j(r={},I,"输入"),j(r,Q,"数据过滤"),j(r,B,"聚合计算"),j(r,D,"异常检测"),j(r,S,"业务表关联"),j(r,N,"输出"),r),T=(j(a={},I,p.a),j(a,Q,g.a),j(a,B,b.a),j(a,D,E.a),j(a,S,O.a),j(a,N,C.a),a),k=[I],M=[N],R=[{title:"输入",nodelists:[{nodeType:I,nodeName:P[I]}]},{title:"基础处理",nodelists:[{nodeType:Q,nodeName:P[Q]},{nodeType:B,nodeName:P[B]}]},{title:"高级处理",nodelists:[{nodeType:S,nodeName:P[S]}]},{title:"输出",nodelists:[{nodeType:N,nodeName:P[N]}]}],x=[{srcName:"设备名称",srcCode:"deviceId",srcType:"varchar",srcTableCode:""},{srcName:"时间",srcCode:"eventTime",srcType:"timestamp",srcTableCode:""}],U=(j(o={},I,{nodeName:"输入",productId:"",deviceList:[],deviceIds:[],propsOrEventList:[],propEvent:"0",props:[].concat(x),eventTimeField:"eventTime",propsCodes:[],anyContent:"",eventList:[],eventIdentifier:""}),j(o,Q,{nodeName:"数据过滤",condition:"and",props:[],anyContent:""}),j(o,B,{nodeName:"聚合计算",props:[],granularity:0,dims:[],dimsCode:[],measure:[],measureCode:[],funcs:[],windowType:0,windowDurings:{windowDuring:"",windowUnit:"s"},slideDurings:{slideDuring:"",slideUnit:"s"},anyContent:""}),j(o,D,{nodeName:"异常检测",checkProp:"",anyContent:""}),j(o,S,{nodeName:"业务表关联",datasourceId:"",tableCode:"",tableList:[],filedList:[],props:[],joinType:0,relate:{streamFieldCode:"",dimFieldCode:""},streamTableCode:"",selectedRowKeys:[],anyContent:""}),j(o,N,{nodeName:"输出",datasourceId:"",tableCode:"",tableList:[],props:[],filedList:[],selectedRowKeys:[],anyContent:"",dataSource:[]}),o),F=(n("+SM3"),n("SE39")),V=n("P2RN"),L=["inWhere"];function K(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||J(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,A=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){A=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(A)throw a}}return o}(e,t)||J(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){if(e){if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Z(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function z(e){var t=e.inWhere,n=void 0===t?"select":t,r=Z(e,L);switch(n){case"painter":return s.a.createElement(q,r);case"staticPainter":return s.a.createElement(H,r);case"select":default:return s.a.createElement(W,r)}}function W(e){var t=e.nodeType,n=e.nodeName;return s.a.createElement("div",{className:"real-node in-select",draggable:!0,onDragStart:function(e){e.stopPropagation(),e.currentTarget.style.opacity=.5;var r=e.currentTarget,a=e.clientX,o=e.clientY,i={l:r.offsetLeft,t:r.offsetTop,x:a,y:o,w:r.offsetWidth,h:r.offsetHeight,nodeType:t,nodeName:n};e.dataTransfer.setData("text/plain",JSON.stringify(i))},onDragEnd:function(e){e.currentTarget.style.opacity=1}},s.a.createElement("img",{src:T[t],alt:"icon"}),s.a.createElement("span",{className:"node-name"},n))}function q(e){var t=e.nodeType,n=e.id,r=e.location,a=e.pid,o=e.input,i=e.hasChildNode,A=e.focusNodeId,c=e.limitNodePostion,u=e.workStatu,d=e.recordStartPoint,f=e.addNewPath,p=e.changePathsByNodeId,m=e.changeNodeDataByIds,g=e.setFocusNode,y=e.clearMenu,b=G(Object(l.useState)(null),2),v=b[0],E=b[1],h=G(Object(l.useState)(null),2),O=h[0],w=h[1],C=Object(l.useRef)(null),j=function(){E((function(e){return null})),w(null)},I={left:"".concat(r[0],"px"),top:"".concat(r[1],"px")},Q=n===A;return s.a.createElement(F.a,{placement:"left",title:s.a.createElement("div",{style:{padding:"8px"}},s.a.createElement("div",null,"节点ID：".concat(n)),s.a.createElement("div",null,"节点类型：".concat(P[t])))},s.a.createElement("div",{id:n,className:"real-node in-painter ".concat(a?"linked":""," ").concat(Q?"focus":""),style:I,ref:C,onClick:function(e){e.stopPropagation(),g(n),y()},onMouseDown:function(e){e.preventDefault();var t=e.clientX,n=e.clientY;E("mouseDown"),w([t,n].concat(K(r)))},onMouseUp:function(e){if("mouseDownStartPoint"===u&&"mouseenter"===v){if(a)return void Object(V.a)({description:"节点不可以有多个输入"});if(k.includes(t))return void Object(V.a)({description:"输入节点不能被链接"});e.stopPropagation();var r=e.currentTarget.getBoundingClientRect(),o=r.left,i=r.top,A=r.width;f({endPoint:[o+A/2,i],endNodeId:n})}else j()},onMouseLeave:j,onMouseEnter:function(){"mouseDownStartPoint"===u&&E((function(e){return"mouseenter"}))},onMouseMove:function(e){if(["mouseDown","moving"].includes(v)){"mouseDown"===v&&E("moving");var t=e.clientX,r=e.clientY,o=e.currentTarget.getBoundingClientRect(),A=o.width,u=o.height,l=o.top,s=o.left,d=G(O,4),f=d[0],g=d[1],y=t-f+d[2],b=r-g+d[3];(i||a)&&p(n,{width:A,height:u,top:l,left:s}),m([n],[{location:[c(y,A,"left"),c(b,u,"top")]}])}},onContextMenu:function(e){e.preventDefault()}},s.a.createElement("img",{src:T[t],alt:"icon"}),s.a.createElement("span",{className:"node-name"},o.nodeName),!M.includes(t)&&s.a.createElement("div",{className:"link-blocks-wrapper bottom",onMouseDown:function(e){e.stopPropagation();var t=e.target.getBoundingClientRect(),r=t.left,a=t.top,o=t.width,i=t.height;d({startPoint:[r+o/2,a+i/2],startNodeId:n})}},s.a.createElement("div",{className:"link-block"})),!k.includes(t)&&s.a.createElement("div",{className:"link-blocks-wrapper top"},s.a.createElement("div",{className:"link-block"}))))}function H(e){var t=e.nodeType,n=e.id,r=e.location,a=e.pid,o=e.input,i={left:"".concat(r[0],"px"),top:"".concat(r[1],"px")};return s.a.createElement(F.a,{placement:"left",title:s.a.createElement("div",{style:{padding:"8px"}},s.a.createElement("div",null,"节点ID：".concat(n)),s.a.createElement("div",null,"节点类型：".concat(P[t])))},s.a.createElement("div",{id:n,className:"real-node in-painter ".concat(a?"linked":""),style:i},s.a.createElement("img",{src:T[t],alt:"icon"}),s.a.createElement("span",{className:"node-name"},o.nodeName),!M.includes(t)&&s.a.createElement("div",{className:"link-blocks-wrapper bottom"},s.a.createElement("div",{className:"link-block"})),!k.includes(t)&&s.a.createElement("div",{className:"link-blocks-wrapper top"},s.a.createElement("div",{className:"link-block"}))))}function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var _=d.a.Panel,$=s.a.memo((function(){return s.a.createElement("section",{className:"nodes-select-wrapper"},s.a.createElement(d.a,{defaultActiveKey:["1","2","3","4"]},R.map((function(e,t){var n=e.title,r=e.nodelists;return s.a.createElement(_,{header:n,key:t+1},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return s.a.createElement("div",{className:"node-panel"},e.map((function(e,t){return s.a.createElement(z,X({key:e.nodeType+t},e))})))}(r))}))))}));var ee=n("CvKH"),te=n.n(ee);function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,A=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){A=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(A)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ae(e){var t=e.pathsConfigs,n=void 0===t?[]:t,r=Object(l.useRef)(null);return s.a.createElement("section",{className:"svg-wrapper"},s.a.createElement("svg",{ref:r},n.map((function(e,t){if(!e)return null;var n=e.startPoint,r=e.endPoint,a=e.startNodeId,o=e.endNodeId,i=function(e,t){var n,r,a=ne(e,2),o=a[0],i=a[1],A=ne(t,2),c=A[0],u=A[1],l=(o+c)/2,s=(i+u)/2;u>=i?(r=i+.9*(s-i),n=o):(r=i+1.6*(i-u),n=o);return"M ".concat(o," ").concat(i," Q ").concat(n," ").concat(r," ").concat(l," ").concat(s," T ").concat(c," ").concat(u)}(n,r),A="".concat(a,"-").concat(o);return s.a.createElement("g",{key:A,id:A},s.a.createElement("path",{className:"path-link",d:i,stroke:"rgba(255,0,0,.0)",strokeWidth:"20",fill:"none"}),s.a.createElement("path",{className:"path-link",d:i,stroke:"rgba(153,153,153,.5)",strokeWidth:"1",fill:"none"}))}))))}function oe(){return(oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ie(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||se(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,A=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){A=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(A)throw a}}return o}(e,t)||se(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){if(e){if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fe(e){var t=e.setNodes,n=e.nodes,r=e.nodeIdCount,a=e.setNodeIdCount,o=e.focusNodeId,i=e.setFocusNodeId,A=e.changeNodeDataByIds,c=e.hasInputNode,u=e.pathsConfigs,d=e.setPathsConfigs,f=le(Object(l.useState)("default"),2),p=f[0],m=f[1],g=le(Object(l.useState)({}),2),y=g[0],b=g[1],v=le(Object(l.useState)({showMenu:!1,menuLeft:0,menuTop:0}),2),E=v[0],h=v[1],O=Object(l.useRef)(null),w=E.showMenu,C=E.menuLeft,j=E.menuTop,Q=E.selectNodeIdToDelete,B=E.selectLinkLineToDelete,D=function(){return O&&O.current.getBoundingClientRect()||{}},S=function(e,t,n){var r=D(),a=r.width,o=r.height,i="left"===n?a:o;return e+t>i-2&&(e=i-t-2),e>2?e:2},N=function(e){i(e)},P=function(){h({showMenu:!1,menuLeft:0,menuTop:0,selectNodeIdToDelete:null,selectLinkLineToDelete:null})},T=function(e){"mouseDownStartPoint"===p&&(m("default"),b({}))},k=function(e){var t=D(),n=t.left,r=t.top,a=e.startPoint,o=ce({},e);o.startPoint=[a[0]-n,a[1]-r],b(ce(ce({},y),o)),m("mouseDownStartPoint")},M=function(e){var t=e||{},n=t.endPoint,r=t.endNodeId,a=y.startNodeId;if(r&&r!==a){var o=D(),i=o.left,c=o.top,l=ce({},e);l.endPoint=[n[0]-i,n[1]-c],d([].concat(ie(u),[ce(ce({},y),l)])),A([r,a],[{pid:a},{hasChildNode:!0}])}else Object(V.a)({message:"节点连接错误"});m("default"),b({})},R=function(e,t){var n=t.left,r=t.top,a=t.width,o=t.height,i=D(),A=ie(u).map((function(t){var A=t.startNodeId,c=t.endNodeId;return e===A?ce(ce({},t),{},{startPoint:[n+a/2-i.left,r+o-i.top]}):e===c?ce(ce({},t),{},{endPoint:[n+a/2-i.left,r-i.top]}):t}));d(A)},x=ie(u);return Object.keys(y).length>2&&(x=[].concat(ie(x),[y])),s.a.createElement("section",{className:"painter-wrapper",ref:O,onDrop:function(e){e.stopPropagation(),e.preventDefault();var o=e.currentTarget,A=e.clientX,u=e.clientY,l=o.offsetLeft,s=o.offsetTop,d=JSON.parse(e.dataTransfer.getData("text/plain")||""),f=d.x,p=d.y,m=d.l,g=d.t,y=d.nodeType,b=d.nodeName,v=d.w,E=d.h,h=r+1;if(y===I&&c())Object(V.a)({message:"已存在输入节点"});else{var O={nodeType:y,location:[S(m+A-f-l,v,"left"),S(g+u-p-s,E,"top")],id:h,nodeName:b,pid:null,hasChildNode:!1,input:ce(ce({},te()(U[y])),{},{nodeId:h})};t([].concat(ie(n),[O])),a(h),i(h)}},onDragOver:function(e){e.preventDefault()},onMouseMove:function(e){if(e.preventDefault(),"mouseDownStartPoint"===p){var t=e.clientX,n=e.clientY,r=D(),a=r.left,o=r.top;b(ce(ce({},y),{},{endPoint:[t-a,n-o],endNodeId:null}))}},onMouseLeave:T,onMouseUp:T,onContextMenu:function(e){e.preventDefault();var t=e.clientX,n=e.clientY,r=e.target;if(r.classList.contains("real-node")||r.parentNode.classList.contains("real-node")){var a=D(),o=a.left,i=a.top;h({showMenu:!0,menuLeft:t-o,menuTop:n-i,selectNodeIdToDelete:+r.id||+r.parentNode.id})}else if(r.classList.contains("path-link")){var A=r.parentNode.id,c=D(),u=c.left,l=c.top;h({showMenu:!0,menuLeft:t-u,menuTop:n-l,selectLinkLineToDelete:A})}else P()},onClick:function(e){N(null),w&&P(),o&&N(null)}},n.map((function(e){var t=e.id;return s.a.createElement(z,oe({key:t,focusNodeId:o,inWhere:"painter",workStatu:p,recordStartPoint:k,addNewPath:M,changePathsByNodeId:R,limitNodePostion:S,changeNodeDataByIds:A,setFocusNode:N,clearMenu:P},e))})),s.a.createElement(ae,{pathsConfigs:x}),w&&s.a.createElement("section",{style:{left:C,top:j},className:"painter-menu-wrapper"},s.a.createElement("span",{className:"menu-item",onClick:function(e){if(e.stopPropagation(),Q){var r=n.filter((function(e){return e.id!==Q})),a=u.filter((function(e){return![e.startNodeId,e.endNodeId].includes(Q)}));r=r.map((function(e){return e.pid===Q?ce(ce({},e),{},{pid:null}):e})),t(r),d(a)}if(B){var o=le(B.split("-").map((function(e){return+e})),2),i=o[0],A=o[1],c=ie(n).map((function(e){var t=e.id;return e.pid===i&&A===t?ce(ce({},e),{},{pid:null}):e})),l=ie(u).filter((function(e){var t=e.startNodeId,n=e.endNodeId;return!(t===i&&n===A)}));t(c),d(l)}h({showMenu:!1,selectNodeIdToDelete:null})}},"删除")))}function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function me(e){var t=e.nodes,n=e.pathsConfigs,r=Object(l.useRef)(null),a=function(e,t,n){var a=r?r.current.getBoundingClientRect():{},o=a.width,i=a.height,A="left"===n?o:i;return e+t>A-2&&(e=A-t-2),e>2?e:2};return s.a.createElement("section",{className:"painter-wrapper"},t.map((function(e){var t=e.id;return s.a.createElement(z,pe({key:t,inWhere:"staticPainter",limitNodePostion:a},e))})),s.a.createElement(ae,{pathsConfigs:n}))}n("6rnn");var ge=n("d6B9"),ye=(n("FwVR"),n("72Pr"),n("O4+N")),be=(n("kvrU"),n("BPQb")),ve=(n("HzvR"),n("2n5t")),Ee=(n("SoGA"),n("0AG1"),n("Jya7"),n("/mds"),n("aLG4")),he=(n("rJH4"),n("nKmx"));function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ne(e);if(t){var a=Ne(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Se(this,n)}}function Se(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=ve.a.Option,Te=[{title:"属性名称",dataIndex:"srcName",key:"srcName"},{title:"数据类型",dataIndex:"srcType",key:"srcType",width:"100px"}],ke=function(e,t){return s.a.createElement(ge.a.Item,{label:"节点名称"},e("nodeName",{rules:[{required:!0,message:"请输入节点名称！"}],initialValue:t})(s.a.createElement(he.a,{placeholder:"请输入节点名称！"})))},Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(o,e);var t,n,r,a=De(o);function o(){var e;Ie(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).handletChange=function(t,n){e.triggerChange(je({},t,n))},e.triggerChange=function(t){var n=e.props,r=n.onChange,a=n.value;r&&r(Ce(Ce({},a),t))},e}return t=o,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.inputString,a=t.selectString,o=t.optionsConfig,i=void 0===o?[]:o;return s.a.createElement("span",null,s.a.createElement(Ee.a,{value:n[r],onChange:function(t){return e.handletChange(r,t)},style:{width:"65%",marginRight:"3%"}}),s.a.createElement(ve.a,{value:n[a],style:{width:"32%"},onChange:function(t){return e.handletChange(a,t)}},i.map((function(e){var t=e.label,n=e.value;return s.a.createElement(Pe,{key:n,value:n},t)}))))}}])&&Qe(t.prototype,n),r&&Qe(t,r),o}(s.a.Component);function Re(e){return function(e){if(Array.isArray(e))return Fe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ue(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,A=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){A=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(A)throw a}}return o}(e,t)||Ue(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){if(e){if("string"==typeof e)return Fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fe(e,t):void 0}}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ve=ve.a.Option,Le=(n("Y5Ue"),n("xc0u"));function Ke(e){return function(e){if(Array.isArray(e))return Ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Je=ve.a.Option,Ye=["=","!=",">=","<=",">","<"],Ze=(n("auFq"),n("g2HK"));function ze(e){return function(e){if(Array.isArray(e))return We(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return We(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _e=[{label:"最大值",value:"max"},{label:"最小值",value:"min"},{label:"平均值",value:"sum"},{label:"求和",value:"avg"}];function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ct(e);if(t){var a=ct(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return At(this,n)}}function At(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ut=ve.a.Option,lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(o,e);var t,n,r,a=it(o);function o(){var e;rt(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).handleNumberChange=function(t){var n=parseInt(t.target.value||0,10);isNaN(n)||e.triggerChange({number:n})},e.handleCurrencyChange=function(t){e.triggerChange({currency:t})},e.triggerChange=function(t){var n=e.props,r=n.onChange,a=n.value;r&&r(tt(tt({},a),t))},e}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.checked,n=e.value;return s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,s.a.createElement(Ze.a,{checked:t,style:{margin:"0 2%"}}),s.a.createElement("span",null,"连续"),s.a.createElement(Ee.a,{value:n.number,style:{width:"20%",margin:"0 2%"}}),s.a.createElement("span",null,"个点小于阈值"),s.a.createElement(Ee.a,{value:n.number,style:{width:"20%",margin:"0 2%"}})),s.a.createElement("p",null,s.a.createElement(Ze.a,{checked:t,style:{margin:"0 2%"}}),s.a.createElement("span",null,"连续"),s.a.createElement(Ee.a,{value:n.number,style:{width:"20%",margin:"0 2%"}}),s.a.createElement("span",null,"个点超出阈值"),s.a.createElement(Ee.a,{value:n.number,style:{width:"20%",margin:"0 2%"}})))}}])&&at(t.prototype,n),r&&at(t,r),o}(s.a.Component);function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Et(e);if(t){var a=Et(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return vt(this,n)}}function vt(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e){return function(e){if(Array.isArray(e))return Ot(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ot(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wt=ve.a.Option,Ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(o,e);var t,n,r,a=bt(o);function o(){var e;mt(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).handletChange=function(t,n){if("streamFieldCode"===t){var r=e.props,a=r.streamOptions;(0,r.changeNodeDataByIds)([r.id],[{input:{streamTableCode:a.map((function(e){return e.srcCode===n}))[0].srcTableCode||""}}])}e.triggerChange(pt({},t,n))},e.triggerChange=function(t){var n=e.props,r=n.onChange,a=n.value;r&&r(ft(ft({},a),t))},e}return t=o,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.streamOptions,a=t.dimOptions;return s.a.createElement("span",null,s.a.createElement("span",null,"流"),s.a.createElement(ve.a,{value:n.streamFieldCode,onChange:function(t){return e.handletChange("streamFieldCode",t)},style:{width:"30%",margin:"0 2%"}},r.map((function(e){var t=e.srcName,n=e.srcCode;return s.a.createElement(wt,{key:n,value:n},t)}))),s.a.createElement("span",null," = 维表"),s.a.createElement(ve.a,{value:n.dimFieldCode,onChange:function(t){return e.handletChange("dimFieldCode",t)},style:{width:"30%",margin:"0 2%"}},a.map((function(e){var t=e.srcName,n=e.srcCode;return s.a.createElement(wt,{key:n,value:n},t)}))))}}])&&gt(t.prototype,n),r&&gt(t,r),o}(s.a.Component);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){Qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e){return function(e){if(Array.isArray(e))return Dt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var St=ve.a.Option;function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pt(e){var t=Object.assign({},e);switch(t.nodeType){case I:return s.a.createElement(kt,t);case Q:return s.a.createElement(Mt,t);case B:return s.a.createElement(Rt,t);case D:return s.a.createElement(xt,t);case S:return s.a.createElement(Ut,t);case N:return s.a.createElement(Ft,t);default:return s.a.createElement("span",null,"未识别节点")}}var Tt=function(e,t){return ge.a.create({name:e,onFieldsChange:function(e,t,n){var r=e.changeNodeDataByIds,a=e.id,o=(e.input,Object.values(t)[0]),i=o.name,A=o.value;o.errors,o.dirty;r([a],[{input:Nt({},i,A)}])}})(t)},kt=Tt("form_for_dataInput",(function(e){var t=e.form,n=e.id,r=e.input,a=void 0===r?{}:r,o=e.productList,i=e.getDeviceList,A=e.getPropOrEventList,c=e.getDownEventList,u=e.changeNodeDataByIds,d=t.getFieldDecorator,f=t.setFieldsValue,p=a.nodeName,m=a.productId,g=a.deviceIds,y=void 0===g?[]:g,b=a.propEvent,v=a.propsCodes,E=void 0===v?[]:v,h=a.props,O=void 0===h?[]:h,w=(a.eventTimeField,a.deviceList),C=a.propsOrEventList,j=a.eventList,I=a.eventIdentifier;Object(l.useMemo)((function(){return C.filter((function(e){return E.includes(e.srcCode)}))}),[C,E]);return s.a.createElement(ge.a,null,ke(d,p),s.a.createElement(ge.a.Item,{label:"选择产品"},d("productId",{rules:[{required:!0,message:"请选择产品！"}],initialValue:m})(s.a.createElement(ve.a,{onChange:function(e){Promise.all([i(e),A(e,b)]).then((function(e){var t=xe(e,2),r=t[0],a=t[1];u([n],[{input:{deviceList:r,deviceIds:[],propsOrEventList:a,propsCodes:[],props:Re(x)}}]),f({deviceIds:[],propsCodes:[]})}))}},o.map((function(e){var t=e.productId,n=e.productName;return s.a.createElement(Ve,{key:t,value:t},n)}))))),s.a.createElement(ge.a.Item,{label:"选择设备"},d("deviceIds",{rules:[{required:!0,message:"请选择设备！"}],initialValue:y})(s.a.createElement(ve.a,{mode:"multiple"},w.map((function(e){var t=e.deviceId;return s.a.createElement(Ve,{key:t,value:t},t)}))))),s.a.createElement(ge.a.Item,{label:"输入参数"},d("propEvent",{rules:[{required:!0,message:"请选择输入参数！"}],initialValue:b})(s.a.createElement(be.a.Group,{onChange:function(e){var t;0==(t=e.target.value)?A(m,t).then((function(e){u([n],[{input:{propsOrEventList:e,propsCodes:[],props:Re(x)}}]),f({propsCodes:[]})})):c(m).then((function(e){u([n],[{input:{eventList:e,propsCodes:[],eventIdentifier:"",props:Re(x)}}]),f({propsCodes:[],eventIdentifier:""})}))}},s.a.createElement(be.a,{value:"0"},"属性"),s.a.createElement(be.a,{value:"1"},"事件")))),1==b&&s.a.createElement(ge.a.Item,null,d("eventIdentifier",{rules:[{required:!0,message:"请选择事件！"}],initialValue:I})(s.a.createElement(ve.a,{onChange:function(e){A(m,1,e).then((function(e){u([n],[{input:{propsOrEventList:e,propsCodes:[],props:Re(x)}}]),f({propsCodes:[]})}))},placeholder:"请选择事件！"},j.map((function(e){var t=e.identifier,n=e.name;return s.a.createElement(Ve,{key:t,value:t},n)}))))),s.a.createElement(ge.a.Item,null,d("propsCodes",{rules:[{required:!0,message:"请选择".concat("0"===b?"属性":"事件","字段！")}],initialValue:E})(s.a.createElement(ve.a,{mode:"multiple",onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=C.filter((function(t){return e.includes(t.srcCode)}));u([n],[{input:{props:[].concat(Re(t),Re(x))}}])}},C.map((function(e){var t=e.srcName,n=e.srcCode;e.srcType;return s.a.createElement(Ve,{key:n,value:n},"".concat(t,"( ").concat(n," )"))}))))),s.a.createElement(ge.a.Item,null,s.a.createElement(ye.a,{rowKey:"srcCode",columns:Te,dataSource:O,pagination:!1})))})),Mt=Tt("form_for_dataFilter",(function(e){var t=e.form,n=e.id,r=e.input,a=e.pProps,o=void 0===a?[]:a,i=e.changeNodeDataByIds,A=t.getFieldDecorator,c=r.nodeName,u=r.props,l=void 0===u?[]:u,d=r.condition,f=function(e,t,r){if("value"!==e||/^\d*$/.test(t)){var a=Ke(l);if(a[r][e]=t,"code"===e){var A=o.filter((function(e){return e.srcCode===t})),c="",u="";A.length>0&&(c=A[0].srcName||"",u=A[0].srcTableCode||""),a[r].name=c,a[r].tableCode=u}i([n],[{input:{props:a}}])}},p=[{title:"属性名称",dataIndex:"name",key:"name",width:"90px",render:function(e,t,n){return s.a.createElement(ve.a,{value:t.code,onChange:function(e){return f("code",e,n)}},o.map((function(e){var t=e.srcName,n=e.srcCode;return s.a.createElement(Je,{key:n,value:n},t)})))}},{title:"判断",dataIndex:"judge",key:"judge",width:"90px",render:function(e,t,n){return s.a.createElement(ve.a,{value:t.judge,onChange:function(e){return f("judge",e,n)}},Ye.map((function(e){return s.a.createElement(Je,{key:e,value:e},e)})))}},{title:"数值",dataIndex:"value",key:"value",width:"50px",render:function(e,t,n){return s.a.createElement(he.a,{value:t.value,onChange:function(e){return f("value",e.target.value,n)}})}},{title:"操作",dataIndex:"action",key:"action",width:"40px",render:function(e,t,r){return s.a.createElement("a",{onClick:function(){return e=r,t=Ke(l).filter((function(t,n){return n!==e})),void i([n],[{input:{props:t}}]);var e,t}},"删除")}}];return s.a.createElement(ge.a,null,ke(A,c),s.a.createElement(ge.a.Item,{label:"关系与条件"},A("condition",{rules:[{required:!0,message:"请选择关系！"}],initialValue:d})(s.a.createElement(be.a.Group,null,s.a.createElement(be.a,{value:"and"},"同时满足以下条件(and)"),s.a.createElement(be.a,{value:"or"},"满足以下某一个条件(or)")))),s.a.createElement(ge.a.Item,null,s.a.createElement("div",{className:"add-new-condition"},s.a.createElement(Le.a,{type:"default",onClick:function(){i([n],[{input:{props:[].concat(Ke(l),[{}])}}])},size:"small"},"新增条件")),s.a.createElement(ye.a,{rowKey:"code",columns:p,dataSource:l,pagination:!1})))})),Rt=Tt("form_for_datacacl",(function(e){var t=e.form,n=e.input,r=e.id,a=e.pProps,o=void 0===a?[]:a,i=e.changeNodeDataByIds,A=t.getFieldDecorator,c=n.nodeName,u=n.props,d=n.granularity,f=n.dimsCode,p=n.measureCode,m=n.funcs,g=n.windowType,y=n.windowDurings,b=n.slideDurings,v=Object(l.useMemo)((function(){var e=[],t=[];return o.forEach((function(n){e.push(He({},n)),t.push(He({},n))})),[e.map((function(e){var t=e.srcCode;return{label:e.srcName,value:t}})),t.map((function(e){var t=e.srcCode;return{label:e.srcName,value:t}}))]}),[o]),E=function(e){return function(t,n,r){if(n[e]>0)return r();r("请输入大于0的数字")}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,r=o.filter((function(t){return e.includes(t.srcCode)}));return t=o.filter((function(e){return t.includes(e.srcCode)})),n=_e.filter((function(e){return n.includes(e.value)})),t.forEach((function(e){var t=e.srcCode,a=e.srcName,o=e.srcType,i=e.srcTableCode,A=void 0===i?"":i;n.forEach((function(e){var n=e.label,i=e.value;r.push({srcName:"".concat(a,"_").concat(n),srcCode:"".concat(i,"_").concat(t),srcType:o,srcTableCode:A})}))})),r},O=function(e,t){var n=[],a=null,A=null;"dimsCode"===t&&(n=h(e),a=o.filter((function(t){return e.includes(t.srcCode)})).map((function(e){var t=e.srcCode,n=e.srcName,r=e.srcTableCode;return{srcCode:t,srcName:n,srcTableCode:void 0===r?"":r}}))),"measureCode"===t&&(n=h(void 0,e),A=o.filter((function(t){return e.includes(t.srcCode)})).map((function(e){var t=e.srcCode,n=e.srcName,r=e.srcTableCode;return{srcCode:t,srcName:n,srcTableCode:void 0===r?"":r}}))),"funcs"===t&&(n=h(void 0,void 0,e));var c={props:ze(n)};a&&(c.dims=a),A&&(c.measure=A),i([r],[{input:c}])};return s.a.createElement(ge.a,null,ke(A,c),s.a.createElement(ge.a.Item,{label:"统计粒度"},A("granularity",{rules:[{required:!0,message:"请选择统计粒度"}],initialValue:d})(s.a.createElement(be.a.Group,null,s.a.createElement(be.a,{value:0},"单个设备"),s.a.createElement(be.a,{value:1},"所有设备")))),s.a.createElement(ge.a.Item,{label:"统计维度(非数值类型)"},A("dimsCode",{rules:[{required:!0,message:"请选择统计粒度"}],initialValue:f})(s.a.createElement(Ze.a.Group,{onChange:function(e){return O(e,"dimsCode")},options:v[1]}))),s.a.createElement(ge.a.Item,{label:"计算度量(数值类型)"},A("measureCode",{rules:[{required:!0,message:"请选择计算度量"}],initialValue:p})(s.a.createElement(Ze.a.Group,{onChange:function(e){return O(e,"measureCode")},options:v[0]}))),s.a.createElement(ge.a.Item,{label:"统计函数"},A("funcs",{rules:[{required:!0,message:"请选择统计函数"}],initialValue:m})(s.a.createElement(Ze.a.Group,{onChange:function(e){return O(e,"funcs")},options:_e}))),s.a.createElement(ge.a.Item,{label:"时间窗口类型"},A("windowType",{rules:[{required:!0,message:"请选择统计粒度"}],initialValue:g})(s.a.createElement(be.a.Group,null,s.a.createElement(be.a,{value:0},"滑动窗口"),s.a.createElement(be.a,{value:1},"滚动窗口")))),s.a.createElement(ge.a.Item,{label:"窗口时长"},A("windowDurings",{initialValue:y,rules:[{validator:E("windowDuring")}]})(s.a.createElement(Me,{inputString:"windowDuring",selectString:"windowUnit",optionsConfig:[{label:"秒",value:"s"},{label:"分",value:"m"},{label:"时",value:"h"}]}))),0===g&&s.a.createElement(ge.a.Item,{label:"滑动时长"},A("slideDurings",{initialValue:b,rules:[{validator:E("slideDuring")}]})(s.a.createElement(Me,{inputString:"slideDuring",selectString:"slideUnit",optionsConfig:[{label:"秒",value:"s"},{label:"分",value:"m"},{label:"时",value:"h"}]}))),s.a.createElement(ge.a.Item,{label:"输出数据"},s.a.createElement(ye.a,{columns:Te,rowKey:"srcCode",dataSource:u,pagination:!1})))})),xt=Tt("form_for_errorcheck",(function(e){var t=e.form,n=(e.id,e.productList,e.changeNodeDataByIds,e.input),r=t.getFieldDecorator,a=n.nodeName,o=(n.productId,n.deviceIds,n.propEvent,n.propsCodes,n.props),i=void 0===o?[]:o;n.eventTimeField;return s.a.createElement(ge.a,null,ke(r,a),s.a.createElement(ge.a.Item,{label:"节点名称"},r("nodeName",{rules:[{required:!0,message:"请输入节点名称！"}]})(s.a.createElement(he.a,{placeholder:"请输入节点名称！"}))),s.a.createElement(ge.a.Item,{label:"检测属性"},r("eventTimeField",{rules:[{required:!0,message:"请选择检测属性！"}],initialValue:""})(s.a.createElement(ve.a,null,s.a.createElement(ut,{value:""},"请选择")))),s.a.createElement(ge.a.Item,{label:"检测规则"},r("condition",{initialValue:{number:60,currency:"s"},rules:[{validator:function(e,t,n){if(t.number>0)return n();n("Price must greater than zero!")}}]})(s.a.createElement(lt,null))),s.a.createElement(ge.a.Item,null,s.a.createElement(ye.a,{columns:Te,dataSource:i,pagination:!1})))})),Ut=Tt("form_for_datarelated",(function(e){var t=e.form,n=e.id,r=e.input,a=void 0===r?{}:r,o=e.pProps,i=void 0===o?[]:o,A=e.changeNodeDataByIds,c=e.dataSourceList,u=e.getTableByDatasource,l=e.getFieldsByDatasourceTable,d=t.getFieldDecorator,f=a.nodeName,p=a.datasourceId,m=a.tableCode,g=a.relate,y=a.joinType,b=a.selectedRowKeys,v=a.tableList,E=a.filedList,h=[].concat(ht(i),ht(E)),O={onChange:function(e,t){A([n],[{input:{selectedRowKeys:e,props:h.filter((function(t){return e.includes(t.srcCode)}))}}])},selectedRowKeys:b};return s.a.createElement(ge.a,null,ke(d,f),s.a.createElement(ge.a.Item,{label:"选择数据源"},d("datasourceId",{rules:[{required:!0,message:"请选择数据源！"}],initialValue:p})(s.a.createElement(ve.a,{onChange:function(e){u(e).then((function(e){A([n],[{input:{tableList:e,tableCode:"",filedList:[],relate:{dimFieldCode:""}}}])}))}},c.map((function(e){var t=e.name,n=e.id;return s.a.createElement(wt,{key:n,value:n},t)}))))),s.a.createElement(ge.a.Item,{label:"指定维表"},d("tableCode",{rules:[{required:!0,message:"请选择维表！"}],initialValue:m})(s.a.createElement(ve.a,{onChange:function(e){l(e,p).then((function(e){A([n],[{input:{filedList:e,relate:{dimFieldCode:""}}}])}))}},v.map((function(e){var t=e.code;return s.a.createElement(wt,{key:t,value:t},t)}))))),s.a.createElement(ge.a.Item,{label:"设置连接"},d("joinType",{rules:[{required:!0,message:"请设置连接方式！"}],initialValue:y})(s.a.createElement(be.a.Group,null,s.a.createElement(be.a,{value:0},"内连接"),s.a.createElement(be.a,{value:1},"外连接")))),s.a.createElement(ge.a.Item,{label:"连接条件(类型必须匹配, 且维表字段为主键)"},d("relate",{initialValue:g,rules:[{validator:function(e,t,n){if(t.streamFieldCode&&t.dimFieldCode)return n();n("请选择关联字段")}}]})(s.a.createElement(Ct,{streamOptions:i,changeNodeDataByIds:A,id:n,dimOptions:E}))),s.a.createElement(ge.a.Item,{label:"输出字段"},s.a.createElement(ye.a,{rowKey:"srcCode",rowSelection:O,columns:Te,dataSource:h,pagination:!1})))})),Ft=Tt("form_for_dataoutput",(function(e){var t=e.form,n=e.id,r=e.input,a=void 0===r?{}:r,o=e.pProps,i=void 0===o?[]:o,A=e.changeNodeDataByIds,c=e.dataSourceList,u=e.getTableByDatasource,d=e.getFieldsByDatasourceTable;console.log("--------pProps---",i);var f=t.getFieldDecorator,p=(a.nodeName,a.datasourceId),m=a.tableCode,g=a.selectedRowKeys,y=a.dataSource,b=a.tableList,v=a.filedList,E=[{title:"输出节点",dataIndex:"srcName",key:"srcName",width:"100px"},{title:"数据库字段",dataIndex:"destName",key:"destName",width:"100px",render:function(e,t,r){t.srcType;var a=t.destCode,o=t.srcCode,i=Bt(v),c=!g.includes(o);return s.a.createElement(ve.a,{value:a||"",onChange:function(e){return function(e,t,r){var a=r.filter((function(t){return t.srcCode===e}))[0],o=a.srcCode,i=a.srcName,c=a.srcType,u=a.srcTableCode,l=Bt(y);l[t]=It(It({},l[t]),{destName:i,destCode:o,destType:c,destTableCode:u}),A([n],[{input:{dataSource:l}}])}(e,r,i)},style:{width:"90px"},disabled:c},i.map((function(e){var t=e.srcCode,n=e.srcName;return s.a.createElement(St,{key:t,value:t},n)})))}},{title:"字段类型",dataIndex:"srcType",key:"srcType",width:"100px"}];Object(l.useEffect)((function(){console.log("---useEffect---",i);var e=y.map((function(e){return e.srcCode})),t=i.map((function(e){return e.srcCode})),r=Bt(y);i.forEach((function(t){e.includes(t.srcCode)||r.push(It(It({},t),{destName:"",destCode:"",destType:"",destTableCode:""}))})),r=r.filter((function(e){return t.includes(e.srcCode)})),console.log("---useEffect-_data--",r),A([n],[{input:{dataSource:r}}])}),[]);var h={onChange:function(e,t){A([n],[{input:{selectedRowKeys:e}}])},selectedRowKeys:g};return s.a.createElement(ge.a,null,s.a.createElement(ge.a.Item,{label:"数据库"},f("datasourceId",{rules:[{required:!0,message:"请选择数据库！"}],initialValue:p})(s.a.createElement(ve.a,{onChange:function(e){u(e).then((function(e){A([n],[{input:{tableList:e,filedList:[]}}])}))}},c.map((function(e){var t=e.name,n=e.id;return s.a.createElement(St,{key:n,value:n},t)}))))),s.a.createElement(ge.a.Item,{label:"数据表"},f("tableCode",{rules:[{required:!0,message:"请选择数据表！"}],initialValue:m})(s.a.createElement(ve.a,{onChange:function(e){d(e,p).then((function(e){A([n],[{input:{filedList:e}}])}))}},b.map((function(e){var t=e.code;return s.a.createElement(St,{key:t,value:t},t)}))))),s.a.createElement(ge.a.Item,{label:"输出映射(数据类型要和数据库匹配)"},s.a.createElement(ye.a,{rowKey:"srcCode",rowSelection:h,columns:E,dataSource:y,pagination:!1})))})),Vt=["service","selectedNode"];function Lt(){return(Lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Kt(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Gt=s.a.memo((function(e){var t=e.service,n=void 0===t?{}:t,r=e.selectedNode,a=Kt(e,Vt),o=r.id,i=r.nodeType,A=n.desc;return s.a.createElement("section",{className:"config-edit-wrapper"},s.a.createElement("div",{className:"title"},i?P[i]:"服务详情"),o?s.a.createElement("div",{className:"form-wrapper"},s.a.createElement(Pt,Lt({},r,a))):s.a.createElement("ul",{className:"service-wrapper"},s.a.createElement("li",null,s.a.createElement("span",{className:"label"},"服务类型:")," ",s.a.createElement("span",{className:"content"},"数据分析服务")),s.a.createElement("li",null,s.a.createElement("span",{className:"label"},"服务描述:")," ",s.a.createElement("span",{className:"content"},A||"--"))))})),Jt=n("KZSM"),Yt=n("L60R");n("JTrB");function Zt(e){return function(e){if(Array.isArray(e))return _t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Xt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,A=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){A=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(A)throw a}}return o}(e,t)||Xt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(e,t){if(e){if("string"==typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_t(e,t):void 0}}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $t(e){var t=e.service,n=e.isStatic,r=Ht(Object(l.useState)([]),2),a=r[0],o=r[1],i=Ht(Object(l.useState)(0),2),c=i[0],d=i[1],f=Ht(Object(l.useState)(null),2),p=f[0],m=f[1],g=Ht(Object(l.useState)([]),2),y=g[0],b=g[1],v=Ht(Object(l.useState)([]),2),E=v[0],h=v[1],O=Ht(Object(l.useState)([]),2),w=O[0],C=O[1],j=function(e){return e&&a.filter((function(t){return t.id===e}))[0]||null},D=Object(l.useMemo)((function(){if(p){var e=a.filter((function(e){return e.id===p}))[0]||{};if(e.pid){var t=function(e){for(var t=j(e);t&&t.nodeType===Q;)t=t.pid?j(t.pid):null;return t}(e.pid);e.pProps=t&&t.input&&t.input.props||[]}return e}return{}}),[p,a]),P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=Wt({},e);if(t===B){var r=n,a=r.windowDurings,o=void 0===a?{}:a,i=r.slideDurings,A=void 0===i?{}:i,c=o.windowDuring,u=o.windowUnit,l=A.slideDuring,s=A.slideUnit;n=Wt(Wt({},n),{},{windowDuring:c,windowUnit:u,slideDuring:l,slideUnit:s})}if(t===S){var d=n,f=d.relate,p=void 0===f?{}:f,m=p.streamFieldCode,g=p.dimFieldCode;n=Wt(Wt({},n),{},{streamFieldCode:m,dimFieldCode:g})}if(t===N){var y=n,b=y.dataSource,v=void 0===b?[]:b,E=y.selectedRowKeys,h=void 0===E?[]:E,O=v.filter((function(e){return h.includes(e.srcCode)}));n=Wt(Wt({},n),{},{props:O})}return JSON.stringify(n)};Object(l.useEffect)((function(){var e=t.projectId,n=t.serviceId;e&&Object(Jt.h)({projectId:e,pageRows:9999}).then((function(e){e&&e.data&&e.data.list&&h(Zt(e.data.list))})),n&&Object(Jt.g)({serviceId:n}).then((function(e){if(e.data){var t=e.data,n=t.flowNodeList,r=t.lines,a=void 0===r?"":r,i=(n||[]).map((function(e){return e.pNodeId})),A=0,c=[];n&&(c=n.map((function(e){var t=e.input,n=e.location,r=e.nodeId,a=e.nodeName,o=e.nodeType,c=e.output,u=e.pNodeId;return r>A&&(A=r),{input:JSON.parse(t),nodeType:o,location:n.split(",").map((function(e){return+e})),id:r,nodeName:a,output:c,pid:u||null,hasChildNode:i.includes(r)}}))),a&&b(JSON.parse(a)),o(c),d(A+1)}})),Object(Jt.b)({type:2}).then((function(e){e&&e.data&&C(Zt(e.data))}))}),[t]);var T=Object(l.useCallback)((function(){var e={projectId:t.projectId,serviceId:t.serviceId,lines:JSON.stringify(y)};e.nodes=a.map((function(e){var t=e.nodeName,n=e.nodeType,r=e.pid,a=e.id,o=e.input;return{id:a,pid:r,nodeName:t,nodeType:n,location:e.location.join(","),input:P(o,n),output:""}})),console.log("触发保存 -- ",e),Object(Jt.i)(e).then((function(){Object(V.a)({type:"success",description:"保存成功！"})}))}),[a,y,t]);Object(l.useEffect)((function(){var e=Yt.b.asObservable().subscribe((function(e){T()})),t=Yt.a.asObservable().subscribe((function(e){}));return function(){e.unsubscribe(),t.unsubscribe()}}),[T]);var k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.length===t.length?o((function(n){return Zt(n).map((function(n){var r=e.indexOf(n.id);return r>-1?u()({},n,t[r],(function(e,t){if(A()(t))return t})):n}))})):console.log("修改节点数据时，传入的数据异常",e,t)};return s.a.createElement("div",{className:"playground-wrapper flex-row"},n?s.a.createElement(me,{nodes:a,pathsConfigs:y}):s.a.createElement(s.a.Fragment,null,s.a.createElement($,null),s.a.createElement(fe,{nodes:a,nodeIdCount:c,setNodeIdCount:d,focusNodeId:p,setFocusNodeId:m,changeNodeDataByIds:k,hasInputNode:function(){return a.map((function(e){return e.nodeType})).includes(I)},pathsConfigs:y,setPathsConfigs:b,setNodes:o}),s.a.createElement(Gt,{changeNodeDataByIds:k,selectedNode:D,productList:E,getDeviceList:function(e){return Object(Jt.a)({productId:e,pageRows:9999}).then((function(e){return e.data&&e.data.list||[]}))},getPropOrEventList:function(e,t,n){return Object(Jt.d)({productId:e,property:t,eventIdentifier:n}).then((function(e){return e&&e.data&&Zt(e.data).map((function(e){return Wt(Wt({},e),{},{srcTableCode:""})}))||[]}))},getDownEventList:function(e){return Object(Jt.f)({productId:e}).then((function(e){return e&&e.data||[]}))},dataSourceList:w,getTableByDatasource:function(e){return Object(Jt.e)({datasourceId:e}).then((function(e){return e&&e.data||[]}))},getFieldsByDatasourceTable:function(e,t){return Object(Jt.c)({datasourceId:t,tableCode:e}).then((function(t){return t&&t.data?Zt(t.data).map((function(t){return Wt(Wt({},t),{},{srcTableCode:e})})):[]}))},service:t})))}},Fw8H:function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAOKADAAQAAAABAAAAQAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/9sAhAAICAgICQgJCgoJDQ4MDg0TERAQERMcFBYUFhQcKxsfGxsfGysmLiUjJS4mRDUvLzVETkI+Qk5fVVVfd3F3nJzRAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wgARCABAADgDASIAAhEBAxEB/8QAGgABAAIDAQAAAAAAAAAAAAAAAAEGAwQFAv/aAAgBAQAAAADbA9ASZb9WeF6Nm8Vjiy3s/KJs+apCdxpiRB//xAAZAQEAAwEBAAAAAAAAAAAAAAAAAgMFBAb/2gAIAQIQAAAA9kEMzWpq6kUn/8QAGwEAAQQDAAAAAAAAAAAAAAAAAAECBAYDBQf/2gAIAQMQAAAA44AzJZ6pIlaxHDD/xAAlEAACAgEDAgcBAAAAAAAAAAABAgMEEQAFEiAhEBMjMUFRYUD/2gAIAQEAAT8A/hhiaaaOJSAXYKM/uq2z0o4BE8KuflmHcnW+7dFSmiMK4jdT2znuOmvBZflLDGzeVhiR8arb7t0oHKXy2+mGt53QXpVSMYhjJ4/bfvjjVChLem4J2Ud2b60btmpDNRR04hyOa6xrGseGwUq8ySzSIHYNxAIyBrfKsdVI7Ff0nZijcO2QR1VLtim5aFsZ9wRkHVy9ZuOGmfOPYAYA68dP/8QAIREBAAECBgMBAAAAAAAAAAAAAQIDEQAEEBIUQSAiMlH/2gAIAQIBAT8A8ZtorcMZbk8j23W7vpWqlKDNMUpGYN78dH4msokhJAmIxjECIBr/AP/EACMRAAIBAwMEAwAAAAAAAAAAAAECAwAEEBESMQUTFCFBQlH/2gAIAQMBAT8A1rXGuIl3Oo2lhr7A/K6k3TPAHaMe/wBBNvOLS2e6nWJSAT8mrpDYN2VJEv2cHlTmOR43DoxVhwRUkjyOXdizHknP/9k="},JTrB:function(e,t,n){},KZSM:function(e,t,n){"use strict";n.d(t,"h",(function(){return A})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"i",(function(){return m}));n("rsdX"),n("vxpS"),n("oCJ0"),n("L8Gl"),n("eVIo"),n("EO5n");var r=n("Nlzp");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){return Object(r.c)(r.a.getAllRelatedProduct,o({},e))},c=function(e){return Object(r.c)(r.a.getDownDevice,o({},e))},u=function(e){return Object(r.c)(r.a.getDownEventList,o({},e))},l=function(e){return Object(r.c)(r.a.getDownPropEvent,o({},e))},s=function(e){return Object(r.c)(r.a.getDownDatasource,o({},e))},d=function(e){return Object(r.c)(r.a.getDownTableByDatasource,o({},e))},f=function(e){return Object(r.c)(r.a.getDownFieldsByDatasourceTable,o({},e))},p=function(e){return Object(r.c)(r.a.getFlowData,o({},e),{noInstance:!0})},m=function(e){return Object(r.d)(r.a.saveFlowData,o({},e),{needJson:!0,noInstance:!0})}},L60R:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n("6nnT"),a=new r.Subject,o=new r.Subject,i=(new r.Subject,new r.Subject)},"Q1S+":function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAOKADAAQAAAABAAAAQAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/9sAhAAICAgICQgJCgoJDQ4MDg0TERAQERMcFBYUFhQcKxsfGxsfGysmLiUjJS4mRDUvLzVETkI+Qk5fVVVfd3F3nJzRAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wgARCABAADgDASIAAhEBAxEB/8QAGwABAAIDAQEAAAAAAAAAAAAAAAYHAgMFAQT/2gAIAQEAAAAA+MDay7HG8bU4smsYY2JbY9axVs7Mkh0xjPIzteJRaXyOrcgMgP/EABsBAAEEAwAAAAAAAAAAAAAAAAABAwQGAgUH/9oACAECEAAAAOmtOjNNsk7VJBsGAH//xAAYAQEBAQEBAAAAAAAAAAAAAAAAAQIDBP/aAAgBAxAAAADzi9ec2uKP/8QAKxAAAgEEAQMDAQkAAAAAAAAAAQIAAwQREgUGE0EQFDFRISMzQGGBkqHB/9oACAEBAAE/ANZrNZrNZrNZrNYtNnYKqksTgAfJh6b5oUu77F9f2z/H5hQqSCCCDggzWazExOibSi9xdXDqC9IKqfpt6da2lKlfUK6KA1ZW3A+qzExMTE6Re6pX7ugHY1xVz/U97ad0UzVG+u2vnE6sF09+Kj/g6YpTExMTj+B5DkE7lJAKecbscSo6cLbdopgr48sYb66N37rufe5zn/JRdOatuzpkkfaPKmcjwd/xwD1kBpk43WYmJ0/e2tbjLdEdQ9NArr5BE6svKFzeUkosG7SEMR8ZPp0jeW1vcXNKswVqqroT9V8TqW9tafGV6LOpqVQAi+fyH//EACIRAAEEAgEEAwAAAAAAAAAAAAEAAgMRBBIFEBMiMVGBof/aAAgBAgEBPwDZSZEMRAkka2/Vmlstla5drznSG9hQ+lxpIwoA51mla5LKmx4WuibZLqv4WBEHQCWRnnIPK1358XP7EbLjc4fqvpfS1//EABoRAAIDAQEAAAAAAAAAAAAAAAERAAIgMRD/2gAIAQMBAT8AiOK8lunyocMTD1//2Q=="},WpQE:function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAOKADAAQAAAABAAAAQAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/9sAhAAICAgICQgJCgoJDQ4MDg0TERAQERMcFBYUFhQcKxsfGxsfGysmLiUjJS4mRDUvLzVETkI+Qk5fVVVfd3F3nJzRAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wgARCABAADgDASIAAhEBAxEB/8QAGwABAAIDAQEAAAAAAAAAAAAAAAIFAwQHAQb/2gAIAQEAAAAAgBkbf2nx2iyF7RxZPehWdfzyErHqRzOonPrNlo8kxSZbiowvQP/EABkBAAIDAQAAAAAAAAAAAAAAAAIDBAUGB//aAAgBAhAAAADpEOSa6OxloxVxoRSwv//EABkBAAIDAQAAAAAAAAAAAAAAAAEDAgQFBv/aAAgBAxAAAADh7KIjWpVpdfk4Yasf/8QALRAAAgEDAgMGBgMAAAAAAAAAAQIAAwQRBRMSIlEhMTJBYXEGEBQWMIFScrL/2gAIAQEAAT8AxMTExMTExMTEshZ74S7Vtpuwup5k9YPgy1ZRVGonaxnPCO6X62SVzTs+Jqadm4x7XPX2mJiYmIELEAAkxautjTmshTq7BOfCc4/j7RkZSQwII8jMTExFQswVRkk4Amm6TSs6QyoNUjmabUv9Lo3lIhlAcDlfpKlJqbujjDKxBHqJiYmkKranaBu7cE25tzbmuqq6rdBeq/5ExMSm7UqiVEOGVgwPqJpl/b6hbrVpkcQHOnmpnAJqF5b2Fu1as39V82PQSvWe4r1az+J2LH9/LExKNatbuKlGoyN1U4n3HrHDw/U/vgWXFxcXL7leqzt1YzEx+D//xAAgEQACAgICAgMAAAAAAAAAAAABAgMRAAQSMQUQIUJR/9oACAECAQE/ALzY34NdgsvIX0asHEk5orURY6PeXhas2PIxuwAiVlU2C2am4mwD8Uw7GXkoLxuo7KkY7MjFWBBBzw6uZHk+vGsv08EEht4kY/pGKAoAUAD1/8QAIREAAgICAQQDAAAAAAAAAAAAAQIDEQAEEAUSITFBUWH/2gAIAQMBAT8AyHVlnUmOjXvzVYy9rEWDX1zDouq2ZCpYVQzZ1mgIvyp9HiNgsiMfgg4gV0DKQQRnVnQIkdjuu+UnmjFJIyj8OMxY2SSeP//Z"},qEOn:function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAOKADAAQAAAABAAAAQAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/9sAhAAICAgICQgJCgoJDQ4MDg0TERAQERMcFBYUFhQcKxsfGxsfGysmLiUjJS4mRDUvLzVETkI+Qk5fVVVfd3F3nJzRAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wgARCABAADgDASIAAhEBAxEB/8QAGwABAAEFAQAAAAAAAAAAAAAAAAUCAwQGBwH/2gAIAQEAAAAAoAuMqXisNcudQyLPMLFcj1c5bE1OlbPrnMvK2VuOoYaokI89A//EABoBAAEFAQAAAAAAAAAAAAAAAAIAAwQFBgf/2gAIAQIQAAAA6Qw6UfG22gDMXE8QNf/EABoBAAEFAQAAAAAAAAAAAAAAAAEAAgMFBgT/2gAIAQMQAAAAw8sYdq6ulGhquMPYv//EACwQAAEEAQMBBQkBAAAAAAAAAAEAAgMRBAUTMSEGEFFhgRIUFiIjMDJxkTP/2gAIAQEAAT8ApUqVKlSpUqWLg5OW4thjvxPAC+G8uv8AWO/VZWn5OIamjoHhw6gqlSpQQOmmiib+T3Bo9VjYUWNCyKNtNaP6tpT4kc8T4pG21worKxnY2TNA7ljqVKlpDms1PELuNwD+9FtrbW2tdc1+rZZbwHAerQAVSpDotF7QY2TEyHKeI5wKs8PXyVdhaxr+LhxPjge2TIPAHUN8ynFznFzjZJslV34fum8G5QdtO6FzeW+aHZOExh41J20RfCzhhtmMeJ7To29Nxx6vPj+u+lSpN1PMbguwhJ9In1rw/SpUq+x//8QAIhEAAgICAQMFAAAAAAAAAAAAAQIDEQAEEgUQMSEiM0KB/9oACAECAQE/ALyTagjNPIAcSRXHJWBGXkrlYpGHkKThmJJJNk50iZjM6fXjeX23dLWim+Vow3qPbyH5mhqx68Vrdt5Lecvs6I9c1Bo2O/8A/8QAIhEAAgICAQMFAAAAAAAAAAAAAQIDEQAEEAUSMSEiM0Fi/9oACAEDAQE/AMSCVxaoSMZWU0wIPEYDSID4JGLEAAAPQDOqRKI0f77q4vNPc2JIvjVyP1Rzc2ZJ5PdVL4A5V3S+1iLFHn//2Q=="},vPre:function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QBMRXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAOKADAAQAAAABAAAAQAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/9sAhAAICAgICQgJCgoJDQ4MDg0TERAQERMcFBYUFhQcKxsfGxsfGysmLiUjJS4mRDUvLzVETkI+Qk5fVVVfd3F3nJzRAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wgARCABAADgDASIAAhEBAxEB/8QAGgAAAgMBAQAAAAAAAAAAAAAAAAYCAwUEAf/aAAgBAQAAAADjAAtA98LdrU43VLXLG1jx3pFR7OnpNbD45sm9OzAVpS9DyMgAP//EABoBAAICAwAAAAAAAAAAAAAAAAAFAQQCBgf/2gAIAQIQAAAA6aAuVVdqqLRzhBP/xAAYAQEBAQEBAAAAAAAAAAAAAAAAAgEDBP/aAAgBAxAAAADziq3nWp0f/8QAKxAAAQMDAwIFBAMAAAAAAAAAAQACAwQREgUTIQZSEBUxcpEwM1OiQVHR/9oACAEBAAE/AMVisVisVisVisVZWWJte3CxWKstL02GrjkdIXXa63C8hpO6T5WkaPDW1NUJHOwhcBiP5uT/AIhptMIdgQM2+23C13R4aDblhJxe4jA82VlZdONvDUe8LbXTU9PFXajFLK1r5JBgDxexK2V1dPTubBAyVrpWPJc0c2VlZQUVRUAmJmVjzyAvKK/8P7BeT6h+H9gmu6kbTGmEj9v3tyt/V1U0FVTBrpo8cjxyCreGh/am9wQQQXUH2YPefEOcPQkLOTvd8rck7z8rck73fKLnO9XE/R//xAAjEQABBQABAgcAAAAAAAAAAAABAAIDBBESUZEFEBMUISJS/9oACAECAQE/AOS5LkuSuyuZA5zTh0L3dg17BD3EgDO68NszG0xoc4gn7LVYldHEXDEb835Z2VWyfWDRHG0OPyQMW+WN6BYOgWr/xAAbEQACAgMBAAAAAAAAAAAAAAAAAREgAhAhMf/aAAgBAwEBPwCi9IUoyXNIgat//9k="}}]);