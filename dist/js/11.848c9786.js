(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+ch6":function(e,t,n){"use strict";n("vxpS"),n("ThRY"),n("6wma"),n("8OWE"),n("L4wC"),n("KzFV"),n("2Kt1"),n("tpKs"),n("Y5Ue");var a=n("xc0u"),r=(n("rJH4"),n("nKmx")),o=(n("HzvR"),n("2n5t")),c=(n("WgEJ"),n("DwF0"),n("n1yf"),n("h4PX"),n("SoGA"),n("mtIt"),n("kCMX"),n("SnyF"),n("gsuU"),n("q+fq")),i=n.n(c);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return o}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var p=o.a.Option,f=["按产品","按分组"];t.a=function(e){var t=e.list,n=e.searchedData,s=e.multiple,d=void 0!==s&&s,m=e.onRef,y=e.inputkey,v=u(Object(c.useState)(0),2),h=v[0],g=v[1],b=u(Object(c.useState)([-1]),2),E=b[0],O=b[1],w=u(Object(c.useState)(""),2),I=w[0],S=w[1],P=u(Object(c.useState)(!1),2),C=P[0],x=P[1],L=u(Object(c.useState)(!1),2),j=L[0],D=L[1];Object(c.useEffect)((function(){m&&m(k)}));var R=function(e,t){var n=e.findIndex((function(e){return t==e})),a=l(e);return n>-1&&a.splice(n,1),a},k=function(){var e={type:h};return I&&(e[y]=I),E.length>0&&-1!==E[0]&&(e.productIds=E.join(",")),e};return i.a.createElement("div",{className:"comm-search-box"},i.a.createElement(r.a.Group,{compact:!0,className:"inputgroup"},i.a.createElement(o.a,{value:h,onChange:function(e){g(e),O([-1])}},f.map((function(e,t){return i.a.createElement(p,{key:t,value:t},e)}))),i.a.createElement(o.a,{showSearch:!0,optionFilterProp:"children",mode:d?"multiple":"",defaultValue:[-1],value:E,onChange:!d&&function(e){O([e])}||void 0,onSelect:d&&function(e){O(-1==e?[-1]:function(t){var n=R(t,-1);return[].concat(l(n),[e])})}||void 0,onDeselect:d&&function(e){O((function(t){return R(t,e)}))}||void 0,style:{width:250}},i.a.createElement(p,{value:-1},"全部".concat(0==h?"产品":"分组")),t[h].map((function(e,t){var n=e.productId,a=e.id,r=e.name,o=e.productName;return i.a.createElement(p,{key:t,value:[n,a][h]},[o,r][h])}))),y&&i.a.createElement(r.a,{value:I,maxLength:30,placeholder:"请输入设备ID查询",style:{width:200},onChange:function(e){S(e.target.value)}})),i.a.createElement(a.a,{type:"primary",className:"btn",onClick:function(){x(!0),n(k()).finally((function(e){console.log("---rrr--",e),x(!1)}))},loading:C,icon:"search"},"查询"),i.a.createElement(a.a,{type:"default",className:"btn",loading:j,onClick:function(){g(0),O([-1]),S(""),D(!0),n({}).finally((function(){D(!1)}))}},"重置"))}},C46E:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _e}));n("8OWE"),n("h4PX"),n("SoGA"),n("L4wC"),n("KzFV"),n("wlSd"),n("RWNY");var a,r=n("q+fq"),o=n.n(r),c=n("DndG"),i=n("etip"),l=(n("0AG1"),n("Jya7"),n("rsdX"),n("vxpS"),n("oCJ0"),n("L8Gl"),n("eVIo"),n("EO5n"),n("ThRY"),n("6wma"),n("qb5G"),n("wLbl")),u=(n("72Pr"),n("O4+N")),s=(n("Y5Ue"),n("xc0u")),d=(n("rJH4"),n("nKmx")),p=(n("+SM3"),n("SE39")),f=(n("bqBU"),n("4OHk")),m=(n("HzvR"),n("2n5t")),y=(n("eRDW"),n("n1yf"),n("61Aj"),n("ivud")),v=n("Nlzp"),h=n("Per8"),g=n("cu44"),b=n("MeRu"),E=n("+ch6"),O=n("P2RN");function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=D(e);if(t){var r=D(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return j(this,n)}}function j(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=m.a.Option,k={1:void 0,2:!0,3:!1},N=Object(y.connect)((function(e){return{productList:e.getIn(["device","productList"]).toJS(),deviceStat:e.getIn(["device","deviceStat"]).toJS(),deviceList:e.getIn(["device","deviceList"]).toJS(),freshStatu:e.getIn(["device","freshStatu"])}}),(function(e){return{getProductList:function(t){return e(Object(h.f)(t))},getDeviceStat:function(t){return e(Object(h.d)(t))},getDeviceList:function(t){return e(Object(h.c)(t))}}}))(a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(i,e);var t,n,a,r=L(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this,e)).getProductList=function(){t.props.getProductList({pageIndex:1,pageRows:9999})},t.getGroupList=function(){Object(v.c)(v.a.getGroupList,{pageIndex:1,pageRows:9999}).then((function(e){t.setState({groupList:e.data&&e.data.list||[]})}))},t.getCountDataParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"classType",n=t.state.countDataParams,a=n.classType,r=n.productId,o=n.subgroupId,c=P({},e,a);return 1==a?c.productId=r:2==a&&(c.subgroupId=o),c},t.getListParams=function(){var e=S({},t.state.listParams),n=e.innet,a=e.online;return e.innet=k[n],e.online=k[a],e},t.getDeviceStat=function(){return t.props.getDeviceStat(t.getCountDataParams("type"))},t.getDeviceList=function(){var e=t.getCountDataParams("classType"),n=t.getListParams();return t.props.getDeviceList(S(S({},e),n))},t.onChangeListParams=function(e,n){console.log(e,n);var a=S({},t.state.listParams);a[e]=n.trim&&n.trim()||n||void 0,t.setState({listParams:a})},t.inquireDeviceList=function(){var e=S({},t.state.listParams);e.pageIndex=1,t.setState({listParams:e},t.getDeviceList)},t.searchedData=function(e){var n=e.type,a=void 0===n?0:n,r=e.productIds;return console.log(99,e),t.setState({countDataParams:{classType:++a,productId:r,subgroupId:r}},(function(){t.getDeviceList(),t.getDeviceStat()})),Promise.resolve(1)},t.changePage=function(e){var n=S({},t.state.listParams);n.pageIndex=e,t.setState({listParams:n},t.getDeviceList)},t.resetSearch=function(){t.setState({listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},t.getDeviceList)},t.exportData=function(){var e=S(S({superInstanceId:localStorage.getItem("superInstanceId")},t.getCountDataParams()),t.getListParams()),n="?";for(var a in e)void 0!==e[a]&&(n+="".concat(a,"=").concat(e[a],"&"));var r=window.location.origin+v.a.exportDeviceList+n.replace(/&$/,"");try{window.open(r)}catch(e){Object(O.a)({description:e,type:"error"})}},t.state={groupList:[],countDataParams:{classType:1,productId:void 0,subgroupId:void 0},listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getProductList(),this.getGroupList(),this.getDeviceStat(),this.getDeviceList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.listParams,a=t.groupList,r=this.props,i=r.productList,y=r.deviceStat,v=r.deviceList,h=r.freshStatu,O=v.pager,w=void 0===O?{}:O,I=v.list,S=void 0===I?[]:I,P=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"物理地址",dataIndex:"deviceMac",key:"deviceMac"},{title:"产品",dataIndex:"productName",key:"productName"},{title:"分类",dataIndex:"productType",key:"productType"},{title:"所属分组",dataIndex:"groupName",key:"groupName"},{title:"类型",dataIndex:"productClass",key:"productClass",render:function(e){return{0:"普通设备",1:"网关设备"}[e]||"--"}},{title:"操作",key:"opt_detail",render:function(e,t){return o.a.createElement("span",null,o.a.createElement(c.Link,{key:"detail",to:"/open/base/device/onlineDevice/details/"+t.deviceId},"查看"))}}],C=y.exception,x=y.total,L=y.totalActive,j=y.todayActive,D=n.pageIndex,k=n.pageRows,N=n.infoType,T=n.field,_=n.labelKey,K=n.labelValue,A=n.innet,G=n.online;return o.a.createElement("section",{className:"page-main-wrapper flex-column devicelistpage"},o.a.createElement(b.a,{noback:!0,title:"设备管理"}),o.a.createElement("header",{className:"page-content-header"},o.a.createElement(E.a,{list:[i,a],searchedData:this.searchedData}),o.a.createElement("div",{className:"count-data-box"},o.a.createElement("ul",{className:"device-inine-data"},o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"当前异常数"),o.a.createElement("span",{className:"count"},C||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"累计设备总数"),o.a.createElement("span",{className:"count"},x||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"累计入网总数"),o.a.createElement("span",{className:"count"},L||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"今日入网总数"),o.a.createElement("span",{className:"count"},j||0))),o.a.createElement("div",{className:"device-refresh",onClick:this.getDeviceStat},o.a.createElement("span",null,"刷新"),o.a.createElement(f.a,{type:"sync",className:"device-refresh-icon",spin:!h})))),o.a.createElement("div",{className:"flex-column flex1"},o.a.createElement(g.a,{title:"联网设备列表"},o.a.createElement("div",{className:"alone-section-content-default"},o.a.createElement(p.a,{title:"最多导出1千条数据",placement:"top"},o.a.createElement("a",{href:"javascript:void(0)",className:"btn-exportdata",onClick:this.exportData},"导出数据")),o.a.createElement("div",{className:"lineSearchBox"},o.a.createElement("div",{className:"search-info-box"},o.a.createElement("div",{className:"searchBox"},o.a.createElement(d.a.Group,{compact:!0},o.a.createElement(m.a,{className:"type-select",value:N,onChange:function(t){e.onChangeListParams("infoType",t)}},o.a.createElement(R,{value:1},"设备ID"),o.a.createElement(R,{value:2},"物理地址")),o.a.createElement(d.a,{className:"input",maxLength:100,value:T,placeholder:"请输入设备ID号",onChange:function(t){e.onChangeListParams("field",t.target.value)}}))),o.a.createElement("span",{className:"margin-left-10px"},"设备标签："),o.a.createElement(d.a,{className:"input",placeholder:"请输入标签Key",maxLength:100,value:_,onChange:function(t){e.onChangeListParams("labelKey",t.target.value)}}),o.a.createElement(d.a,{className:"input margin-left-10px",placeholder:"请输入标签Value",maxLength:100,value:K,onChange:function(t){e.onChangeListParams("labelValue",t.target.value)}}),o.a.createElement(m.a,{className:"type-select margin-left-10px",value:A,onChange:function(t){e.onChangeListParams("innet",t)}},o.a.createElement(R,{value:1},"已/未入网"),o.a.createElement(R,{value:2},"已入网"),o.a.createElement(R,{value:3},"未入网")),o.a.createElement(m.a,{className:"type-select margin-left-10px",value:G,onChange:function(t){e.onChangeListParams("online",t)}},o.a.createElement(R,{value:1},"在/离线"),o.a.createElement(R,{value:2},"在线"),o.a.createElement(R,{value:3},"离线"))),o.a.createElement("div",{className:"searchBut"},o.a.createElement(s.a,{className:"btn",type:"primary",onClick:this.inquireDeviceList},"查询"),o.a.createElement(s.a,{className:"btn",onClick:this.resetSearch},"重置"))),o.a.createElement(u.a,{className:"devicetablelist",rowKey:"deviceUniqueId",dataSource:S,columns:P,pagination:!1})),o.a.createElement("div",{className:"list-pagination"},w&&w.totalRows>0&&o.a.createElement(l.a,{className:"self-pa",total:w.totalRows,current:D,defaultCurrent:1,defaultPageSize:k,onChange:function(t){return e.changePage(t)},showTotal:function(e){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,e)," 条")},showQuickJumper:!0,hideOnSinglePage:!0})))))}}])&&C(t.prototype,n),a&&C(t,a),i}(r.PureComponent))||a,T=(n("U4At"),n("KiF4")),_=(n("7fbo"),n("LCR/")),K=(n("gsuU"),n("FC04")),A=(n("6rnn"),n("d6B9")),G=n("M7r8");function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Y(e);if(t){var r=Y(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M(this,n)}}function M(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(c,e);var t,n,a,r=q(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).state={},t}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e={labelCol:{span:4},wrapperCol:{span:20}},t=this.props.form,n=t.getFieldDecorator,a=t.getFieldValue;return o.a.createElement(A.a,e,o.a.createElement(A.a.Item,{label:"分组名称"},n("name",{rules:[{required:!0,message:"请输入分组名称"},{max:50,message:"最大输入长度为50"}]})(o.a.createElement(d.a,{placeholder:"请输入分组名称"}))),o.a.createElement(G.a,{label:"分组描述",formId:"remark",astrictNub:"50",rows:"4",placeholder:"分组描述",getFieldDecorator:n,getFieldValue:a}))}}])&&U(t.prototype,n),a&&U(t,a),c}(r.Component),H=A.a.create({name:"caseAdd"})(B),W=(n("ECLI"),n("yq+b")),J=n.n(W);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return $(this,n)}}function $(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?ee(e):t}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(i,e);var t,n,a,r=Z(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this,e)).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(v.c)(v.a.getGroupList,e).then((function(e){t.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})}))},t.addCase=function(){t.setState({addCaseVisible:!0})},t.openDel=function(e,n){t.setState({id:e,name:n})},t.delOkCancel=function(e){if("ok"==e){var n=t.state,a=n.id,r=n.pageIndex;r=r||1,Object(v.c)(v.a.deleteGroup,{id:a}).then((function(e){0==e.code&&t.setState({loading:!0,id:""},(function(){t.getList({pageIndex:r,pageRows:10})}))}))}else t.setState({id:""})},t.searchCase=function(e){t.setState({loading:!0,searchName:e},(function(){t.pagerIndex(1)}))},t.updateModal=function(e){1==e?(0,t.addFormRefs.props.form.validateFieldsAndScroll)((function(e,n){var a=n.name,r=n.remark;e||Object(v.d)(v.a.updateGroup,{name:a,remark:r}).then((function(e){0==e.code&&(Object(O.a)({type:"success",description:"新增成功！"}),t.addCancel(),t.pagerIndex(1))}))})):t.addCancel()},t.addCancel=function(){t.setState({addCaseVisible:!1}),t.addFormRefs.props.form.resetFields()},t.pagerIndex=function(e){t.setState({pageIndex:e,loading:!0},(function(){t.getList({pageIndex:e,pageRows:10,name:t.state.searchName||void 0})}))},t.state={loading:!0,caseList:[],pager:{},searchName:"",name:"",id:"",addCaseVisible:!1,pageIndex:"1"},t.columns=[{title:"分组名称",dataIndex:"name",key:"name"},{title:"分组ID",dataIndex:"id",key:"id"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"添加时间",dataIndex:"createTime",key:"createTime",render:function(e){return o.a.createElement("span",null,e&&J()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"140px",render:function(e,n){return o.a.createElement("span",null,o.a.createElement(c.Link,{to:"/open/base/device/groupDetails/".concat(n.id,"/").concat(n.groupId)},"查看"),o.a.createElement(_.a,{type:"vertical"}),o.a.createElement("a",{onClick:t.openDel.bind(ee(t),n.id,n.name)},"删除"))}}],t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.addCaseVisible,r=t.caseList,c=t.pager,i=t.id,l=t.name;return o.a.createElement("div",{className:"devicegroup-box"},o.a.createElement("header",{className:"page-content-header"},o.a.createElement(b.a,{noback:!0,title:"设备分组管理"}),o.a.createElement("div",null,o.a.createElement("div",{className:"searchBox"},o.a.createElement(d.a.Search,{placeholder:"请输入分组名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}})),o.a.createElement("div",{className:"butFloatRight"},o.a.createElement(s.a,{className:"but-add",type:"primary",onClick:this.addCase},"新增分组")))),o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(u.a,{rowKey:"id",columns:this.columns,dataSource:r,pagination:{defaultCurrent:c.pageIndex,total:c.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:c.pageIndex},loading:n}))),o.a.createElement(T.a,{title:"新增分组",visible:a,width:600,onOk:this.updateModal.bind(this,1),onCancel:this.updateModal.bind(this,2),maskClosable:!1,className:"self-modal"},o.a.createElement(H,{onRef:function(t){return e.addFormRefs=t}})),o.a.createElement(K.a,{visible:!!i,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"删除分组",descText:"即将删除分组",targetName:l}))}}])&&z(t.prototype,n),a&&z(t,a),i}(r.Component),ae=(n("GM9G"),n("t3JN")),re=n("CvKH"),oe=n.n(re),ce=(n("kCMX"),n("EYKc"),n("TGLo")),ie=(n("kvrU"),n("BPQb"));n("mtIt"),n("SnyF"),n("WgEJ"),n("DwF0"),n("2Kt1"),n("tpKs");function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return o}(e,t)||ue(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){if(e){if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var de=function(e){var t=e.productList,n=e.changedfunc,a=e.searchedFunc,c=le(Object(r.useState)([-1]),2);c[0],c[1];return o.a.createElement("div",{className:"search-box"},o.a.createElement(d.a.Group,{compact:!0},o.a.createElement(m.a,{showSearch:!0,optionFilterProp:"children",defaultValue:[-1],onChange:n,style:{width:200}},o.a.createElement(m.a.Option,{value:-1},"全部产品"),t.map((function(e,t){return o.a.createElement(m.a.Option,{key:t,value:e.productId},e.productName)}))),o.a.createElement(d.a.Search,{enterButton:!0,maxLength:30,placeholder:"请输入设备ID查询",onSearch:a,style:{width:300}})))};function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ve(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Ee(e);if(t){var r=Ee(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return be(this,n)}}function be(e,t){return!t||"object"!==pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(c,e);var t,n,a,r=ge(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).getCreateProduct=function(){Object(v.c)(v.a.getCreateProduct,{pageRows:999}).then((function(e){var n=e.data.list;n&&n.length&&n.length>0&&t.setState({addProductList:n})}))},t.getGroupAddDevList=function(){t.setState({listLoading:!0});var e=me({},t.state.addListParams);-1==e.productId&&delete e.productId,Object(v.c)(v.a.getGroupSlctDev,e).then((function(e){var n=e.data||{},a=n.list,r=n.pager;0==e.code&&t.setState({list:a,pager:r})})).finally((function(){t.setState({listLoading:!1})}))},t.setQuestParams=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=me({},t.state.addListParams);r[e]=n||void 0,"pageIndex"!==e&&(r.pageIndex=1),t.setState({addListParams:r},!a&&t.getGroupAddDevList||void 0)},t.onSelectRowKeys=function(e){t.setState({selectedRowKeys:e})},t.addDeviceOk=function(){var e=t.state,n=e.addWay,a=e.selectedRowKeys;if(1==n){var r=a;r.length>0&&Object(v.d)(v.a.addGroupDevice,{id:t.props.id,deviceIds:r.join(",")}).then((function(e){t.setState({selectedRowKeys:[]}),t.props.openCloseAdd(!0)}))}else 2==n&&t.publicTypeForm()},t.addUPload=function(e){e.groupId=t.props.groupid,e.type=1,Object(v.d)(v.a.addDevice,e).then((function(e){t.props.openCloseAdd(!0)}))},t.changeAddWay=function(e){var n=e.target.value;t.setState({addWay:n})},t.state={addWay:1,listLoading:!1,list:[],pager:{},selectedRowKeys:[],addListParams:{pageIndex:1,pageRows:8,id:e.id,productId:-1,deviceUniqueId:void 0},addProductList:[]},t.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return o.a.createElement("span",null,e&&J()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}}],t}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this),this.getCreateProduct()}},{key:"render",value:function(){var e=this,t=this.props,n=t.addVisiable,a=t.openCloseAdd,r=this.state,c=r.selectedRowKeys,i=r.list,l=r.pager,s=r.addWay,d=r.listLoading,p=r.addProductList,f={selectedRowKeys:c,onChange:this.onSelectRowKeys};return o.a.createElement(T.a,{title:"添加设备到分组",visible:n,width:750,onOk:this.addDeviceOk,onCancel:function(){a(!1)},maskClosable:!1,closable:!1,className:"groupadd-device-modal"},o.a.createElement("div",{className:"addtype"},o.a.createElement(ie.a.Group,{value:s,onChange:this.changeAddWay},o.a.createElement(ie.a,{value:1},"查找选择"),o.a.createElement(ie.a,{value:2},"本地导入"))),1==s?o.a.createElement("div",{className:""},o.a.createElement(de,{productList:p,changedfunc:function(t){e.setQuestParams("productId",t,!0)},searchedFunc:function(t){e.setQuestParams("deviceUniqueId",t)}}),o.a.createElement("div",{className:"list-content"},o.a.createElement(u.a,{rowKey:"deviceId",columns:this.columns,dataSource:i,rowSelection:f,loading:!!d,pagination:{defaultCurrent:l.pageIndex,total:l.totalRows,onChange:function(t){e.setQuestParams("pageIndex",t)},current:l.pageIndex}}))):o.a.createElement(we,{productList:p,onRef:function(t){return e.publicTypeForm=t},addUPload:this.addUPload}))}}])&&ve(t.prototype,n),a&&ve(t,a),c}(r.PureComponent),we=A.a.create({name:"form-upload-device"})((function(e){var t=e.form,n=e.productList,a=e.onRef,c=e.addUPload;Object(r.useEffect)((function(){a(u)}),[]);var i=t.getFieldDecorator,l=t.validateFields,u=function(){l((function(e,t){if(console.log(3333,t),!e){var n=t.data,a=t.productId,r="";if(n&&n.fileList&&n.fileList.length){var o=n.fileList[0];o&&o.response&&o.response.data&&(r=o.response.data.url)}c({productId:a,data:r})}}))},d={labelCol:{span:6},wrapperCol:{span:10}};return o.a.createElement("div",null,o.a.createElement(A.a,d,o.a.createElement(A.a.Item,{label:"产品"},i("productId",{rules:[{required:!0,message:"请选择产品！"}],initialValue:""})(o.a.createElement(m.a,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择产品"},o.a.createElement(m.a.Option,{value:"",disabled:!0,selected:!0},"请选择产品"),n.map((function(e){var t=e.productName,n=e.productId;return o.a.createElement(m.a.Option,{key:n,value:n},t)}))))),o.a.createElement(A.a.Item,{label:"上传文件"},i("data",{rules:[{required:!0,message:"请上传文件！"}]})(o.a.createElement(ce.a,{accept:".xls,.xlsx",action:v.a.upFileUrl,data:{appId:31438,domainType:4}},o.a.createElement(s.a,{type:"primary",icon:"upload"},"上传文件"),o.a.createElement("span",{style:{marginLeft:"15px"}},"仅支持.xls,.xlsx格式文件"))),o.a.createElement("a",{href:"http://skintest.hetyj.com/31438/6b0b20891e06ac31d0eed37a5083cca9.xlsx"},"下载模板"))))}));function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=je(e);if(t){var r=je(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return xe(this,n)}}function xe(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?Le(e):t}function Le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(i,e);var t,n,a,r=Ce(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this,e)).openDel=function(e,n){t.setState({delVisable:!0}),e&&(console.log(e),t.setState({delid:e,deldeviceUniqueId:n}))},t.getDetail=function(){Object(v.c)(v.a.getGroupDetail,{id:t.id}).then((function(e){var n=e.data,a=n.name,r=n.createTime,o=n.remark,c=n.deviceCount,i=n.activeCount,l=n.groupId;t.setState({name:a,remark:o,deviceCount:c,activeCount:i,groupId:l,createTime:J()(r).add(8,"h").format("YYYY-MM-DD HH:mm:ss")})}))},t.getDownProduct=function(){Object(v.c)(v.a.getDownProduct,{pageRows:999}).then((function(e){var n=e.data.list;n&&n.length&&n.length>0&&t.setState({productList:n})}))},t.getGroupDevList=function(){var e=oe()(t.state.listParams);-1==e.productId&&delete e.productId,Object(v.c)(v.a.getGroupDeviceList,e).then((function(e){var n=e.data||{},a=n.list,r=n.pager;t.setState({groupDevList:a,pager:r})}))},t.setParams=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=oe()(t.state.listParams);r[e]=n||void 0,"pageIndex"!==e&&(r.pageIndex=1),t.setState({listParams:r},!a&&t.getGroupDevList||void 0)},t.openCloseAdd=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!t.state.addVisiable;t.setState({addVisiable:n}),n?(t.addListRefs.setQuestParams("pageIndex",1),t.addListRefs.setState({addWay:1})):e&&t.getGroupDevList()},t.onSelectRowKeys=function(e){t.setState({selectedRowKeys:e})},t.delOkCancel=function(e){var n=t.state,a=n.delid,r=n.selectedRowKeys;"ok"==e?Object(v.d)(v.a.delGroupDevice,{id:t.id,deviceIds:a||r.join(",")}).then((function(e){0==e.code&&(t.getGroupDevList(),t.setState({delid:"",delVisable:!1,selectedRowKeys:[]}))})):t.setState({delid:"",delVisable:!1})},t.id=e.match.params.groupid,t.groupidid=e.match.params.groupidid,t.defaultListParams={pageIndex:1,pageRows:10,id:t.id,productId:-1,deviceUniqueId:void 0},t.addListRefs=null,t.state={listParams:oe()(t.defaultListParams),name:"--",groupId:"--",createTime:"--",remark:"--",deviceCount:"--",activeCount:"--",groupDevList:[],pager:{},productList:[],addVisiable:!1,addProductList:[],selectedRowKeys:[],delid:"",deldeviceUniqueId:"",delVisable:!1},t.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"设备类型",dataIndex:"productClass",key:"productClass",render:function(e){return o.a.createElement("span",null,0==e?"普通设备":"网关设备")}},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return o.a.createElement("span",null,e&&J()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"200px",render:function(e,n){return o.a.createElement("span",null,o.a.createElement(c.Link,{key:"detail",to:"/open/base/device/onlineDevice/details/"+n.deviceId},"查看"),o.a.createElement(_.a,{type:"vertical"}),o.a.createElement("a",{onClick:t.openDel.bind(Le(t),n.deviceId,n.deviceUniqueId)},"从分组中删除"))}}],t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getDetail(),this.getDownProduct(),this.getGroupDevList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,a=t.createTime,r=t.remark,c=t.deviceCount,i=t.activeCount,l=t.groupId,d=t.productList,p=t.groupDevList,f=t.addVisiable,m=t.selectedRowKeys,y=t.pager,v=t.delVisable,h=t.delid,E=t.deldeviceUniqueId,O=t.addProductList,w={selectedRowKeys:m,onChange:this.onSelectRowKeys};return o.a.createElement("section",{className:"page-main-wrapper groupdetailpage flex-column"},o.a.createElement(b.a,{title:"设备分组详情"}),o.a.createElement("header",{className:"page-content-header"},o.a.createElement(ae.a,{title:"",className:"descriptions",column:2},o.a.createElement(ae.a.Item,{label:"分组名称"},n),o.a.createElement(ae.a.Item,{label:"分组ID"},l),o.a.createElement(ae.a.Item,{label:"创建时间"},a),o.a.createElement(ae.a.Item,{label:"描述"},r)),o.a.createElement("ul",{className:"device-inine-data"},o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"设备总数"),o.a.createElement("span",{className:"count"},c)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"激活设备数"),o.a.createElement("span",{className:"count"},i)))),o.a.createElement(g.a,{title:"设备列表"},o.a.createElement("div",{className:"alone-section-content-default"},o.a.createElement(de,{productList:d,changedfunc:function(t){e.setParams("productId",t,!0)},searchedFunc:function(t){e.setParams("deviceUniqueId",t)}}),o.a.createElement("div",{className:"search-box"},o.a.createElement(s.a,{className:"but-add",type:"primary",onClick:this.openCloseAdd},"添加设备到分组")),o.a.createElement("div",null,o.a.createElement(s.a,{disabled:0==m.length,className:"but-del",type:"primary",onClick:this.openDel.bind(this,0)},"删除"),o.a.createElement(u.a,{rowKey:"deviceId",columns:this.columns,dataSource:p,rowSelection:w,pagination:{defaultCurrent:y.pageIndex,total:y.totalRows,hideOnSinglePage:!1,onChange:function(t){e.setParams("pageIndex",t)},current:y.pageIndex}})))),o.a.createElement(Oe,{addVisiable:f,onRef:function(t){e.addListRefs=t},productList:O,id:this.id,groupid:this.groupidid,openCloseAdd:this.openCloseAdd}),o.a.createElement(K.a,{visible:v,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"从分组中删除",descText:"即将删除".concat(h?"设备":"选中的"),targetName:h?"".concat(E):"".concat(m.length,"个设备")}))}}])&&Se(t.prototype,n),a&&Se(t,a),i}(r.PureComponent),Re=(n("Zy8g"),Object(i.default)((function(){return Promise.all([n.e("common"),n.e("vendor"),n.e(2),n.e(13)]).then(n.bind(null,"kZcz"))}))),ke=Object(i.default)((function(){return n.e(14).then(n.bind(null,"R4Qp"))})),Ne=Object(i.default)((function(){return Promise.all([n.e("common"),n.e("vendor"),n.e(16)]).then(n.bind(null,"vT3+"))})),Te=Object(i.default)((function(){return Promise.all([n.e("common"),n.e("vendor"),n.e(15)]).then(n.bind(null,"lunQ"))}));function _e(e){var t=e.match.path;return o.a.createElement(c.Switch,null,o.a.createElement(c.Route,{path:"".concat(t,"/onlineDevice/list"),component:N}),o.a.createElement(c.Route,{path:"".concat(t,"/onlineDevice/details/:deviceid"),component:Re}),o.a.createElement(c.Route,{path:"".concat(t,"/deviceSecret"),component:ke}),o.a.createElement(c.Route,{path:"".concat(t,"/groups"),component:ne}),o.a.createElement(c.Route,{path:"".concat(t,"/groupDetails/:groupid/:groupidid"),component:De}),o.a.createElement(c.Route,{path:"".concat(t,"/deviceWarning"),component:Ne}),o.a.createElement(c.Route,{path:"".concat(t,"/addWarningConfig"),component:Te}),o.a.createElement(c.Route,{path:"".concat(t,"/warningConfig/:id"),component:Te}),o.a.createElement(c.Redirect,{to:"".concat(t,"/onlineDevice/list")}))}},ECLI:function(e,t,n){},Zy8g:function(e,t,n){}}]);