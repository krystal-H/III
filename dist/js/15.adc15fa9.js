(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{JsKL:function(e,t,a){"use strict";a.r(t);a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("+2oP"),a("pjDv"),a("tkto"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR"),a("L/Qf");var n=a("2/Rp"),r=(a("qNb/"),a("PArb")),l=(a("mbEz"),a("wCAj")),c=(a("AUBz"),a("ZTPi")),i=(a("sMBO"),a("q1tI")),o=a.n(i),u=a("xvlK"),d=a("DgvE"),s=a("Nlzp"),m=a("MeRu"),f=a("FC04"),p=(a("k3Gp"),a("kLXV")),g=(a("1vPl"),a("5rEg")),v=(a("Jmwx"),a("BMrR")),E=(a("rO+z"),a("kPKH")),b=a("v7xx"),y=a("P2RN");function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var O=function(e){var t=e.warningInof,a=e.closeDetailMod,n=e.delwithWarn,r=t.alarmTime,l=t.warningTitle,c=t.state,u=t.warningWay,m=t.ruleName,f=t.warningDetail,h=t.deviceIds,O=t.dealDetail,j=t.id,x=w(Object(i.useState)(""),2),I=x[0],k=x[1],N=w(Object(i.useState)(""),2),C=N[0],T=N[1],S=1==c&&o.a.createElement(b.a,{style:{padding:"0"},preText:"取消",nextText:"提交",preHandle:a,nextHandle:function(){I?n({id:j,dealDetail:I}):Object(y.a)({description:"请填写处理记录",type:"warn"})}})||o.a.createElement(b.a,{style:{padding:"0"},nextBtn:!1,preText:"关闭",preHandle:a}),D=[12,24];return o.a.createElement(p.a,{className:"warningdetail-page",title:l,visible:!!l,width:700,onCancel:a,footer:S},o.a.createElement(v.a,{gutter:D},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警时间："),o.a.createElement(E.a,{span:18},d.a.utcToDev(r)||"--")),o.a.createElement(v.a,{gutter:D},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警消息类型："),o.a.createElement(E.a,{span:18},{0:"站内",1:"站内+邮件"}[u])),o.a.createElement(v.a,{gutter:D},o.a.createElement(E.a,{span:5,className:"detail-label"},"关联的告警规则："),o.a.createElement(E.a,{span:18},m||"--")),o.a.createElement(v.a,{gutter:D},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警内容："),o.a.createElement(E.a,{span:18},o.a.createElement("div",{className:"border-texarea"},f||"--"))),o.a.createElement(v.a,{gutter:D},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警设备ID："),o.a.createElement(E.a,{span:16},o.a.createElement("div",{className:"border-texarea"},C||h||"")),o.a.createElement(E.a,{span:2},o.a.createElement("a",{href:"javascript:",onClick:function(){Object(s.c)(s.a.getWarningInfo,{warningId:j},{loading:!0}).then((function(e){T(e.data.deviceIds)}))}},"刷新"))),o.a.createElement(v.a,{gutter:D},o.a.createElement(E.a,{span:5,className:"detail-label"},"处理记录："),o.a.createElement(E.a,{span:18},1==c&&o.a.createElement(g.a.TextArea,{rows:3,value:I||O||"",placeholder:"处理记录",onChange:function(e){k(e.target.value)}})||o.a.createElement("div",{className:"border-texarea"},I||O||""))))};function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){I(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var C=c.a.TabPane,T={pageRows:10,pageIndex:1},S=(t.default=function(e){var t=k(Object(i.useState)({}),2),a=t[0],n=t[1];Object(i.useEffect)((function(){r()}),[]);var r=function(){Object(s.c)(s.a.getDeviceWarningTotal,{loading:!0}).then((function(e){var t=e.data;n(t)}))};return o.a.createElement("section",{className:"device-secret-wrapper device-warningpage"},o.a.createElement("div",{className:"device-secret-header"},o.a.createElement(m.a,{noback:!0,title:"设备告警"}),o.a.createElement("div",{className:"device-secret-statistic clearfix"},o.a.createElement("div",{className:"common-id"},o.a.createElement("div",null,"待处理告警"),o.a.createElement("div",null,a.pendingCount)),o.a.createElement("div",{className:"used"},o.a.createElement("div",null,"已处理告警"),o.a.createElement("div",null,a.processedCount)),o.a.createElement("div",{className:"register"},o.a.createElement("div",null,"已发送告警"),o.a.createElement("div",null,a.sentCount)),o.a.createElement("div",{className:"unregistered time"},o.a.createElement("div",null,"最近告警时间"),o.a.createElement("div",null,a.leastWaringDate&&d.a.utcToDev(a.leastWaringDate)||"无")))),o.a.createElement(c.a,{defaultActiveKey:e.location.page||"1",tabBarStyle:{background:"#fff",padding:"0 24px",margin:"0"}},o.a.createElement(C,{tab:"告警列表",key:"1"},o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(S,null)))),o.a.createElement(C,{tab:"告警配置",key:"2"},o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(D,{_props:e}))))))},function(e){var t=k(Object(i.useState)({pager:{},list:[]}),2),a=t[0],n=t[1],r=k(Object(i.useState)({}),2),c=r[0],u=r[1];Object(i.useEffect)((function(){m(T)}),[]);var m=function(e){Object(s.c)(s.a.getWarningList,e,{loading:!0}).then((function(e){n(e.data)}))},f=[{title:"告警时间",dataIndex:"alarmTime",key:"alarmTime",render:function(e){return e?d.a.utcToDev(e):"--"}},{title:"告警标题",dataIndex:"warningTitle",key:"warningTitle"},{title:"告警状态",dataIndex:"state",key:"state",render:function(e){return o.a.createElement("span",null,{1:"待处理",2:"已处理",3:"已发送"}[e])}},{title:"告警消息类型",dataIndex:"warningWay",key:"warningWay",render:function(e){return o.a.createElement("span",null,{0:"站内",1:"站内+邮件"}[e])}},{title:"关联的告警规则",dataIndex:"ruleName",key:"ruleName"},{title:"操作",dataIndex:"id",key:"id",render:function(e,t){var a=t.state;return o.a.createElement("a",{onClick:function(){g(e)},href:"javascript:"},"1"==a?"处理":"查看")}}],p=function(e){m(x(x({},T),{},{pageIndex:e}))},g=function(e){Object(s.c)(s.a.getWarningInfo,{warningId:e},{loading:!0}).then((function(e){u(e.data)}))},v=function(){u({})},E=a.list,b=a.pager;return o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{rowKey:"id",columns:f,dataSource:E,pagination:{defaultCurrent:b.pageIndex,total:b.totalRows,onChange:p,current:b.pageIndex}}),o.a.createElement("p",null,"备注：仅限站内消息类型有“待处理”和“已处理状态”，站内消息+邮件均为“已发送”状态"),o.a.createElement(O,{warningInof:c,closeDetailMod:v,getIndexPage:p,delwithWarn:function(e){Object(s.d)(s.a.dealWithWarning,e,{loading:!0}).then((function(e){p(a.pager.pageIndex||1),v()}))}}))}),D=function(e){var t=k(Object(i.useState)({pager:{},list:[]}),2),a=t[0],c=t[1],m=k(Object(i.useState)([]),2),p=m[0],g=m[1];Object(i.useEffect)((function(){v(T)}),[]);var v=function(e){Object(s.c)(s.a.getWarningConfigLi,e,{loading:!0}).then((function(e){c(e.data)}))},E=[{title:"规则名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"运行状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"初始状态",1:"运行中",2:"已停止"}[e])}},{title:"最近编辑时间",dataIndex:"updateTime",key:"updateTime",render:function(e){return e?d.a.utcToDev(e):"--"}},{title:"操作",dataIndex:"id",key:"id",render:function(e,t){var a=t.id,n=t.name,l=t.status;return o.a.createElement("span",null,o.a.createElement("a",{href:"#/open/base/device/warningConfig/".concat(a)},"编辑"),o.a.createElement(r.a,{type:"vertical"}),1==l&&o.a.createElement("a",{onClick:function(){g([a,n,"stop"])},href:"javascript:"},"停止")||o.a.createElement("a",{onClick:function(){y(a)},href:"javascript:"},"启动"),o.a.createElement(r.a,{type:"vertical"}),o.a.createElement("a",{onClick:function(){g([a,n,"del"])},href:"javascript:"},"删除"))}}],b=function(e){v(x(x({},T),{},{pageIndex:e}))},y=function(e){Object(s.c)(s.a.startWarningConfigLi,{ruleId:e},{loading:!0}).then((function(e){b(a.pager.pageIndex||1)}))},w=a.list,h=a.pager;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"addwarning-btn"},o.a.createElement(n.a,{href:"#/open/base/device/addWarningConfig",icon:o.a.createElement(u.a,null),type:"primary"},"新增")),o.a.createElement(l.a,{rowKey:"id",columns:E,dataSource:w,pagination:{defaultCurrent:h.pageIndex,total:h.totalRows,onChange:b,current:h.pageIndex}}),o.a.createElement(f.a,{visible:p.length>0,modalOKHandle:function(){var e="del"==p[2]&&s.a.delWarningConfig||s.a.stopWarningConfig;Object(s.c)(e,{ruleId:p[0]},{loading:!0}).then((function(e){b(a.pager.pageIndex||1),g([])}))},modalCancelHandle:function(){g([])},title:"del"==p[2]?"删除":"停止",descText:"即将".concat("del"==p[2]?"删除":"停止","告警配置"),needWarnIcon:!0,targetName:p[1]}))}}}]);