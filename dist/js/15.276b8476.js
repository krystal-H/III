(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"5pZq":function(e,t,a){},Dldd:function(e,t,a){},QXgO:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACP0lEQVQokW2T20uUURTFf+fMfJ+XqERiyGTM7vQQYlEYFGQWERF0oZ56iIIgAomC7KWngohu/0BCD/VSJASRpWj1ot2g64MIFoxkVhSl1OjMfHv18I01Rhs2+xzYe5211uY4/olHb0Z2mTgs0yqTQieeOKeLGxvTd//tBXCll97XH9sxOyCJOIHi2cH5zavnn/gvQM/L4VpP8oxh+4FBoUvO+WeKrMyiaAfQamblcm731jX1HdMAut+MLPeRHiJSQHfBJ3ZuaZj7s7Spu29oRZTwj2T21RwntzUtuvUH4MHLkQ6TNQN3AiWO5Sy/x9ARxEKkjGEXtqxecOXe43c7Jd2SiMy0afv6JQ8BXO+LD1cduaPNjQu+dz3PXEA6PuUBEjmD25lUz9D4jPqyhBZWh3k3r3LiaaYwa8PNvS7r7r8aTQVRoSYfFVpxbj8mPwWQN7g+VMPoRDmhh8BBUKxhgv58SEvS5yeXFkQXokKy2HUDIfo+V/FpopzamXB8HSxPweAXaH8CY1nWVka0eYmzkiokIRNmQjIkMfBjJoGLh1fWQucANMyDQ01FNo59SaFGWTwg/u5dgmyUJPDxywDZXFwXz4mlhJ60l2m01DSVZHWQJ/AxbYA1dfDtF7z/CmHsx7B3cFoCQZH+VBrLZo0R+ljz24+QroJPY3Djecwg6bjmADr73h002SlJdTJzsRxRMMeDz2nGC5XTN+Ah6emfjGiZ9hf+F3tuqGJ2RFvg2Bd60oFnOOm4Nhlx7vJel/0NjPBPH+SMP1MAAAAASUVORK5CYII="},"WO/V":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return X}));a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("+2oP"),a("sMBO"),a("pjDv"),a("rB9j"),a("tkto"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR"),a("mbEz");var n=a("wCAj"),r=(a("L/Qf"),a("2/Rp")),o=(a("qNb/"),a("PArb")),l=(a("1vPl"),a("5rEg")),c=(a("RKNx"),a("L41K")),i=(a("8QGh"),a("2fM7")),m=a("BkRI"),u=a.n(m),s=(a("2B1R"),a("zKZe"),a("q1tI")),p=a.n(s),d=a("MeRu"),f=a("QXgO"),y=a.n(f),b=a("mU7p"),S=a("Nlzp"),v=(a("k3Gp"),a("kLXV")),N=(a("TfFZ"),a("3S7+")),O=(a("tULf"),a("Vl3Y")),g=a("zqxM"),E=a.n(g),h=(a("ma9I"),a("pDQq"),a("Lyp1")),j=a("/MfK"),A=a("Ue1A"),w=a("P2RN");a("5pZq");function k(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function P(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,o=[],l=!0,c=!1;try{for(a=a.call(e);!(l=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==a.return||a.return()}finally{if(c)throw r}}return o}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return x(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var R=i.a.Option;function T(e){var t=e.visible,a=e.onCancel,n=e.type,o=e.editData,c=e.handleOk,m=e.allProductList,d=D(O.a.useForm(),1)[0],f=D(Object(s.useState)(!1),2),y=f[0],b=f[1],g=D(Object(s.useState)(""),2),C=g[0],x=g[1],T=D(Object(s.useState)([]),2),B=T[0],Q=T[1],H=D(Object(s.useState)([]),2),M=H[0],F=H[1];Object(s.useEffect)((function(){"edit"===n&&(L(o.productId),d.setFieldsValue(o),Q(o.timeServerDetails))}),[]);var L=function(e){Object(S.c)(S.a.getPhysicalModel,{productId:e}).then((function(e){console.log(e),F(e.data.properties),x("")}))},W=function(){var e=u()(M).map((function(e){return e.identifier})),t=[];"add"===n&&(t=u()(B).map((function(e){return e.identifier}))),"edit"===n&&(t=u()(B).map((function(e){return e.property})));var a=E()(e,t),r=[];return u()(M).forEach((function(e){a.forEach((function(t){e.identifier==t&&r.push(e)}))})),r};return p.a.createElement(v.a,{title:"add"===n?"添加云端定时功能":"编辑云端定时功能",width:655,visible:t,onOk:function(){d.submit()},onCancel:a,maskClosable:!1,destroyOnClose:!0,wrapClassName:"replace-module-modal"},p.a.createElement("div",{className:"cloud-manage-modal"},p.a.createElement(O.a,{form:d,onFinish:function(e){var t=[];if("add"===n?t=B.map((function(e){return{property:e.identifier,propertyName:e.name,functionDataType:e.dataType.type}})):(t=B.map((function(e){return{property:e.property||e.identifier,propertyName:e.propertyName||e.name,functionDataType:e.functionDataType||e.dataType.type}})),e.serviceId=o.serviceId),0===B.length)return Object(w.a)({description:"请选择需要关联的协议!",type:"warn"});e.timeServerDetails=t,Object(S.c)(S.a.saveTimeService,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){P(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),{loading:!0}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),c()}))},labelCol:{span:4},wrapperCol:{span:19}},p.a.createElement(O.a.Item,{label:"功能名称",name:"serviceName",rules:[{required:!0,message:"请输入功能名称"},{max:50,message:"最大输入长度为50"}]},p.a.createElement(l.a,{placeholder:"不超过50个字符"})),p.a.createElement(O.a.Item,{label:"归属产品",name:"productId",rules:[{required:!0,message:"请选择归属产品"}]},p.a.createElement(i.a,{disabled:"edit"===n,onChange:function(e){return L(e)},showSearch:!0,optionFilterProp:"children"},m&&m.map((function(e){return p.a.createElement(R,{key:e.productId,value:e.productId},e.productName)})))),p.a.createElement(O.a.Item,{label:p.a.createElement(p.a.Fragment,null,p.a.createElement("span",{className:"required-relation"},"关联协议"),p.a.createElement(N.a,{title:"仅支持可下发类型数据",placement:"top"},p.a.createElement(h.a,null)))},B.length>0&&p.a.createElement("div",{className:"show-protocol-box"},B.map((function(e,t){return p.a.createElement("div",{className:"protocol-bar",key:t},p.a.createElement("p",{className:"protocol-bar-title"},e.name||e.propertyName),p.a.createElement("div",null,p.a.createElement("span",null,e.identifier||e.property)),p.a.createElement("span",{className:"protocol-bar-del",onClick:function(){return function(e){var t=u()(B);t.splice(e,1),Q(t)}(t)}},p.a.createElement(j.a,null)," 删除"))}))),y&&p.a.createElement("div",{className:"select-protocol-box"},p.a.createElement("div",null,p.a.createElement(i.a,{value:C,onChange:function(e){x(e)},style:{width:365}},p.a.createElement(R,{key:"",value:""},"请选择需要相关的协议"),W().map((function(e,t){return p.a.createElement(R,{key:e.identifier,value:e.identifier},e.name)})))),p.a.createElement("div",{className:"control-btns"},p.a.createElement("div",{className:"confirm-btn",onClick:function(){return function(){if(""===C)return Object(w.a)({type:"error",description:"请先选择一个控制协议字段"});Q((function(e){var t=u()(e),a=M.filter((function(e){return e.identifier===C}));return[].concat(k(t),k(a))})),b(!1),x("")}()}},p.a.createElement(A.a,null)," 确定"),p.a.createElement("div",{className:"del-btn",onClick:function(){return b(!1),void x("")}},p.a.createElement(j.a,null)," 删除"))),p.a.createElement(r.a,{className:"add-btn",onClick:function(){b(!0)}},"添加功能点")))))}var B=a("FC04");var Q=function(e){var t=e.operate,a=e.visible,n=e.updateOkHandle,r=e.updateCancelHandle,o=e.changeStatus,l=null;switch(t){case 1:l={title:"发布云端定时功能",desc:"即将发布的功能",tip:"功能发布后，APP上可以看到并启用，是否确认发布？",needWarnIcon:!1};break;case 2:l={title:"删除云端定时功能",desc:"即将删除的功能",tip:"功能删除后将无法找回，是否确认删除？",needWarnIcon:!0};break;case 0:l={title:"下线云端定时功能",desc:"即将下线的功能",tip:"功能下线后将无法看到，是否确认下线？",needWarnIcon:!0}}return p.a.createElement(B.a,{visible:a,modalOKHandle:function(){return n(t)},modalCancelHandle:r,targetName:o.serviceName,title:l.title,descGray:!0,needWarnIcon:l.needWarnIcon,descText:l.desc,tipText:l.tip})},H=a("DgvE");a("Dldd");function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,o=[],l=!0,c=!1;try{for(a=a.call(e);!(l=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==a.return||a.return()}finally{if(c)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return W(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}i.a.Option;var V=c.a.Step,J=l.a.Search;function X(){var e=L(Object(s.useState)(null),2),t=e[0],a=e[1],l=L(Object(s.useState)(!1),2),i=l[0],m=l[1],f=L(Object(s.useState)(!1),2),v=f[0],N=f[1],O=L(Object(s.useState)(""),2),g=O[0],E=O[1],h=L(Object(s.useState)(""),2),j=h[0],A=h[1],k=L(Object(s.useState)(!1),2),I=k[0],P=k[1],D=L(Object(s.useState)([]),2),C=D[0],x=D[1],R=L(Object(s.useState)([]),2),B=R[0],W=R[1],X=L(Object(s.useState)([]),2),K=X[0],U=X[1],z=[{title:"功能名称",dataIndex:"serviceName",key:"serviceName"},{title:"关联协议",dataIndex:"propertyName",key:"propertyName",render:function(e,t){return p.a.createElement("div",null,t.timeServerDetails&&t.timeServerDetails.map((function(e,t){return p.a.createElement("div",{key:t},e.propertyName)})))}},{title:"协议数据标识",dataIndex:"property",key:"property",render:function(e,t){return p.a.createElement("div",null,t.timeServerDetails&&t.timeServerDetails.map((function(e,t){return p.a.createElement("div",{key:t},e.property)})))}},{title:"归属产品名称",dataIndex:"productName",key:"productName"},{title:"协议数据类型",dataIndex:"functionDataType",key:"functionDataType",render:function(e,t){return p.a.createElement("div",null,t.timeServerDetails&&t.timeServerDetails.map((function(e,t){return p.a.createElement("div",{key:t},e.functionDataType)})))}},{title:"状态",dataIndex:"status",key:"status",width:120,render:function(e,t){return p.a.createElement("span",null,b.b[t.status])}},{title:"操作",key:"action",width:200,render:function(e,t){return p.a.createElement("span",null,1!==t.status?p.a.createElement(p.a.Fragment,null,p.a.createElement("a",{onClick:function(){ee(t)}},"编辑"),p.a.createElement(o.a,{type:"vertical"}),p.a.createElement("a",{onClick:function(){ae(t,1)}},"发布"),p.a.createElement(o.a,{type:"vertical"}),p.a.createElement("a",{onClick:function(){ae(t,2)}},"删除")):p.a.createElement("a",{onClick:function(){ae(t,0)}},"下线"))}}],Z=L(Object(s.useState)([]),2),G=Z[0],q=Z[1],Y=L(Object(s.useState)({pageIndex:1,totalRows:0,pageRows:6}),2),$=Y[0],_=Y[1];Object(s.useEffect)((function(){te()}),[$.pageIndex,$.pageRows,j,g]);Object(s.useEffect)((function(){Object(S.b)(S.a.getProductType).then((function(e){U(e.data)}),(function(){return U([])}))}),[]);var ee=function(e){x(e),P(!0)},te=function(){Object(S.c)(S.a.getTimeServiceList,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){F(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({serviceName:j||"",productId:g||Object(H.h)("productId")||""},$),{loading:!0}).then((function(e){q(e.data.list),_((function(t){return Object.assign(u()(t),{totalRows:e.data.pager.totalRows})}))}))},ae=function(e,t){W(e),N(!0),a(t)};return p.a.createElement("div",{id:"cloud-time"},p.a.createElement(d.a,{title:"云端定时",selectOnchange:function(e){return E(e)},defaultValue:Object(H.h)("productId")||"-1"}),p.a.createElement("div",{className:"comm-shadowbox setp-tip comm-setp-ttip"},p.a.createElement("div",{className:"step-title"},p.a.createElement("img",{src:y.a,alt:""}),p.a.createElement("span",null,"云端定时步骤")),p.a.createElement(c.a,{current:-1,initial:0},p.a.createElement(V,{title:"创建定时功能",description:"可以使用产品的控制数据功能的点，创建定时功能。"}),p.a.createElement(V,{title:"发布定时功能",description:"定时功能确认无误后，可以发布到Clife或您创建的App上。"}),p.a.createElement(V,{title:"App端配置",description:"在App端基于已经发布的定时功能，配置定时任务。"}),p.a.createElement(V,{title:"App端应用",description:"满足定时任务的触发条件后，自动发送指令控制设备。"}))),p.a.createElement("div",{className:"comm-shadowbox device-content"},p.a.createElement("div",{className:"content-top"},p.a.createElement("div",{className:"content-top-left"},p.a.createElement(J,{placeholder:"请输入功能名称",allowClear:!0,style:{width:465},onSearch:function(e){return A(e)}})),p.a.createElement(r.a,{type:"primary",onClick:function(){return m(!0)}},"创 建")),p.a.createElement(n.a,{rowKey:"serviceId",dataSource:G,columns:z,pagination:{defaultCurrent:1,current:$.pageIndex,onChange:function(e,t){_((function(a){return Object.assign(u()(a),{pageIndex:t===$.pageRows?e:1,pageRows:t})}))},pageSize:$.pageRows,total:$.totalRows,showQuickJumper:$.totalPages>5}})),i&&p.a.createElement(T,{visible:i,type:"add",allProductList:K,handleOk:function(){m(!1),te()},onCancel:function(){return m(!1)}}),I&&p.a.createElement(T,{visible:I,type:"edit",editData:C,allProductList:K,handleOk:function(){P(!1),te()},onCancel:function(){return P(!1)}}),v&&p.a.createElement(Q,{visible:v,operate:t,changeStatus:B,updateOkHandle:function(){return e=t,void Object(S.c)(S.a.updateTimeServiceStatus,{serviceId:B.serviceId,productId:B.productId,status:e},{loading:!0}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),N(!1),te()}));var e},updateCancelHandle:function(){return N(!1)}}))}},mU7p:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"g",(function(){return i})),a.d(t,"c",(function(){return m}));var n={0:"开发中",1:"已发布",2:"审核中"},r={1:"草稿",2:"审核中",3:"灰度版本",4:"正式版本"},o={1:"SDK开发",2:"在线拖拽"},l={0:"草稿",1:"已发布",2:"删除"},c=[{value:"全部状态 ",key:"-1"},{value:"已入网 ",key:"1 "},{key:"0 ",value:"未入网 "}],i=[{Symbol:"无",Name:"无"},{Symbol:"μg/m³",Name:"不知道2"},{Symbol:"mg/m³",Name:"不知道3"},{Symbol:"cal",Name:"卡路里"},{Symbol:"g",Name:"克"},{Symbol:"kg",Name:"千克"},{Symbol:"t",Name:"吨"},{Symbol:"mL",Name:"毫升"},{Symbol:"L",Name:"升"},{Symbol:"℉",Name:"华氏度"},{Symbol:"°C",Name:"摄氏度"},{Symbol:"%RH",Name:"相对湿度"},{Symbol:"nm",Name:"纳米"},{Symbol:"μm",Name:"微米"},{Symbol:"cm",Name:"厘米"},{Symbol:"m",Name:"米"},{Symbol:"km",Name:"千米"},{Symbol:"s",Name:"秒"},{Symbol:"min",Name:"分钟"},{Symbol:"h",Name:"小时"},{Symbol:"day",Name:"日"},{Symbol:"week",Name:"周"},{Symbol:"month",Name:"月"},{Symbol:"year",Name:"年"},{Symbol:"mmHg",Name:"血压"},{Symbol:"mmol/L",Name:"血糖"},{Symbol:"pH",Name:"PH值"},{Symbol:"dS/m",Name:"土壤EC值"},{Symbol:"W/㎡",Name:"太阳总辐射"},{Symbol:"mm/hour",Name:"降雨量"},{Symbol:"N",Name:"牛"},{Symbol:"aw",Name:"饱和度"},{Symbol:"pixel",Name:"像素"},{Symbol:"Lux",Name:"照度"},{Symbol:"grav",Name:"重力加速度"},{Symbol:"dB",Name:"分贝"},{Symbol:"lm",Name:"流明"},{Symbol:"bit",Name:"比特"},{Symbol:"count",Name:"次"},{Symbol:"turn/m",Name:"转每分钟"},{Symbol:"GB",Name:"吉字节"},{Symbol:"MB",Name:"兆字节"},{Symbol:"KB",Name:"千字节"},{Symbol:"B",Name:"字节"},{Symbol:"%",Name:"百分比"},{Symbol:"g/L",Name:"克每升"},{Symbol:"g/m³",Name:"克每立方米"},{Symbol:"kg/m³",Name:"千克每立方米"},{Symbol:"F",Name:"法拉"},{Symbol:"Ω",Name:"欧姆"},{Symbol:"mA",Name:"毫安"},{Symbol:"A",Name:"安培"},{Symbol:"V",Name:"伏特"},{Symbol:"kV",Name:"千伏"},{Symbol:"Hz",Name:"赫兹"},{Symbol:"W",Name:"瓦特"},{Symbol:"Wh",Name:"瓦时"},{Symbol:"eV",Name:"电子伏"},{Symbol:"J",Name:"焦耳"},{Symbol:"kJ",Name:"千焦"},{Symbol:"hPa",Name:"百帕"},{Symbol:"kPa",Name:"千帕"},{Symbol:"cm³",Name:"立方厘米"},{Symbol:"m³",Name:"立方米"},{Symbol:"h㎡",Name:"公顷"},{Symbol:"c㎡",Name:"平方厘米"},{Symbol:"㎡",Name:"平方米"}],m=[{value:1,label:1},{value:10,label:10},{value:100,label:100},{value:1e3,label:1e3},{value:1e4,label:1e4}]}}]);