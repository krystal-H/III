(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"5jjE":function(e,t,n){},"7EV8":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("62KB"),n("av3G"),n("I9ul");var a=function(e,t,n,a,r){if(!Array.isArray(e))return 1;for(var c=e.map((function(e){return e[r]})),i=e.map((function(e){return e[t]})),o=c[0],l=[[o]],u=0,s=1;s<c.length;s++)c[s]===o?l[u].push(c[s]):(l[u+=1]=[],l[u].push(c[s]),o=c[s]);var d=[];l.forEach((function(e,t){d[t]=[],d[t]=i.splice(0,e.length)}));var f=[];d.forEach((function(e,t){var n=d[t][0],a=0;f[t]=[],f[t][a]=[],e.forEach((function(e,r){n===e?f[t][a].push(e):(a+=1,f[t][a]=[],f[t][a].push(e),n=e)}))}));var p=[];f.forEach((function(e){e.forEach((function(e){p.push(e)}))}));var m=[];p.forEach((function(e){for(var t=e.length,n=0;n<t;n++)m.push(0===n?t:0)}));var b={children:a,props:{}};return b.props.rowSpan=m[n],b}},Hg3J:function(e,t,n){},"OBs/":function(e,t,n){},aIR0:function(e,t,n){},aoTg:function(e,t,n){},gyoc:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Ze}));n("59iL");var a=n("f6Fh"),r=(n("J2lP"),n("DJj6"),n("ef1R"),n("Ra8s"),n("sfoS"),n("HsXu"),n("bs69"),n("Lm8M"),n("ryEf"),n("qgAm"),n("9b3Y"),n("Ck9u"),n("SmMv"),n("DTgQ")),c=(n("miF7"),n("QnTe")),i=n("T9Mk"),o=n.n(i),l=n("Nlzp"),u=n("DgvE"),s=n("S18n");n("5jjE");function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function p(e){var t=e.devceId,n=d(Object(i.useState)({}),2),a=n[0],f=n[1];Object(i.useEffect)((function(){t&&b()}),[t]);var p,m,b=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(l.c)(l.a.getDeviceInfo,{deviceId:t},{loading:e}).then((function(e){f(e.data)}))};return o.a.createElement("div",{id:"device-info"},o.a.createElement(c.b,{title:"设备信息"},o.a.createElement(c.b.Item,{label:"设备ID"},a.deviceUniqueId),o.a.createElement(c.b.Item,{label:"设备秘钥"},o.a.createElement("span",null,o.a.createElement(s.a,{label:a.deviceSecret,tip:"点击复制",copy:!0}))),o.a.createElement(c.b.Item,{label:"物理地址"},a.deviceMac),o.a.createElement(c.b.Item,{label:"入网时间"},a.connectTime&&u.a.utcToDev(a.connectTime)),o.a.createElement(c.b.Item,{label:"模组固件版本"},a.moduleVersion),o.a.createElement(c.b.Item,{label:"MCU固件版本"},a.pcbVersion),o.a.createElement(c.b.Item,{label:"绑定网关"},a.gateWay),o.a.createElement(c.b.Item,{label:"设备名称"},a.deviceName),o.a.createElement(c.b.Item,{label:"设备位置"},a.deviceSite),o.a.createElement(c.b.Item,{label:"绑定C端用户"},a.bindCUser),o.a.createElement(c.b.Item,{label:"SIM卡号"},a.simNumber),o.a.createElement(c.b.Item,{label:"IMEI"},a.deviceIdentifier)),o.a.createElement(r.a,null),o.a.createElement(c.b,{title:"产品信息"},o.a.createElement(c.b.Item,{label:"产品名称"},a.productName),o.a.createElement(c.b.Item,{label:"产品ID"},a.productId),o.a.createElement(c.b.Item,{label:"所属分类"},a.productType),o.a.createElement(c.b.Item,{label:"产品类型"},(p=a.productClass,m=null,"number"==typeof p&&(1==p?m="网关设备":2==p?m="子设备":3==p&&(m="普通设备")),m)),o.a.createElement(c.b.Item,{label:"产品编码"},a.productCode),o.a.createElement(c.b.Item,{label:"产品密钥"},o.a.createElement("span",null,o.a.createElement(s.a,{label:a.productKey,tip:"点击复制",copy:!0})))))}n("IHDg"),n("P37N"),n("vV4J"),n("av3G"),n("RfWx"),n("gAA8"),n("MNU5");var m=n("YeX6"),b=(n("QcZr"),n("b+L2")),y=(n("SiC7"),n("AePH")),v=(n("yIop"),n("jGbM")),g=(n("6IzV"),n("QFmM")),h=(n("UdMA"),n("ViyK")),O=(n("8OUX"),n("KCXd")),I=(n("62KB"),n("amE0"),n("FC04"));function E(e){var t=e.operate,n=e.visible,a=e.updateOkHandle,r=e.updateCancelHandle,c=null;switch(t){case 1:c={title:"发布云端定时功能",desc:"即将发布的功能",tip:"功能发布后，APP上可以看到并启用，是否确认发布？",needWarnIcon:!1};break;case 2:c={title:"删除标签",tip:"标签删除后将无法找回，是否确认删除？",needWarnIcon:!0};break;case 3:c={title:"下线云端定时功能",desc:"即将下线的功能",tip:"功能下线后将无法看到，是否确认下线？",needWarnIcon:!0}}return o.a.createElement(I.a,{visible:n,modalOKHandle:function(){return a(t)},modalCancelHandle:r,targetName:"test",title:c.title,descGray:!0,needWarnIcon:c.needWarnIcon,descText:c.desc,tipText:c.tip})}n("OBs/");var w=n("P2RN"),j=["editing","dataIndex","title","inputType","record","index","children"];function S(e,t,n,a,r,c,i){try{var o=e[c](i),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,r)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function T(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var P=function(e){var t=e.editing,n=e.dataIndex,a=e.title,r=e.inputType,c=(e.record,e.index,e.children),i=T(e,j),l="number"===r?o.a.createElement(O.a,null):o.a.createElement(h.a,{maxLength:50});return o.a.createElement("td",i,t?o.a.createElement(g.a.Item,{name:n,style:{margin:0,style:"100%"},rules:[{required:!0,message:"Please Input ".concat(a,"!")}]},l):c)};function D(e){var t=e.devceId,n=C(g.a.useForm(),1)[0],a=C(Object(i.useState)([]),2),r=a[0],c=a[1],u=C(Object(i.useState)(null),2),s=u[0],d=u[1],f=C(Object(i.useState)(""),2),p=f[0],h=f[1],O=C(Object(i.useState)(null),2),I=O[0],j=O[1],x=function(e){return e.id===p},A=C(Object(i.useState)(!1),2),N=A[0],T=A[1];Object(i.useEffect)((function(){t&&K()}),[t]);var D=function(e){n.setFieldsValue(k({name:"",age:""},e)),h(e.id)},R=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.deviceId=t,Object(l.c)(l.a.addDeviceLabel,e,{loading:n}).then((function(e){h(""),Object(w.a)({type:"success",description:"新增成功！"}),K()})).catch((function(e){h(""),K()}))},M=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.deviceId=t,Object(l.c)(l.a.updateDeviceLabel,e,{loading:n}).then((function(e){h(""),Object(w.a)({type:"success",description:"编辑成功！"}),K()})).catch((function(e){h(""),K()}))},J=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.validateFields();case 3:a=e.sent,t.id?(a.labelId=t.id,M(a)):R(a),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function i(e){S(c,a,r,i,o,"next",e)}function o(e){S(c,a,r,i,o,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),L=[{title:"标签Key",dataIndex:"labelKey",editable:!0},{title:"标签Value",dataIndex:"labelValue",editable:!0},{title:"操作",dataIndex:"operation",render:function(e,t){return x(t)?o.a.createElement("span",null,o.a.createElement("a",{onClick:function(){return J(t)},style:{marginRight:8}},"保存")):o.a.createElement(y.b,null,o.a.createElement(v.a.Link,{disabled:""!==p,onClick:function(){return D(t)}},"编辑"),o.a.createElement(v.a.Link,{disabled:""!==p,onClick:function(){var e,n;e=2,n=t.id,T(!0),j(n),d(e)}},"删除"))}}].map((function(e){return e.editable?k(k({},e),{},{onCell:function(t){return{record:t,inputType:"text",dataIndex:e.dataIndex,title:e.title,editing:x(t)}}}):e})),K=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(l.c)(l.a.getDeviceLabelList,{deviceId:t},{loading:e}).then((function(e){c(e.data.list)}))};return o.a.createElement("div",{id:"device-tag"},o.a.createElement(g.a,{form:n,component:!1},o.a.createElement(b.a,{components:{body:{cell:P}},dataSource:r,columns:L,rowClassName:"editable-row",rowKey:"id",pagination:!1})),o.a.createElement(m.a,{type:"primary",ghost:!0,className:"edit-table-btn",onClick:function(){!function(){var e=!1;if(p&&(e=!0),r.map((function(t){t.id||(e=!0)})),!e){var t=JSON.parse(JSON.stringify(r)),n={key:"".concat(t.length+1),labelKey:"",labelValue:"",id:0};t.push(n),c(t),D(n)}}()}},"添加标签"),N&&o.a.createElement(E,{visible:N,operate:s,updateOkHandle:function(){Object(l.c)(l.a.deleteDeviceLabel,{labelId:I}).then((function(e){T(!1),Object(w.a)({type:"success",description:"删除成功！"}),K()}))},updateCancelHandle:function(){T(!1)}}))}n("oENA");var R=n("uTCA"),M=(n("/Crn"),n("t7Rh"),n("TL2v")),J=(n("hEGT"),n("pckg"),n("yq+b")),L=n.n(J),K=n("7EV8"),U=(n("UTJx"),n("dVdO")),V=(n("xzjF"),n("PeP6")),F=(n("i6mW"),n("bmQt"));function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Q=V.a.Option,z=[{key:1,value:"最近1小时"},{key:2,value:"最近6小时"},{key:3,value:"最近24小时"}];function B(e){var t=e.ModalVisible,n=e.closeOk,a=e.sentData,r=e.baseInfo,c=H(Object(i.useState)(1),2),u=c[0],s=c[1];Object(i.useEffect)((function(){d()}),[]);var d=function(e){var t={column:a.funcIdentifier,productId:r.productId,tslType:a.funcType,deviceId:r.deviceId};e&&(t.selectType=e),Object(l.c)(l.a.deviceShadowHis,t).then((function(e){!function(e){var t=[],n=[];e.forEach((function(e){t.push(e.datatimestamp),n.push(e.data)}));var a,r=document.getElementById("echart-show"),c=F.init(r);(a={title:{},tooltip:{trigger:"axis"},legend:{label:{narmal:{show:!1}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{},xAxis:{type:"category",data:t},yAxis:{type:"value"},series:[{name:"Step Start",type:"line",step:"start",data:n}]})&&c.setOption(a)}(e.data)}))};return o.a.createElement("div",null,o.a.createElement(U.a,{title:"查看",visible:t,onOk:n,onCancel:n,width:"764px",wrapClassName:"add-protocols-wrap",footer:null},o.a.createElement("div",{className:"device-shadow-modal"},o.a.createElement("div",{className:"device-shadow-modal-header"},o.a.createElement(V.a,{style:{width:200},onChange:function(e){s(e),d(e)}},z.map((function(e){return o.a.createElement(Q,{value:e.key,key:e.key},e.value)}))),o.a.createElement("a",{onClick:function(){var e={column:a.funcIdentifier,productId:r.productId,tslType:a.funcType,selectType:u,deviceId:r.deviceId};Object(l.c)(l.a.exportShadowHis,e).then((function(e){window.open(e.data)}))}},"导出数据")),o.a.createElement("div",{style:{height:"303px"},id:"echart-show"}))))}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function G(e){var t=e.dataSource,n=(e.deviceId,e.baseInfo),a=W(Object(i.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),r=a[0],c=a[1],l=function(){var e=(r.pageIndex-1)*r.pageRows;return t.slice(e,e+10)},u=W(Object(i.useState)(!1),2),s=u[0],d=u[1],f=W(Object(i.useState)({}),2),p=f[0],m=f[1],y=[{title:"功能类型",dataIndex:"funcTypeCN",render:function(e,t,n){return Object(K.a)(l(),"funcIdentifier",n,e,"funcTypeCN")}},{title:"功能点名称",dataIndex:"funcName",render:function(e,t,n){return Object(K.a)(l(),"funcIdentifier",n,e,"funcName")}},{title:"标识符",dataIndex:"funcIdentifier",render:function(e,t,n){return Object(K.a)(l(),"funcIdentifier",n,e,"funcIdentifier")}},{title:"参数名称",dataIndex:"name"},{title:"参数标识",dataIndex:"identifier"},{title:"数据传输类型",dataIndex:"accessMode",render:function(e,t){return"rw"==e?"可下发可上报":"w"==e?"可下发":"r"==e?"可上报":""}},{title:"数据类型",dataIndex:"dataType",render:function(e,t){return o.a.createElement("span",null,t.dataTypCN)}},{title:"数据属性",dataIndex:"propertyMap",render:function(e,t){return o.a.createElement("span",null,function(e){var t=null;switch(e.dataTypeEN){case"float":case"int":t="数值范围：".concat(e.propertyMap.min,"-").concat(e.propertyMap.max,",间距：").concat(e.propertyMap.interval,",倍数：").concat(e.propertyMap.multiple,",单位：").concat(e.propertyMap.unit);break;case"bool":t="0：".concat(e.propertyMap[0],",1：").concat(e.propertyMap[1]);break;case"enum":var n="";for(var a in e.propertyMap)n+=a+"："+e.propertyMap[a]+", ";t="枚举值：".concat(n);break;default:return""}return t}(t))}},{title:"最新数据",dataIndex:"funcData"},{title:"操作",dataIndex:"dd",render:function(e,t){return o.a.createElement("a",{onClick:function(){m(t),d(!0)}},"查看")}}];return o.a.createElement("div",null,o.a.createElement(b.a,{rowKey:"key",columns:y,dataSource:t,pagination:{defaultCurrent:1,current:r.pageIndex,onChange:function(e,t){t===r.pageRows?c((function(n){var a=JSON.parse(JSON.stringify(n));return Object.assign(a,{pageIndex:e,pageRows:t})})):c((function(e){var n=JSON.parse(JSON.stringify(e));return Object.assign(n,{pageIndex:1,pageRows:t})}))},pageSize:r.pageRows,total:r.totalRows,showQuickJumper:!0,pageSizeOptions:[10],showTotal:function(){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,t.length)," 条")}}}),s&&o.a.createElement(B,{ModalVisible:s,closeOk:function(){d(!1)},sentData:p,baseInfo:n}))}var Y=n("/Zbm");function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=a.a.TabPane;function ae(e){var t=[];return e.forEach((function(e){e.funcParamList&&e.funcParamList.length&&e.funcParamList.forEach((function(n){var a=JSON.parse(JSON.stringify(e));t.push(ee(ee({},a),n))}))})),t.forEach((function(e,t){e.key=t})),t}function re(e){var t=e.baseInfo,n=e.devceId,r=X(Object(i.useState)([]),2),c=r[0],u=r[1],s=X(Object(i.useState)(""),2),d=s[0],f=s[1],p=X(Object(i.useState)("a"),2),m=p[0],b=p[1],y=X(Object(i.useState)([]),2),v=y[0],g=y[1];Object(i.useEffect)((function(){n&&h()}),[n]);var h=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(l.c)(l.a.deviceShadow,{deviceUniqueId:t.deviceUniqueId},{loading:e}).then((function(e){u(e.data);var t=e.data.find((function(e){return"properties"==e.tslType}));t&&(t=ae(t.list)),g(t||[]);for(var n={},a=function(){var t=c[r],a=e.data.find((function(e){return t===e.tslType}));a&&(n[t]=a.jsonString||{})},r=0,c=["properties","events","services"];r<c.length;r++)a();f(JSON.stringify(n))}))};return o.a.createElement("div",{id:"device-shadow"},o.a.createElement(M.a,{style:{marginBottom:8,width:"100%",display:"flex"},desc:["设备影子是设备最新状态在平台的缓存信息，您可以在平台实时查询设备的运行和状态信息，也可以通过API获取设备状态信息。详细说明可参考",o.a.createElement("a",{onClick:function(){window.open("https://cms.clife.cn/clifeIotDoc/")}},"帮助文档")]}),o.a.createElement(a.a,{defaultActiveKey:"1",className:"shadow-tab"},o.a.createElement(ne,{key:"1",tab:"表单模式"},o.a.createElement("div",null,o.a.createElement(R.a.Group,{value:m,size:"middle",onChange:function(e){var t;"a"===(e=e.target.value)?t="properties":"b"===e?t="events":"c"===e&&(t="services");var n=c.find((function(e){return e.tslType==t}));n&&(n=ae(n.list)),g(n||[]),b(e)},style:{margin:"6px 0  22px 0"}},o.a.createElement(R.a.Button,{value:"a"},"属性"),o.a.createElement(R.a.Button,{value:"b"},"事件"),o.a.createElement(R.a.Button,{value:"c"},"服务")),o.a.createElement(G,{dataSource:v,deviceId:n,baseInfo:t}))),o.a.createElement(ne,{key:"2",tab:"Json模式"},o.a.createElement("div",null,o.a.createElement(Y.a,{code:d})))))}n("2ek4");var ce=n("oWtQ"),ie=n("wmP4"),oe=n.n(ie),le=n("wZVF");n("Hg3J");function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var me=h.a.TextArea;function be(e,t){var n=[];return e.forEach((function(e){e.funcParamList&&e.funcParamList.length&&e.funcParamList.forEach((function(t){var a=JSON.parse(JSON.stringify(e));n.push(fe(fe({},a),t))}))})),n.forEach((function(e,n){e.key=n,e.sendData="",e.isCheck=!1,t&&t.forEach((function(t){t.funcIdentifier===e.funcIdentifier&&(e.isCheck=!0,("properties"===e.funcType||e.identifier===t.identifier)&&(e.sendData=t.sendData))}))})),n}function ye(e){var t=e.addVisible,n=e.addOk,a=e.CancelAdd,r=e.deviceId,c=e.baseInfo,u=e.actionType,s=e.actionData,d=ue(Object(i.useState)([]),2),f=d[0],p=d[1],m=ue(Object(i.useState)({}),2),b=m[0],y=m[1],v=ue(g.a.useForm(),1)[0],O=Object(i.useRef)(null);Object(i.useEffect)((function(){"add"!==u?I():E()}),[]);var I=function(){var e=c.productId,t=[Object(l.c)(l.a.standardFnList,{productId:e}),Object(l.c)(l.a.singelDeviceRemoset,{taskId:s.taskId})];Promise.all(t).then((function(e){v.setFieldsValue({taskName:e[1].data.taskName,taskExplain:e[1].data.taskExplain}),y(e[1].data);var t=e[0].data.standard.concat(e[0].data.custom);t=be(t=t.filter((function(e){return"服务"===e.funcTypeCN||"属性"===e.funcTypeCN&&"r"!==e.funcParamList[0].accessMode?e:void 0})),JSON.parse(e[1].data.remoteProtocol.protocolJson)),"detail"===u&&(t=t.filter((function(e){if(e.isCheck)return e}))),p(t)}))},E=function(){var e=c.productId;Object(l.c)(l.a.standardFnList,{productId:e}).then((function(e){var t=e.data.standard.concat(e.data.custom);t=be(t=t.filter((function(e){return"服务"===e.funcTypeCN||"属性"===e.funcTypeCN&&"r"!==e.funcParamList[0].accessMode?e:void 0}))),p(t)}))};return o.a.createElement("div",null,o.a.createElement(U.a,{maskClosable:!1,title:"远程配置任务",visible:t,onOk:function(){"detail"!==u?O.current.subOrder():a()},onCancel:a,width:"1300px",wrapClassName:"device-remote-config-modal"},o.a.createElement("div",null,o.a.createElement(g.a,{form:v},o.a.createElement(g.a.Item,{label:"任务名称",name:"taskName",rules:[{required:!0}]},"detail"===u?o.a.createElement("span",null,b.taskName):o.a.createElement(h.a,{style:{width:"300px"},maxLength:20})),o.a.createElement(g.a.Item,{label:"任务说明",name:"taskExplain",rules:[{required:!0}]},"detail"===u?o.a.createElement("span",null,b.taskExplain):o.a.createElement(me,{rows:4,maxLength:100,showCount:!0}))),o.a.createElement("div",{style:{marginBottom:"10px"}},"detail"===u?"配置数据":"请添加配置信息"," "),o.a.createElement(le.a,{dataSource:f,ref:O,finishSub:function(e){v.validateFields().then((function(t){var a={taskName:t.taskName,deviceId:r,taskExplain:t.taskExplain,protocolJson:JSON.stringify(e)};"edit"===u&&(a.taskId=s.taskId),Object(l.c)(l.a.saveDeviceRemoset,a,{loading:!0}).then((function(e){Object(w.a)({type:"success",description:"操作成功"}),n()}))}))},actionType:u}))))}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ee=ce.a.Step,we=["草稿","待执行","执行成功","执行失败"];var je=function(e){var t=e.devceId,n=e.baseInfo,a=Oe(Object(i.useState)(!1),2),c=a[0],s=a[1],d=Oe(Object(i.useState)({}),2),f=d[0],p=d[1],y=Oe(Object(i.useState)({deletevisible:!1,deleteItem:null,deleteLoading:!1}),2),v=y[0],g=y[1],h=Oe(Object(i.useState)([]),2),O=h[0],E=h[1],j=Oe(Object(i.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),S=j[0],x=j[1],k=Oe(Object(i.useState)("add"),2),A=k[0],C=k[1],N=v.deletevisible,T=v.deleteItem,P=v.deleteLoading,D=[{title:"任务ID",dataIndex:"taskId",key:"taskId"},{title:"任务名称",dataIndex:"taskName",key:"taskName"},{title:"任务说明",dataIndex:"taskExplain",key:"taskExplain",render:function(e,t){return o.a.createElement("div",{className:"single-text",style:{width:400}},e)}},{title:"任务状态",dataIndex:"status",key:"status",render:function(e,t){var n=t.status;return o.a.createElement("span",{className:"device-h5-statu-".concat(n+1)},we[n])}},{title:"执行时间",dataIndex:"execTime",key:"execTime",render:function(e,t){var n=t.execTime;return o.a.createElement("span",null,n?u.a.utcToDev(n):"--")}},{title:"操作",key:"action",render:function(e,t){var n=t.status;t.taskId;return""+n=="1"?o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{onClick:function(){return L(t)}},"编辑"),o.a.createElement(r.a,{type:"vertical"}),o.a.createElement("a",{onClick:function(){return function(e){Object(l.c)(l.a.excelDevTask,{taskId:e.taskId},{loading:!0}).then((function(e){J(),Object(w.a)({description:"执行成功！",type:"success"})})).catch((function(e){J()}))}(t)}},"执行"),o.a.createElement(r.a,{type:"vertical"}),o.a.createElement("a",{onClick:function(){return g({deletevisible:!0,deleteItem:t})}},"删除")):o.a.createElement("a",{onClick:function(){return R(t)}},"查看")}}],R=function(e){p(e),C("detail"),s(!0)};Object(i.useEffect)((function(){t&&J()}),[S.pageRows,S.pageIndex,t]);var J=function(e){var n=ge({deviceId:t},S);Object(l.c)(l.a.deviceRemoteConfigList,n,{loading:!0}).then((function(e){var t=e.data.list,n=void 0===t?[]:t;E(Object(u.b)(n)),x((function(t){var n=JSON.parse(JSON.stringify(t));return Object.assign(n,{totalRows:e.data.pager.totalRows})}))}))},L=function(e){p(e),C("edit"),s(!0)};return o.a.createElement("div",{id:"device-remote-config"},o.a.createElement("div",{className:"comm-shadowbox setp-tip"},o.a.createElement("div",{className:"step-title"},o.a.createElement("img",{src:oe.a,alt:""}),o.a.createElement("span",null,"远程配置步骤")),o.a.createElement(M.a,{style:{marginBottom:18,width:"100%",display:"flex",alignItems:"center"},desc:[o.a.createElement("div",null,"平台支持远程更新设备的配置数据，您可以提交远程配置任务，实时对设备的系统参数等数据进行远程更新，并且获取设备配置的更新状态。详细说明可参考",o.a.createElement("a",{onClick:function(){window.open("https://cms.clife.cn/clifeIotDoc/")}},"帮助文档"))]}),o.a.createElement(ce.a,{current:-1,initial:0},o.a.createElement(Ee,{title:"创建远程配置任务",description:"创建远程配置任务，填写任务的目的或备注信息。"}),o.a.createElement(Ee,{title:"添加配置数据",description:"添加要更新的产品配置数据字段和更新的数值。"}),o.a.createElement(Ee,{title:"执行任务",description:"提交执行远程配置任务，设备更新结果实时可见。"}))),o.a.createElement("div",{className:"comm-shadowbox device-content"},o.a.createElement("div",{className:"content-top"},o.a.createElement("div",null," "),o.a.createElement(m.a,{type:"primary",onClick:function(){return C("add"),void s(!0)}},"创建任务")),o.a.createElement(b.a,{columns:D,className:"ant-table-fixed",rowKey:"taskId",dataSource:O,pagination:{defaultCurrent:1,current:S.pageIndex,onChange:function(e,t){t===S.pageRows?x((function(n){var a=JSON.parse(JSON.stringify(n));return Object.assign(a,{pageIndex:e,pageRows:t})})):x((function(e){var n=JSON.parse(JSON.stringify(e));return Object.assign(n,{pageIndex:1,pageRows:t})}))},pageSize:S.pageRows,total:S.totalRows,showQuickJumper:!0,pageSizeOptions:[10],showTotal:function(){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,S.totalRows)," 条")}}})),N&&o.a.createElement(I.a,{visible:N,modalOKHandle:function(){var e=T.taskId;Object(l.c)(l.a.delDeviceRemoset,{taskId:e}).then((function(e){Object(w.a)({type:"success",description:"删除成功！"}),g({deletevisible:!1,deleteItem:null,deleteLoading:!1}),J()}))},modalCancelHandle:function(){return g({deletevisible:!1,deleteItem:null,deleteLoading:!1})},targetName:T.taskName,confirmLoading:P,title:"删除任务",needWarnIcon:!0,descText:"即将删除的任务",tipText:"任务的所有信息将完全被删除，无法找回，请谨慎操作"}),c&&o.a.createElement(ye,{addVisible:c,actionData:f,addOk:function(){J(),s(!1)},CancelAdd:function(){s(!1)},deviceId:t,baseInfo:n,actionType:A}))};function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ne(e){var t=e.deviceId,n=Ae(Object(i.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),a=n[0],r=n[1],c=Ae(Object(i.useState)([]),2),u=c[0],s=c[1];Object(i.useEffect)((function(){f()}),[a.pageRows,a.pageIndex]);var d=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"物理地址",dataIndex:"deviceMac",key:"deviceMac"},{title:"产品名称",dataIndex:"productName",key:"productName"},{title:"分类",dataIndex:"productType",key:"productType"},{title:"在线状态",dataIndex:"onlineStatus",key:"onlineStatus",render:function(e){return o.a.createElement("span",null,1==e?"在线":"离线")}}],f=function(){var e=xe(xe({},a),{},{deviceId:t});Object(l.c)(l.a.gatewayList,e,{loading:!0}).then((function(e){s(e.data.list),r((function(t){var n=JSON.parse(JSON.stringify(t));return Object.assign(n,{totalRows:e.data.pager.totalRows})}))}))};return o.a.createElement("div",null,o.a.createElement(b.a,{rowKey:"deviceId",dataSource:u,columns:d,pagination:{defaultCurrent:1,current:a.pageIndex,onChange:function(e,t){t===a.pageRows?r((function(n){var a=JSON.parse(JSON.stringify(n));return Object.assign(a,{pageIndex:e,pageRows:t})})):r((function(e){var n=JSON.parse(JSON.stringify(e));return Object.assign(n,{pageIndex:1,pageRows:t})}))},pageSize:a.pageRows,total:a.totalRows,showQuickJumper:!0,pageSizeOptions:[10],showTotal:function(){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,a.totalRows)," 条")}}}))}n("W0kV");var Te=n("caRq"),Pe=n("CvKH"),De=n.n(Pe),Re=n("q5+0"),Me=n("6Tta"),Je=n.n(Me);function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Fe=Te.a.RangePicker,He={1:"初始化",2:"运行中",3:"运行成功",4:"运行失败",5:"创建作业失败"};var qe=function(e){var t=e.baseInfo,n=(e.devceId,Object(Re.g)(),Ue(g.a.useForm(),1)[0]),a=Ue(Object(i.useState)(""),2),r=a[0],c=(a[1],Ue(Object(i.useState)([]),2)),s=c[0],d=c[1],f=Ue(Object(i.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),p=f[0],y=f[1],v=[{title:"序号",dataIndex:"id",key:"id",width:80},{title:"名称",dataIndex:"name",key:"name",width:300},{title:"参数",dataIndex:"params",key:"params",width:"28%"},{title:"状态",dataIndex:"status",key:"status",width:120,render:function(e){return o.a.createElement("span",null,He[e])}},{title:"日志",dataIndex:"msg",key:"msg",width:"25%"},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:220,render:function(e){return e&&u.a.utcToDev(e)}},{title:"操作",key:"action",width:80,render:function(e,t){return o.a.createElement("div",{className:"operation"},o.a.createElement("a",{onClick:function(){return h(t.result)}},"下载"))}}],h=function(e){if(!e)return Object(w.a)({type:"warn",message:"暂无数据"});window.open(e)},O=function(){Object(l.c)(l.a.downDeviceDataList,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({origin:"open"},p),{loading:!0}).then((function(e){d(e.data.list),y((function(t){var n=De()(t);return n.totalRows=e.data.pager.totalRows,n}))}))};return Object(i.useEffect)((function(){O()}),[p.pageIndex,p.pageRows,r]),o.a.createElement("div",{id:"project-mgt"},o.a.createElement("div",{className:"page-header",style:{marginBottom:20,paddingLeft:5}},o.a.createElement(g.a,{className:"device-filter-form",form:n,layout:"inline"},o.a.createElement(g.a.Item,{name:"times",label:"时间"},o.a.createElement(Fe,{showTime:!0,allowClear:!0,disabledDate:function(e){var t=Je()().format("YYYY-MM-DD");return e&&(e<Je()(t).subtract(7,"day")||e>=Je()(t).subtract(-1,"day").second(1))}})),o.a.createElement(g.a.Item,{label:" ",colon:!1,style:{marginRight:"2px"}},o.a.createElement(m.a,{type:"primary",onClick:function(){var e=n.getFieldsValue().times;if(!e)return Object(w.a)({type:"warn",message:"请输入查询条件"});var a={};e&&e.length&&(a.startTime=L()(e[0]).valueOf(),a.endTime=L()(e[1]).valueOf());var r={macStrs:t.deviceMac,productId:t.productId,originEnum:"open",startTime:a.startTime,endTime:a.endTime};Object(l.c)(l.a.createExport,r).then((function(e){0===e.code&&O()}))}},"查询")),o.a.createElement(g.a.Item,{label:" ",colon:!1,style:{marginRight:"0px"}},o.a.createElement(m.a,{onClick:function(){n.resetFields()}},"重置")))),o.a.createElement("div",{className:"pd22"},o.a.createElement(b.a,{columns:v,className:"ant-table-fixed",rowKey:"id",dataSource:s,pagination:{defaultCurrent:1,current:p.pageIndex,pageSize:p.pageRows,total:p.totalRows,showSizeChanger:!1,showQuickJumper:p.totalPages>5,onChange:function(e,t){y((function(n){return Object.assign(De()(n),{pageIndex:t===p.pageRows?e:1,pageRows:t})}))},showTotal:function(e){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,e)," 条")}}})))},Qe=n("MeRu");n("aIR0");function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var We=a.a.TabPane;function Ze(e){var t=e.match,n=Object(Re.g)(),r=Object(i.useMemo)((function(){return Object(u.h)("step")||"1"}),[]),c=t.params.id,s=ze(Object(i.useState)({}),2),d=s[0],f=s[1];return Object(i.useEffect)((function(){var e={infoType:"1",field:c,pageIndex:1,pageRows:1};Object(l.c)(l.a.getDeviceList,e).then((function(e){f(e.data.list[0])}))}),[c]),o.a.createElement("div",{id:"device-detail"},o.a.createElement(Qe.a,{backTitle:"设备详情",backHandle:function(){n.push("/open/device/devManage/list")}},o.a.createElement("div",{className:"device-top"},o.a.createElement("div",{className:"device-top-item"},o.a.createElement("label",{className:"device-label"},"设备ID："),o.a.createElement("span",{className:"device-text"},d.deviceUniqueId),o.a.createElement("span",{className:"device-status"},1==d.onlineStatus?"在线":"离线")),o.a.createElement("div",{className:"device-top-item"},o.a.createElement("label",{className:"device-label"},"物理地址："),o.a.createElement("span",{className:"device-text"}),d.deviceMac),o.a.createElement("div",{className:"device-top-item"},o.a.createElement("label",{className:"device-label"},"产品名称："),o.a.createElement("span",{className:"device-text"},d.productName)),o.a.createElement("div",{className:"device-top-item"},o.a.createElement("label",{className:"device-label"},"所属分类："),o.a.createElement("span",{className:"device-text"},d.productType)))),o.a.createElement("div",{className:"comm-shadowbox common-tab device-content"},o.a.createElement(a.a,{defaultActiveKey:r,onChange:function(e){n.push(t.url+"?"+"step=".concat(e))}},o.a.createElement(We,{key:"1",tab:"基本信息"},o.a.createElement(p,{devceId:d.deviceId})),o.a.createElement(We,{key:"2",tab:"设备标签"},o.a.createElement(D,{devceId:d.deviceId})),o.a.createElement(We,{key:"3",tab:"设备影子"},o.a.createElement(re,{devceId:d.deviceId,baseInfo:d})),o.a.createElement(We,{key:"6",tab:"数据下载"},o.a.createElement(qe,{devceId:d.deviceId,baseInfo:d})),o.a.createElement(We,{key:"4",tab:"远程配置"},o.a.createElement(je,{devceId:d.deviceId,baseInfo:d})),1===d.productClass&&o.a.createElement(We,{key:"5",tab:"子设备列表"},o.a.createElement(Ne,{deviceId:d.deviceId,baseInfo:d})))))}},i6mW:function(e,t,n){},t7Rh:function(e,t,n){},wZVF:function(e,t,n){"use strict";n("ef1R"),n("Ra8s"),n("sfoS"),n("HsXu"),n("bs69"),n("Lm8M"),n("ryEf"),n("qgAm"),n("9b3Y"),n("Ck9u"),n("QcZr");var a=n("b+L2"),r=(n("UdMA"),n("ViyK")),c=(n("8OUX"),n("KCXd")),i=(n("DBxd"),n("sQtw")),o=(n("xzjF"),n("PeP6")),l=n("CvKH"),u=n.n(l),s=(n("pckg"),n("av3G"),n("P37N"),n("IHDg"),n("62KB"),n("4dS9"),n("T9Mk")),d=n.n(s),f=n("7EV8"),p=n("P2RN");n("aoTg");function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,c=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(c.push(a.value),!t||c.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var y=o.a.Option;function v(e,t){var n=e.dataSource,l=e.finishSub,b=e.actionType,v=m(Object(s.useState)([]),2),g=v[0],h=v[1],O=m(Object(s.useState)([]),2),I=O[0],E=O[1];Object(s.useEffect)((function(){E(u()(n));var e=[];n.forEach((function(t){if(t.isCheck)return-1===e.indexOf(t.funcIdentifier)&&e.push(t.funcIdentifier),t})),h(e)}),[n.length]);var w=function(e,t){var n=u()(I);n[t].sendData=e,E(n)},j=[{title:"勾选",width:"50px",dataIndex:"isCheck",fixed:"left",render:function(e,t,a){var r=Object(f.a)(n,"funcIdentifier",a,t.funcIdentifier,"funcIdentifier");return r.children=d.a.createElement(i.a,{checked:e,onChange:function(e){!function(e,t,n){var a=e.target.checked,r=u()(I);r[n].isCheck=a,E(r),h((function(e){var n=u()(e);return a?n.push(t.funcIdentifier):n=n.filter((function(e){if(e!==t.funcIdentifier)return e})),console.log(n,"勾选"),n}))}(e,t,a)},disabled:"detail"===b}),r}},{title:"功能类型",dataIndex:"funcTypeCN",width:"4%",render:function(e,t,a){return Object(f.a)(n,"funcIdentifier",a,e,"funcTypeCN")}},{title:"功能点名称",dataIndex:"funcName",width:"10%",render:function(e,t,a){return Object(f.a)(n,"funcIdentifier",a,e,"funcName")}},{title:"标识符",dataIndex:"funcIdentifier",width:"10%",render:function(e,t,a){return Object(f.a)(n,"funcIdentifier",a,e,"funcIdentifier")}},{title:"参数名称",dataIndex:"name",width:"12%"},{title:"参数标识",dataIndex:"identifier",width:"10%"},{title:"数据类型",width:"8%",dataIndex:"dataType",render:function(e,t){return d.a.createElement("span",null,t.dataTypCN)}},{title:"数据属性",dataIndex:"propertyMap",render:function(e,t){return d.a.createElement("span",null,function(e){var t=null;switch(e.dataTypeEN){case"float":case"int":t="数值范围：".concat(e.propertyMap.min,"-").concat(e.propertyMap.max,",间距：").concat(e.propertyMap.interval,",倍数：").concat(e.propertyMap.multiple,",单位：").concat(e.propertyMap.unit);break;case"bool":t="0：".concat(e.propertyMap[0],",1：").concat(e.propertyMap[1]);break;case"enum":var n="";for(var a in e.propertyMap)n+=a+"："+e.propertyMap[a]+", ";t="枚举值：".concat(n);break;default:return""}return t}(t))}},{title:"下发数据",dataIndex:"sendData",key:"sendData",fixed:"right",render:function(e,t,n){var a=t.dataTypeEN,i=t.propertyMap,l=null;if("detail"===b)return"bool"===a||"enum"===a?i[e]:e;switch(a){case"int":case"double":case"float":l=d.a.createElement(c.a,{value:t.sendData,min:i.min,max:i.max,onChange:function(e){return w(e,n)},placeholder:"请输入参数"});break;case"text":l=d.a.createElement(r.a,{value:t.sendData,allowClear:!0,maxLength:30,onChange:function(e){return w(e,n)},placeholder:"请输入参数"});break;case"enum":case"bool":l=d.a.createElement(o.a,{onChange:function(e){return w(e,n)},allowClear:!0,value:t.sendData},Object.keys(i)&&Object.keys(i).map((function(e,t){return d.a.createElement(y,{key:t+e,value:Number(e)},i[e])})))}return d.a.createElement("span",null,l)}}];return Object(s.useImperativeHandle)(t,(function(){return{subOrder:function(){var e,t;e=[],t=I.filter((function(t){var n=!0;if(t.sendData||0===t.sendData||(n=!1),0!==t&&g.indexOf(t.funcIdentifier)>-1&&n)return-1===e.indexOf(t.funcIdentifier)&&e.push(t.funcIdentifier),t})),e.length?e.length===g.length?(t=t.map((function(e){return{identifier:"properties"===e.funcType?e.funcIdentifier:e.identifier,sendData:e.sendData,funcIdentifier:e.funcIdentifier}})),l(t)):Object(p.a)({description:"部分勾选数据未配置"}):Object(p.a)({description:"请为配置协议添加参数"})}}}),[g,I]),d.a.createElement("div",null,d.a.createElement(a.a,{rowKey:"key",columns:j,className:"config-data-table",dataSource:I,locale:{emptyText:"暂无协议，请先去配置"},pagination:!1,scroll:{y:440,x:1e3}}))}t.a=Object(s.forwardRef)(v)},wmP4:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABsklEQVQokWWRvW4TQRSFv5nMLE4U8IJEEaFFUUJhCQpA4idNKFJQUiU0eYM8QOqUCCSQeAXShJISCQch4QYqQEHhV3LjmCoKyEnsvZdixrtr+xazO3N3vnPuWfP2c2dPoYEqqqBhQeMehucCwz78vH97fhHAqdIoLkHlcgRU9qGtqOoCsVzRjAAVjapaKI4ARIlSJaC0L1WVEUjhhGKMccCk7XJ+ZTKbIUCqI4zaRpVTgVY3Ze9wlt7AceFMn8a5I1Z3dPrlmumZ1x/bClrOVgH0BbZ/zNE5rpFY8AZ8fCZTtPoJK05VylmJTiS8v++mHBzXSAxs3IEshSe7YBS8YWkmZ9OGVKKqKCLKEPr18CzewMZd+NKBm5fg+lzpwhvWgwMpE64G1csd3sLlFB5cDaFldfh2ECCJJXMKzxQWwGCQmHr4eNbJ8kCm0se7QTmrw8MbkOfw4Td4S9swVs3mr9o/398W1bz15+Kt73/Pz1fDu7cIy1fg+Rtwlq0JwKt3+59U5JqiDMTQ7GYcDWZG/4AFZ2md5KxMAMZrdUen6zmb3rCeWDJvaTvDi5OcR0/XTO8/FFxXqP9J8G8AAAAASUVORK5CYII="}}]);