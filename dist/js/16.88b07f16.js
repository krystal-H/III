(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{GWga:function(e,t,n){},MC1R:function(e,t,n){},N6wN:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return qe}));n("4mDm"),n("07d7"),n("5s+n"),n("PKPk"),n("3bBZ"),n("rB9j"),n("Rm1S");var a=n("q1tI"),r=n.n(a),o=n("55Ip"),c=n("MKeS"),i=(n("NBAS"),n("SuFq"),n("tkto"),n("pNMO"),n("TeQF"),n("5DmW"),n("FZtP"),n("27RR"),n("4Brf"),n("0oug"),n("YQTV"),n("NUBc")),l=(n("mbEz"),n("wCAj")),u=(n("L/Qf"),n("2/Rp")),s=(n("1vPl"),n("5rEg")),d=(n("TfFZ"),n("3S7+")),p=(n("8QGh"),n("2fM7")),f=(n("SYor"),n("ma9I"),n("UxlC"),n("/MKj")),m=n("zsHu"),y=n("Nlzp"),v=n("+IdD"),g=n("cu44"),h=n("MeRu"),b=(n("+2oP"),n("pjDv"),n("x0AG"),n("pDQq"),n("p532"),n("oVuX"),n("2B1R"),n("sMBO"),n("l+S1"));function E(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return o}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var S,P=p.a.Option,C=["按产品","按分组"],x=function(e){var t=e.list,n=e.searchedData,o=e.multiple,c=void 0!==o&&o,i=e.onRef,l=e.inputkey,d=O(Object(a.useState)(0),2),f=d[0],m=d[1],y=O(Object(a.useState)([-1]),2),v=y[0],g=y[1],h=O(Object(a.useState)(""),2),I=h[0],w=h[1],S=O(Object(a.useState)(!1),2),x=S[0],j=S[1],D=O(Object(a.useState)(!1),2),L=D[0],R=D[1];Object(a.useEffect)((function(){i&&i(N)}));var k=function(e,t){var n=e.findIndex((function(e){return t==e})),a=E(e);return n>-1&&a.splice(n,1),a},N=function(){var e={type:f};return I&&(e[l]=I),v.length>0&&-1!==v[0]&&(e.productIds=v.join(",")),e};return r.a.createElement("div",{className:"comm-search-box"},r.a.createElement(s.a.Group,{compact:!0,className:"inputgroup"},r.a.createElement(p.a,{value:f,onChange:function(e){m(e),g([-1])}},C.map((function(e,t){return r.a.createElement(P,{key:t,value:t},e)}))),r.a.createElement(p.a,{showSearch:!0,optionFilterProp:"children",mode:c?"multiple":"",defaultValue:[-1],value:v,onChange:!c&&function(e){g([e])}||void 0,onSelect:c&&function(e){g(-1==e?[-1]:function(t){var n=k(t,-1);return[].concat(E(n),[e])})}||void 0,onDeselect:c&&function(e){g((function(t){return k(t,e)}))}||void 0,style:{width:250}},r.a.createElement(P,{value:-1},"全部".concat(0==f?"产品":"分组")),t[f].map((function(e,t){var n=e.productId,a=e.id,o=e.name,c=e.productName;return r.a.createElement(P,{key:t,value:[n,a][f]},[c,o][f])}))),l&&r.a.createElement(s.a,{value:I,maxLength:30,placeholder:"请输入设备ID查询",style:{width:200},onChange:function(e){w(e.target.value)}})),r.a.createElement(u.a,{type:"primary",className:"btn",onClick:function(){j(!0),n(N()).finally((function(e){console.log("---rrr--",e),j(!1)}))},loading:x,icon:r.a.createElement(b.a,null)},"查询"),r.a.createElement(u.a,{type:"default",className:"btn",loading:L,onClick:function(){m(0),g([-1]),w(""),R(!0),n({}).finally((function(){R(!1)}))}},"重置"))},j=n("P2RN");function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=K(e);if(t){var r=K(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return A(this,n)}}function A(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=p.a.Option,F={1:void 0,2:!0,3:!1},V=Object(f.connect)((function(e){return{productList:e.getIn(["device","productList"]).toJS(),deviceStat:e.getIn(["device","deviceStat"]).toJS(),deviceList:e.getIn(["device","deviceList"]).toJS(),freshStatu:e.getIn(["device","freshStatu"])}}),(function(e){return{getProductList:function(t){return e(Object(v.f)(t))},getDeviceStat:function(t){return e(Object(v.d)(t))},getDeviceList:function(t){return e(Object(v.c)(t))}}}))(S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(f,e);var t,n,a,c=_(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=c.call(this,e)).getProductList=function(){t.props.getProductList({pageIndex:1,pageRows:9999})},t.getGroupList=function(){Object(y.b)(y.a.getGroupList,{pageIndex:1,pageRows:9999}).then((function(e){t.setState({groupList:e.data&&e.data.list||[]})}))},t.getCountDataParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"classType",n=t.state.countDataParams,a=n.classType,r=n.productId,o=n.subgroupId,c=k({},e,a);return 1==a?c.productId=r:2==a&&(c.subgroupId=o),c},t.getListParams=function(){var e=R({},t.state.listParams),n=e.innet,a=e.online;return e.innet=F[n],e.online=F[a],e},t.getDeviceStat=function(){return t.props.getDeviceStat(t.getCountDataParams("type"))},t.getDeviceList=function(){var e=t.getCountDataParams("classType"),n=t.getListParams();return t.props.getDeviceList(R(R({},e),n))},t.onChangeListParams=function(e,n){console.log(e,n);var a=R({},t.state.listParams);a[e]=n.trim&&n.trim()||n||void 0,t.setState({listParams:a})},t.inquireDeviceList=function(){var e=R({},t.state.listParams);e.pageIndex=1,t.setState({listParams:e},t.getDeviceList)},t.searchedData=function(e){var n=e.type,a=void 0===n?0:n,r=e.productIds;return console.log(99,e),t.setState({countDataParams:{classType:++a,productId:r,subgroupId:r}},(function(){t.getDeviceList(),t.getDeviceStat()})),Promise.resolve(1)},t.changePage=function(e){var n=R({},t.state.listParams);n.pageIndex=e,t.setState({listParams:n},t.getDeviceList)},t.resetSearch=function(){t.setState({listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},t.getDeviceList)},t.exportData=function(){var e=R(R({superInstanceId:localStorage.getItem("superInstanceId")},t.getCountDataParams()),t.getListParams()),n="?";for(var a in e)void 0!==e[a]&&(n+="".concat(a,"=").concat(e[a],"&"));var r=window.location.origin+y.a.exportDeviceList+n.replace(/&$/,"");try{window.open(r)}catch(e){Object(j.a)({description:e,type:"error"})}},t.state={groupList:[],countDataParams:{classType:1,productId:void 0,subgroupId:void 0},listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},t}return t=f,(n=[{key:"componentDidMount",value:function(){this.getProductList(),this.getGroupList(),this.getDeviceStat(),this.getDeviceList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.listParams,a=t.groupList,c=this.props,f=c.productList,y=c.deviceStat,v=c.deviceList,b=c.freshStatu,E=v.pager,O=void 0===E?{}:E,I=v.list,w=void 0===I?[]:I,S=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"物理地址",dataIndex:"deviceMac",key:"deviceMac"},{title:"产品",dataIndex:"productName",key:"productName"},{title:"分类",dataIndex:"productType",key:"productType"},{title:"所属分组",dataIndex:"groupName",key:"groupName"},{title:"类型",dataIndex:"productClass",key:"productClass",render:function(e){return{0:"普通设备",1:"网关设备"}[e]||"--"}},{title:"操作",key:"opt_detail",render:function(e,t){return r.a.createElement("span",null,r.a.createElement(o.Link,{key:"detail",to:"/open/base/device/onlineDevice/details/"+t.deviceId},"查看"))}}],P=y.exception,C=y.total,j=y.totalActive,D=y.todayActive,L=n.pageIndex,R=n.pageRows,k=n.infoType,N=n.field,T=n.labelKey,_=n.labelValue,A=n.innet,K=n.online;return r.a.createElement("section",{className:"page-main-wrapper flex-column devicelistpage"},r.a.createElement(h.a,{noback:!0,title:"设备管理"}),r.a.createElement("header",{className:"page-content-header"},r.a.createElement(x,{list:[f,a],searchedData:this.searchedData}),r.a.createElement("div",{className:"count-data-box"},r.a.createElement("ul",{className:"device-inine-data"},r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("span",{className:"icon-cube"}),"当前异常数"),r.a.createElement("span",{className:"count"},P||0)),r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("span",{className:"icon-cube"}),"累计设备总数"),r.a.createElement("span",{className:"count"},C||0)),r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("span",{className:"icon-cube"}),"累计入网总数"),r.a.createElement("span",{className:"count"},j||0)),r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("span",{className:"icon-cube"}),"今日入网总数"),r.a.createElement("span",{className:"count"},D||0))),r.a.createElement("div",{className:"device-refresh",onClick:this.getDeviceStat},r.a.createElement("span",null,"刷新"),r.a.createElement(m.a,{className:"device-refresh-icon",spin:!b})))),r.a.createElement("div",{className:"flex-column flex1"},r.a.createElement(g.a,{title:"联网设备列表"},r.a.createElement("div",{className:"alone-section-content-default"},r.a.createElement(d.a,{title:"最多导出1千条数据",placement:"top"},r.a.createElement("a",{href:"javascript:void(0)",className:"btn-exportdata",onClick:this.exportData},"导出数据")),r.a.createElement("div",{className:"lineSearchBox"},r.a.createElement("div",{className:"search-info-box"},r.a.createElement("div",{className:"searchBox"},r.a.createElement(s.a.Group,{compact:!0},r.a.createElement(p.a,{className:"type-select",value:k,onChange:function(t){e.onChangeListParams("infoType",t)}},r.a.createElement(M,{value:1},"设备ID"),r.a.createElement(M,{value:2},"物理地址")),r.a.createElement(s.a,{className:"input",maxLength:100,value:N,placeholder:"请输入设备ID号",onChange:function(t){e.onChangeListParams("field",t.target.value)}}))),r.a.createElement("span",{className:"margin-left-10px"},"设备标签："),r.a.createElement(s.a,{className:"input",placeholder:"请输入标签Key",maxLength:100,value:T,onChange:function(t){e.onChangeListParams("labelKey",t.target.value)}}),r.a.createElement(s.a,{className:"input margin-left-10px",placeholder:"请输入标签Value",maxLength:100,value:_,onChange:function(t){e.onChangeListParams("labelValue",t.target.value)}}),r.a.createElement(p.a,{className:"type-select margin-left-10px",value:A,onChange:function(t){e.onChangeListParams("innet",t)}},r.a.createElement(M,{value:1},"已/未入网"),r.a.createElement(M,{value:2},"已入网"),r.a.createElement(M,{value:3},"未入网")),r.a.createElement(p.a,{className:"type-select margin-left-10px",value:K,onChange:function(t){e.onChangeListParams("online",t)}},r.a.createElement(M,{value:1},"在/离线"),r.a.createElement(M,{value:2},"在线"),r.a.createElement(M,{value:3},"离线"))),r.a.createElement("div",{className:"searchBut"},r.a.createElement(u.a,{className:"btn",type:"primary",onClick:this.inquireDeviceList},"查询"),r.a.createElement(u.a,{className:"btn",onClick:this.resetSearch},"重置"))),r.a.createElement(l.a,{className:"devicetablelist",rowKey:"deviceUniqueId",dataSource:w,columns:S,pagination:!1})),r.a.createElement("div",{className:"list-pagination"},O&&O.totalRows>0&&r.a.createElement(i.a,{className:"self-pa",total:O.totalRows,current:L,defaultCurrent:1,defaultPageSize:R,onChange:function(t){return e.changePage(t)},showTotal:function(e){return r.a.createElement("span",null,"共 ",r.a.createElement("a",null,e)," 条")},showQuickJumper:!0,hideOnSinglePage:!0})))))}}])&&N(t.prototype,n),a&&N(t,a),f}(a.PureComponent))||S,B=(n("k3Gp"),n("kLXV")),G=(n("qNb/"),n("PArb")),q=(n("XlDN"),n("FC04")),U=n("WsrF"),Y=n("M7r8");function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=X(e);if(t){var r=X(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return z(this,n)}}function z(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(c,e);var t,n,a,o=J(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).state={},t}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e={labelCol:{span:4},wrapperCol:{span:20}},t=this.props.form,n=t.getFieldDecorator,a=t.getFieldValue;return r.a.createElement(U.a,e,r.a.createElement(U.a.Item,{label:"分组名称"},n("name",{rules:[{required:!0,message:"请输入分组名称"},{max:50,message:"最大输入长度为50"}]})(r.a.createElement(s.a,{placeholder:"请输入分组名称"}))),r.a.createElement(Y.a,{label:"分组描述",formId:"remark",astrictNub:"50",rows:"4",placeholder:"分组描述",getFieldDecorator:n,getFieldValue:a}))}}])&&W(t.prototype,n),a&&W(t,a),c}(a.Component),$=U.a.create({name:"caseAdd"})(Z),ee=(n("GWga"),n("wd/R")),te=n.n(ee);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=le(e);if(t){var r=le(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return ce(this,n)}}function ce(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?ie(e):t}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(i,e);var t,n,a,c=oe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=c.call(this,e)).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.b)(y.a.getGroupList,e).then((function(e){t.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})}))},t.addCase=function(){t.setState({addCaseVisible:!0})},t.openDel=function(e,n){t.setState({id:e,name:n})},t.delOkCancel=function(e){if("ok"==e){var n=t.state,a=n.id,r=n.pageIndex;r=r||1,Object(y.b)(y.a.deleteGroup,{id:a}).then((function(e){0==e.code&&t.setState({loading:!0,id:""},(function(){t.getList({pageIndex:r,pageRows:10})}))}))}else t.setState({id:""})},t.searchCase=function(e){t.setState({loading:!0,searchName:e},(function(){t.pagerIndex(1)}))},t.updateModal=function(e){1==e?(0,t.addFormRefs.props.form.validateFieldsAndScroll)((function(e,n){var a=n.name,r=n.remark;e||Object(y.c)(y.a.updateGroup,{name:a,remark:r}).then((function(e){0==e.code&&(Object(j.a)({type:"success",description:"新增成功！"}),t.addCancel(),t.pagerIndex(1))}))})):t.addCancel()},t.addCancel=function(){t.setState({addCaseVisible:!1}),t.addFormRefs.props.form.resetFields()},t.pagerIndex=function(e){t.setState({pageIndex:e,loading:!0},(function(){t.getList({pageIndex:e,pageRows:10,name:t.state.searchName||void 0})}))},t.state={loading:!0,caseList:[],pager:{},searchName:"",name:"",id:"",addCaseVisible:!1,pageIndex:"1"},t.columns=[{title:"分组名称",dataIndex:"name",key:"name"},{title:"分组ID",dataIndex:"id",key:"id"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"添加时间",dataIndex:"createTime",key:"createTime",render:function(e){return r.a.createElement("span",null,e&&te()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"140px",render:function(e,n){return r.a.createElement("span",null,r.a.createElement(o.Link,{to:"/open/base/device/groupDetails/".concat(n.id,"/").concat(n.groupId)},"查看"),r.a.createElement(G.a,{type:"vertical"}),r.a.createElement("a",{onClick:t.openDel.bind(ie(t),n.id,n.name)},"删除"))}}],t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.addCaseVisible,o=t.caseList,c=t.pager,i=t.id,d=t.name;return r.a.createElement("div",{className:"devicegroup-box"},r.a.createElement("header",{className:"page-content-header"},r.a.createElement(h.a,{noback:!0,title:"设备分组管理"}),r.a.createElement("div",null,r.a.createElement("div",{className:"searchBox"},r.a.createElement(s.a.Search,{placeholder:"请输入分组名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}})),r.a.createElement("div",{className:"butFloatRight"},r.a.createElement(u.a,{className:"but-add",type:"primary",onClick:this.addCase},"新增分组")))),r.a.createElement("div",{className:"commonContentBox"},r.a.createElement("div",{className:"centent"},r.a.createElement(l.a,{rowKey:"id",columns:this.columns,dataSource:o,pagination:{defaultCurrent:c.pageIndex,total:c.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:c.pageIndex},loading:n}))),r.a.createElement(B.a,{title:"新增分组",visible:a,width:600,onOk:this.updateModal.bind(this,1),onCancel:this.updateModal.bind(this,2),maskClosable:!1,className:"self-modal"},r.a.createElement($,{onRef:function(t){return e.addFormRefs=t}})),r.a.createElement(q.a,{visible:!!i,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"删除分组",descText:"即将删除分组",targetName:d}))}}])&&ae(t.prototype,n),a&&ae(t,a),i}(a.Component),se=(n("OrB1"),n("gFTJ")),de=n("BkRI"),pe=n.n(de),fe=(n("7W5+"),n("8z0m")),me=(n("K4yd"),n("9yH6")),ye=n("z7Xi");function ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return o}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){if(e){if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(e,t):void 0}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var be=function(e){var t=e.productList,n=e.changedfunc,o=e.searchedFunc,c=ve(Object(a.useState)([-1]),2);c[0],c[1];return r.a.createElement("div",{className:"search-box"},r.a.createElement(s.a.Group,{compact:!0},r.a.createElement(p.a,{showSearch:!0,optionFilterProp:"children",defaultValue:[-1],onChange:n,style:{width:200}},r.a.createElement(p.a.Option,{value:-1},"全部产品"),t.map((function(e,t){return r.a.createElement(p.a.Option,{key:t,value:e.productId},e.productName)}))),r.a.createElement(s.a.Search,{enterButton:!0,maxLength:30,placeholder:"请输入设备ID查询",onSearch:o,style:{width:300}})))};function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){we(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=je(e);if(t){var r=je(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return xe(this,n)}}function xe(e,t){return!t||"object"!==Ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(c,e);var t,n,a,o=Ce(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).getCreateProduct=function(){Object(y.b)(y.a.getCreateProduct,{pageRows:999}).then((function(e){var n=e.data.list;n&&n.length&&n.length>0&&t.setState({addProductList:n})}))},t.getGroupAddDevList=function(){t.setState({listLoading:!0});var e=Ie({},t.state.addListParams);-1==e.productId&&delete e.productId,Object(y.b)(y.a.getGroupSlctDev,e).then((function(e){var n=e.data||{},a=n.list,r=n.pager;0==e.code&&t.setState({list:a,pager:r})})).finally((function(){t.setState({listLoading:!1})}))},t.setQuestParams=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ie({},t.state.addListParams);r[e]=n||void 0,"pageIndex"!==e&&(r.pageIndex=1),t.setState({addListParams:r},!a&&t.getGroupAddDevList||void 0)},t.onSelectRowKeys=function(e){t.setState({selectedRowKeys:e})},t.addDeviceOk=function(){var e=t.state,n=e.addWay,a=e.selectedRowKeys;if(1==n){var r=a;r.length>0&&Object(y.c)(y.a.addGroupDevice,{id:t.props.id,deviceIds:r.join(",")}).then((function(e){t.setState({selectedRowKeys:[]}),t.props.openCloseAdd(!0)}))}else 2==n&&t.publicTypeForm()},t.addUPload=function(e){e.groupId=t.props.groupid,e.type=1,Object(y.c)(y.a.addDevice,e).then((function(e){t.props.openCloseAdd(!0)}))},t.changeAddWay=function(e){var n=e.target.value;t.setState({addWay:n})},t.state={addWay:1,listLoading:!1,list:[],pager:{},selectedRowKeys:[],addListParams:{pageIndex:1,pageRows:8,id:e.id,productId:-1,deviceUniqueId:void 0},addProductList:[]},t.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return r.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return r.a.createElement("span",null,e&&te()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}}],t}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this),this.getCreateProduct()}},{key:"render",value:function(){var e=this,t=this.props,n=t.addVisiable,a=t.openCloseAdd,o=this.state,c=o.selectedRowKeys,i=o.list,u=o.pager,s=o.addWay,d=o.listLoading,p=o.addProductList,f={selectedRowKeys:c,onChange:this.onSelectRowKeys};return r.a.createElement(B.a,{title:"添加设备到分组",visible:n,width:750,onOk:this.addDeviceOk,onCancel:function(){a(!1)},maskClosable:!1,closable:!1,className:"groupadd-device-modal"},r.a.createElement("div",{className:"addtype"},r.a.createElement(me.a.Group,{value:s,onChange:this.changeAddWay},r.a.createElement(me.a,{value:1},"查找选择"),r.a.createElement(me.a,{value:2},"本地导入"))),1==s?r.a.createElement("div",{className:""},r.a.createElement(be,{productList:p,changedfunc:function(t){e.setQuestParams("productId",t,!0)},searchedFunc:function(t){e.setQuestParams("deviceUniqueId",t)}}),r.a.createElement("div",{className:"list-content"},r.a.createElement(l.a,{rowKey:"deviceId",columns:this.columns,dataSource:i,rowSelection:f,loading:!!d,pagination:{defaultCurrent:u.pageIndex,total:u.totalRows,onChange:function(t){e.setQuestParams("pageIndex",t)},current:u.pageIndex}}))):r.a.createElement(Le,{productList:p,onRef:function(t){return e.publicTypeForm=t},addUPload:this.addUPload}))}}])&&Se(t.prototype,n),a&&Se(t,a),c}(a.PureComponent),Le=U.a.create({name:"form-upload-device"})((function(e){var t=e.form,n=e.productList,o=e.onRef,c=e.addUPload;Object(a.useEffect)((function(){o(s)}),[]);var i=t.getFieldDecorator,l=t.validateFields,s=function(){l((function(e,t){if(console.log(3333,t),!e){var n=t.data,a=t.productId,r="";if(n&&n.fileList&&n.fileList.length){var o=n.fileList[0];o&&o.response&&o.response.data&&(r=o.response.data.url)}c({productId:a,data:r})}}))},d={labelCol:{span:6},wrapperCol:{span:10}};return r.a.createElement("div",null,r.a.createElement(U.a,d,r.a.createElement(U.a.Item,{label:"产品"},i("productId",{rules:[{required:!0,message:"请选择产品！"}],initialValue:""})(r.a.createElement(p.a,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择产品"},r.a.createElement(p.a.Option,{value:"",disabled:!0,selected:!0},"请选择产品"),n.map((function(e){var t=e.productName,n=e.productId;return r.a.createElement(p.a.Option,{key:n,value:n},t)}))))),r.a.createElement(U.a.Item,{label:"上传文件"},i("data",{rules:[{required:!0,message:"请上传文件！"}]})(r.a.createElement(fe.a,{accept:".xls,.xlsx",action:y.a.upFileUrl,data:{appId:31438,domainType:4}},r.a.createElement(u.a,{type:"primary",icon:r.a.createElement(ye.a,null)},"上传文件"),r.a.createElement("span",{style:{marginLeft:"15px"}},"仅支持.xls,.xlsx格式文件"))),r.a.createElement("a",{href:"http://skintest.hetyj.com/31438/6b0b20891e06ac31d0eed37a5083cca9.xlsx"},"下载模板"))))}));function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Ke(e);if(t){var r=Ke(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return _e(this,n)}}function _e(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?Ae(e):t}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(i,e);var t,n,a,c=Te(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=c.call(this,e)).openDel=function(e,n){t.setState({delVisable:!0}),e&&(console.log(e),t.setState({delid:e,deldeviceUniqueId:n}))},t.getDetail=function(){Object(y.b)(y.a.getGroupDetail,{id:t.id}).then((function(e){var n=e.data,a=n.name,r=n.createTime,o=n.remark,c=n.deviceCount,i=n.activeCount,l=n.groupId;t.setState({name:a,remark:o,deviceCount:c,activeCount:i,groupId:l,createTime:te()(r).add(8,"h").format("YYYY-MM-DD HH:mm:ss")})}))},t.getDownProduct=function(){Object(y.b)(y.a.getDownProduct,{pageRows:999}).then((function(e){var n=e.data.list;n&&n.length&&n.length>0&&t.setState({productList:n})}))},t.getGroupDevList=function(){var e=pe()(t.state.listParams);-1==e.productId&&delete e.productId,Object(y.b)(y.a.getGroupDeviceList,e).then((function(e){var n=e.data||{},a=n.list,r=n.pager;t.setState({groupDevList:a,pager:r})}))},t.setParams=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=pe()(t.state.listParams);r[e]=n||void 0,"pageIndex"!==e&&(r.pageIndex=1),t.setState({listParams:r},!a&&t.getGroupDevList||void 0)},t.openCloseAdd=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!t.state.addVisiable;t.setState({addVisiable:n}),n?(t.addListRefs.setQuestParams("pageIndex",1),t.addListRefs.setState({addWay:1})):e&&t.getGroupDevList()},t.onSelectRowKeys=function(e){t.setState({selectedRowKeys:e})},t.delOkCancel=function(e){var n=t.state,a=n.delid,r=n.selectedRowKeys;"ok"==e?Object(y.c)(y.a.delGroupDevice,{id:t.id,deviceIds:a||r.join(",")}).then((function(e){0==e.code&&(t.getGroupDevList(),t.setState({delid:"",delVisable:!1,selectedRowKeys:[]}))})):t.setState({delid:"",delVisable:!1})},t.id=e.match.params.groupid,t.groupidid=e.match.params.groupidid,t.defaultListParams={pageIndex:1,pageRows:10,id:t.id,productId:-1,deviceUniqueId:void 0},t.addListRefs=null,t.state={listParams:pe()(t.defaultListParams),name:"--",groupId:"--",createTime:"--",remark:"--",deviceCount:"--",activeCount:"--",groupDevList:[],pager:{},productList:[],addVisiable:!1,addProductList:[],selectedRowKeys:[],delid:"",deldeviceUniqueId:"",delVisable:!1},t.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"设备类型",dataIndex:"productClass",key:"productClass",render:function(e){return r.a.createElement("span",null,0==e?"普通设备":"网关设备")}},{title:"状态",dataIndex:"status",key:"status",render:function(e){return r.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return r.a.createElement("span",null,e&&te()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"200px",render:function(e,n){return r.a.createElement("span",null,r.a.createElement(o.Link,{key:"detail",to:"/open/base/device/onlineDevice/details/"+n.deviceId},"查看"),r.a.createElement(G.a,{type:"vertical"}),r.a.createElement("a",{onClick:t.openDel.bind(Ae(t),n.deviceId,n.deviceUniqueId)},"从分组中删除"))}}],t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getDetail(),this.getDownProduct(),this.getGroupDevList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,a=t.createTime,o=t.remark,c=t.deviceCount,i=t.activeCount,s=t.groupId,d=t.productList,p=t.groupDevList,f=t.addVisiable,m=t.selectedRowKeys,y=t.pager,v=t.delVisable,b=t.delid,E=t.deldeviceUniqueId,O=t.addProductList,I={selectedRowKeys:m,onChange:this.onSelectRowKeys};return r.a.createElement("section",{className:"page-main-wrapper groupdetailpage flex-column"},r.a.createElement(h.a,{title:"设备分组详情"}),r.a.createElement("header",{className:"page-content-header"},r.a.createElement(se.b,{title:"",className:"descriptions",column:2},r.a.createElement(se.b.Item,{label:"分组名称"},n),r.a.createElement(se.b.Item,{label:"分组ID"},s),r.a.createElement(se.b.Item,{label:"创建时间"},a),r.a.createElement(se.b.Item,{label:"描述"},o)),r.a.createElement("ul",{className:"device-inine-data"},r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("span",{className:"icon-cube"}),"设备总数"),r.a.createElement("span",{className:"count"},c)),r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("span",{className:"icon-cube"}),"激活设备数"),r.a.createElement("span",{className:"count"},i)))),r.a.createElement(g.a,{title:"设备列表"},r.a.createElement("div",{className:"alone-section-content-default"},r.a.createElement(be,{productList:d,changedfunc:function(t){e.setParams("productId",t,!0)},searchedFunc:function(t){e.setParams("deviceUniqueId",t)}}),r.a.createElement("div",{className:"search-box"},r.a.createElement(u.a,{className:"but-add",type:"primary",onClick:this.openCloseAdd},"添加设备到分组")),r.a.createElement("div",null,r.a.createElement(u.a,{disabled:0==m.length,className:"but-del",type:"primary",onClick:this.openDel.bind(this,0)},"删除"),r.a.createElement(l.a,{rowKey:"deviceId",columns:this.columns,dataSource:p,rowSelection:I,pagination:{defaultCurrent:y.pageIndex,total:y.totalRows,hideOnSinglePage:!1,onChange:function(t){e.setParams("pageIndex",t)},current:y.pageIndex}})))),r.a.createElement(De,{addVisiable:f,onRef:function(t){e.addListRefs=t},productList:O,id:this.id,groupid:this.groupidid,openCloseAdd:this.openCloseAdd}),r.a.createElement(q.a,{visible:v,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"从分组中删除",descText:"即将删除".concat(b?"设备":"选中的"),targetName:b?"".concat(E):"".concat(m.length,"个设备")}))}}])&&ke(t.prototype,n),a&&ke(t,a),i}(a.PureComponent),Fe=(n("MC1R"),Object(c.default)((function(){return Promise.all([n.e("common"),n.e("antd-vendor"),n.e("vendor"),n.e(13)]).then(n.bind(null,"+a4r"))}))),Ve=Object(c.default)((function(){return Promise.all([n.e("common"),n.e(23)]).then(n.bind(null,"MK7m"))})),Be=Object(c.default)((function(){return Promise.all([n.e("common"),n.e("antd-vendor"),n.e(28)]).then(n.bind(null,"JsKL"))})),Ge=Object(c.default)((function(){return Promise.all([n.e("common"),n.e("antd-vendor"),n.e(27)]).then(n.bind(null,"nBNi"))}));function qe(e){var t=e.match.path;return r.a.createElement(o.Switch,null,r.a.createElement(o.Route,{path:"".concat(t,"/onlineDevice/list"),component:V}),r.a.createElement(o.Route,{path:"".concat(t,"/onlineDevice/details/:deviceid"),component:Fe}),r.a.createElement(o.Route,{path:"".concat(t,"/deviceSecret"),component:Ve}),r.a.createElement(o.Route,{path:"".concat(t,"/groups"),component:ue}),r.a.createElement(o.Route,{path:"".concat(t,"/groupDetails/:groupid/:groupidid"),component:Me}),r.a.createElement(o.Route,{path:"".concat(t,"/deviceWarning"),component:Be}),r.a.createElement(o.Route,{path:"".concat(t,"/addWarningConfig"),component:Ge}),r.a.createElement(o.Route,{path:"".concat(t,"/warningConfig/:id"),component:Ge}),r.a.createElement(o.Redirect,{to:"".concat(t,"/onlineDevice/list")}))}}}]);