(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"+tVk":function(e,t,a){},hmqF:function(e,t,a){"use strict";a.r(t);a("ef1R"),a("Ra8s"),a("sfoS"),a("HsXu"),a("bs69"),a("Lm8M"),a("ryEf"),a("qgAm"),a("9b3Y"),a("Ck9u"),a("IHDg"),a("P37N"),a("vV4J"),a("av3G"),a("RfWx"),a("QcZr");var n=a("b+L2"),r=(a("MNU5"),a("YeX6")),o=(a("6IzV"),a("QFmM")),c=(a("xzjF"),a("PeP6")),i=(a("W0kV"),a("caRq")),l=(a("UdMA"),a("ViyK")),u=a("CvKH"),s=a.n(u),d=(a("hEGT"),a("V9IP"),a("62KB"),a("T9Mk")),m=a.n(d),f=a("q5+0"),p=a("Nlzp"),b=a("DgvE"),w=a("MeRu"),y=a("6Tta"),g=a.n(y),h=a("yq+b"),O=a.n(h),v=(a("+tVk"),a("P2RN"));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,o=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}l.a.Search;var k=i.a.RangePicker,x=c.a.Option,P={1:"初始化",2:"运行中",3:"运行成功",4:"运行失败",5:"创建作业失败"};t.default=function(){Object(f.g)();var e=I(o.a.useForm(),1)[0],t=I(Object(d.useState)(""),2),a=t[0],i=(t[1],I(Object(d.useState)([]),2)),u=i[0],y=i[1],h=I(Object(d.useState)([]),2),S=h[0],R=h[1],T=I(Object(d.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),C=T[0],D=T[1],N=[{title:"序号",dataIndex:"id",key:"id",width:80},{title:"名称",dataIndex:"name",key:"name",width:300},{title:"参数",dataIndex:"params",key:"params",width:"28%"},{title:"状态",dataIndex:"status",key:"status",width:120,render:function(e){return m.a.createElement("span",null,P[e])}},{title:"日志",dataIndex:"msg",key:"msg",width:"25%"},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:220,render:function(e){return e&&b.a.utcToDev(e)}},{title:"操作",key:"action",width:80,render:function(e,t){return 3==t.status?m.a.createElement("div",{className:"operation"},m.a.createElement("a",{onClick:function(){return M(t.result)}},"下载")):""}}],M=function(e){if(!e)return Object(v.a)({type:"warn",message:"暂无数据"});window.open(e)},A=function(){Object(p.c)(p.a.downDeviceDataList,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({origin:"open"},C),{loading:!0}).then((function(e){y(e.data.list),D((function(t){var a=s()(t);return a.totalRows=e.data.pager.totalRows,a}))}))};Object(d.useEffect)((function(){A()}),[C.pageIndex,C.pageRows,a]),Object(d.useEffect)((function(){V()}),[]);var V=function(){Object(p.c)(p.a.newProduct).then((function(e){R(e.data)}))};return m.a.createElement("div",{className:"download-data-page"},m.a.createElement(w.a,{title:"下载数据"}),m.a.createElement("div",{className:"comm-shadowbox filter"},m.a.createElement(o.a,{className:"device-filter-form",form:e,layout:"inline",autoComplete:"off"},m.a.createElement(o.a.Item,{name:"productId",label:"选择产品"},m.a.createElement(c.a,{showSearch:!0,optionFilterProp:"children",placeholder:"搜索产品名称",style:{width:200}},S&&S.map((function(e){return m.a.createElement(x,{value:e.productId,key:e.productId},e.productName)})))),m.a.createElement(o.a.Item,{name:"macStrs",label:"设备Mac"},m.a.createElement(l.a,{placeholder:"输入多个时以英文逗号隔开",allowClear:!0,style:{width:220}})),m.a.createElement(o.a.Item,{name:"times",label:"时间"},m.a.createElement(k,{showTime:!0,allowClear:!0,disabledDate:function(e){var t=g()().format("YYYY-MM-DD");return e&&(e<g()(t).subtract(7,"day")||e>=g()(t).subtract(-1,"day").second(1))}})),m.a.createElement(o.a.Item,{label:" ",colon:!1,style:{marginRight:"2px"}},m.a.createElement(r.a,{type:"primary",onClick:function(){var t=e.getFieldsValue(),a=t.productId,n=t.macStrs,r=t.times;if(!a||!n||!r)return Object(v.a)({type:"warn",description:"请输入查询条件"});var o={};r&&r.length&&(o.startTime=O()(r[0]).valueOf(),o.endTime=O()(r[1]).valueOf()),a&&(o.productId=a),n&&(o.macStrs=n.trim());var c={productId:a,originEnum:"open",macStrs:o.macStrs,startTime:o.startTime,endTime:o.endTime};Object(p.c)(p.a.createExport,c,{loading:!0}).then((function(e){0===e.code&&A()}))}},"查询")),m.a.createElement(o.a.Item,{label:" ",colon:!1,style:{marginRight:"0px"}},m.a.createElement(r.a,{onClick:function(){e.resetFields()}},"重置")))),m.a.createElement("div",{className:"comm-shadowbox pd22"},m.a.createElement(n.a,{columns:N,className:"ant-table-fixed",rowKey:"id",dataSource:u,pagination:{defaultCurrent:1,current:C.pageIndex,pageSize:C.pageRows,total:C.totalRows,showSizeChanger:!1,showQuickJumper:C.totalPages>5,onChange:function(e,t){D((function(a){return Object.assign(s()(a),{pageIndex:t===C.pageRows?e:1,pageRows:t})}))},showTotal:function(e){return m.a.createElement("span",null,"共 ",m.a.createElement("a",null,e)," 条")}}})))}}}]);