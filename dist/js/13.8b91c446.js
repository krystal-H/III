(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{dSAc:function(e,t,a){},kZcz:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Ie}));a("0AG1"),a("Jya7"),a("vxpS"),a("ThRY"),a("6wma"),a("8OWE"),a("L4wC"),a("KzFV"),a("qb5G");var n=a("wLbl"),r=(a("7fbo"),a("LCR/")),l=(a("eox1"),a("vW+X")),o=(a("sbOf"),a("spxj")),i=(a("wlSd"),a("RWNY"),a("h4PX"),a("SoGA"),a("mtIt"),a("eVIo"),a("SnyF"),a("n1yf"),a("q+fq")),c=a.n(i),s=a("ivud"),u=a("Per8"),d=a("EZYW"),p=a("Nlzp"),m=a("P2RN"),f=a("DgvE"),y=a("MeRu"),b=a("odoF"),v=a("FC04"),h=a("cu44"),g=a("S18n"),E=a("rwTb"),w=a("8sIe"),L=a("YNSc"),k=(a("rsdX"),a("oCJ0"),a("L8Gl"),a("EO5n"),a("Y5Ue"),a("xc0u")),O=(a("XNYu"),a("LeYH")),S=(a("72Pr"),a("O4+N")),N=(a("MWcG"),a("rP0n")),I=(a("+SM3"),a("SE39")),D=(a("bqBU"),a("4OHk")),j=(a("61Aj"),"/v5/web/open"),x=function(e){return Object(p.d)(j+"/deviceShadow/getDeviceShadowData",{deviceId:e})},M=function(e){return Object(p.d)(j+"/deviceShadow/getHistoricalData",e)},C=function(e){var t="?";return Object.keys(e).forEach((function(a){t+=a+"="+e[a]+"&"})),function(e,t){var a=window.location.origin+j+e+t;try{window.open(a)}catch(e){Object(m.a)({description:"下载失败",type:"error"})}}("/deviceShadow/exportHistoricalData",t.replace(/&$/,""))},P=a("FNo8"),F=a("/Zbm"),T=(a("U4At"),a("KiF4")),H=(a("HzvR"),a("2n5t")),R=(a("GM9G"),a("t3JN")),_=(a("gsuU"),a("2Kt1"),a("H4M8")),V=a("lwO8"),K=a("yq+b"),A=a.n(K);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=G(e);if(t){var r=G(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return U(this,a)}}function U(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var z,X=[{name:"最近5分钟",val:5},{name:"最近15分钟",val:15},{name:"最近30分钟",val:30},{name:"最近1小时",val:60},{name:"最近6小时",val:360},{name:"最近24小时",val:1440}],Z=A()().utcOffset()/60,$=["#1890FF","#2fc25b"],Q="<span style='display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:"+$[0]+";'></span>",ee=function(e,t){if(!e||0===e.length)return null;var a=function(e){return e.map((function(e){var t=e.dataTimeStamp,a=e.count;return{name:A()(t).add(Z,"h").format("YYYY-MM-DD HH:mm:ss"),count:a}}))}(e),n=a.map((function(e){return e.name})),r=a.map((function(e){return e.count}));return{tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){var t=e[0],a=t.name,n=t.seriesName,r=t.value;return a+" <br />"+Q+n+"："+(null==r?"暂无":r)}},color:$,grid:{top:20,bottom:20,right:50,left:50},toolbox:{show:!1},xAxis:[{type:"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},data:n,axisLabel:{formatter:function(e){return e.slice(-8)}}}],yAxis:{type:"value",scale:!0,min:0,axisTick:{show:!1},axisLine:{lineStyle:{opacity:0}},splitLine:{lineStyle:{type:"dotted"}}},series:[{type:"line",step:"end",name:t,data:r}]}},te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(l,e);var t,a,n,r=q(l);function l(){var e;J(this,l);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(e=r.call.apply(r,[this].concat(a))).export=function(t){t.stopPropagation(),e.props.download()},e.download=c.a.createElement(k.a,{type:"link",className:"lcp-remark-export",onClick:e.export},c.a.createElement(D.a,{type:"export"}),"导出"),e.getChart=function(){var t=e.props,a=t.showData,n=t.isLoadingForModal,r=t.isErrorForModal,l=t.listForModal,o=t.tryAgain;if(r)return c.a.createElement(P.a,{tryAgain:o});if(!n&&l&&0===l.length)return c.a.createElement(_.a,null);var i=ee(l,(a||{}).propertyName);return c.a.createElement(V.a,{className:"lcp-chart",option:i})},e.onChangeTime=function(t){e.props.tryAgain(t)},e}return t=l,(a=[{key:"render",value:function(){var e=this,t=this.props,a=t.showModal,n=t.showData,r=t.isLoadingForModal,l=t.isErrorForModal,o=t.listForModal,i=t.closeModal,s=n||{},u=s.propertyName,d=s.property,p=s.propertyValueDesc,m=s.gap,f=s.mulriple,y=s.remark,b=c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"lcp-w1"},u),d),v=!r&&!l&&o&&o.length>0;return c.a.createElement(T.a,{visible:a,className:"self-modal",width:720,title:"数据查看",footer:null,onCancel:i,centered:!0,closable:!0,destroyOnClose:!0},c.a.createElement(R.a,{title:b},c.a.createElement(R.a.Item,{label:"范围"},p),c.a.createElement(R.a.Item,{label:"数据间隔"},m),c.a.createElement(R.a.Item,{label:"数据倍数"},f),c.a.createElement(R.a.Item,{label:"",span:3},y)),c.a.createElement("div",{className:"lcp-remark"},c.a.createElement(H.a,{className:"time-select",defaultValue:5,onChange:function(t){e.onChangeTime(t)}},X.map((function(e){var t=e.name,a=e.val;return c.a.createElement(H.a.Option,{key:"_"+a,value:a},t)}))),v?this.download:null),this.getChart())}}])&&Y(t.prototype,a),n&&Y(t,n),l}(i.Component);a("dSAc"),a("ger+");function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(a),!0).forEach((function(t){le(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ne(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=de(e);if(t){var r=de(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return ue(this,a)}}function ue(e,t){return!t||"object"!==ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pe,me=0,fe=["表单模式","Json模式"],ye={2:"controlList",3:"runList",4:"errorList",5:"configList"},be=function(e,t){var a=t?"已":"未";return 0===e?c.a.createElement("div",{className:"lcp-c"},"公共状态，仅对WIFI设备有意义。",c.a.createElement("br",null),"设备当前",a,"连接WIFI网络"):c.a.createElement("div",{className:"lcp-c"},"公共状态，设备",t?"已经":"没有","上报故障数据。",c.a.createElement("br",null),"设备",a,"发生故障")},ve=c.a.createElement(D.a,{type:"sync",spin:!0,title:"加载中"}),he=function(){return A()().format("YYYY-MM-DD HH:mm:ss")},ge=Object(s.connect)((function(e){return{}}),(function(e){return{}}))(z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(l,e);var t,a,n,r=se(l);function l(){var e;oe(this,l);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(e=r.call.apply(r,[this].concat(a))).state={tab:0,time:null,isLoading:!1,isError:!1,result:{},controlList:[],runList:[],errorList:[],configList:[],online:!1,onerror:!1,showModal:!1,showData:null,isLoadingForModal:!1,isErrorForModal:!1,listForModal:[]},e.alertMsg=c.a.createElement(c.a.Fragment,null,"设备影子是设备最新状态在平台的缓存信息，您可以在平台实时查询设备的运行和状态信息，也可以通过API获取设备状态信息。详细说明可参考",c.a.createElement(I.a,{title:"暂无文档，敬请期待~",placement:"top"},c.a.createElement("a",{href:"javascript:void(0)"},"文档"))),e.columns=[{title:"数据名称",dataIndex:"propertyName",key:"propertyName",className:"width1"},{title:"数据标识",dataIndex:"property",key:"property",className:"width2"},{title:"数据类型",dataIndex:"javaType",key:"javaType",className:"width3"},{title:"单位",dataIndex:"unit",key:"unit",className:"width4"},{title:"数据属性",dataIndex:"propertyValueDesc",key:"propertyValueDesc",className:"width5"},{title:"最新数据",dataIndex:"deviceData",key:"deviceData",className:"width6"},{title:"操作",dataIndex:"property",key:"done",className:"width7",render:function(t,a){return c.a.createElement("a",{onClick:function(){return e.showHistory(a)}},"数据查看")}}],e.getData=function(){var t=e.props.deviceId;e.setState({isLoading:!0,isError:!1});var a=function(){e.setState({time:he(),isLoading:!1,isError:!0})};x(t).then((function(t){var n=t.data,r=n.deviceData,l=n.state;if(0===t.code){var o={result:t,time:he(),isLoading:!1,isError:!1,online:!!l.online,onerror:!!l.error};r.forEach((function(e){var t=e.dataType,a=e.list;o[ye[t]]=a.map((function(e){return re(re({},e),{},{lcpId:++me,dataType:t})}))})),e.setState(o)}else a()})).catch((function(e){a()}))},e.toggleTab=function(t){e.setState({tab:t})},e.getHistory=function(t){var a=e.props.deviceId,n=t.property,r=t.dataType;if(n&&r){e.setState({isLoadingForModal:!0,isErrorForModal:!1,showModal:!0,showData:t,listForModal:[]});var l={deviceId:a,property:n,dataType:r};e.sendHistoryData=l,e.getHistoryNext(5)}else Object(m.a)({description:"数据标识或数据类型丢失，无法查询",type:"warn"})},e.getHistoryNext=function(t){e.sendHistoryData.startTime=e.getHistoryTime(t);var a=e.sendHistoryData,n=function(){e.setState({isLoadingForModal:!1,isErrorForModal:!0})},r=a.property;M(a).then((function(t){var a=t.data;if(0===t.code){var l={isLoadingForModal:!1,isErrorForModal:!1,listForModal:(a||[]).map((function(e){return re(re({},e),{},{count:e[r]})}))};e.setState(l)}else n()})).catch((function(e){n()}))},e.getHistoryTime=function(e){return A.a.utc().valueOf()-60*e*1e3},e.tryAgain=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;e.setState({isLoadingForModal:!0,isErrorForModal:!1,listForModal:[]}),e.getHistoryNext(t)},e.showHistory=function(t){e.getHistory(t)},e.closeModal=function(){e.setState({showModal:!1})},e.download=function(){C(e.sendHistoryData)},e.getJsonView=function(){var t=e.state.result,a=void 0===t?{}:t,n=JSON.stringify(a);return c.a.createElement(F.a,{code:n})},e.getFormListView=function(){var t=e.state,a=t.isLoading,n=t.controlList,r=t.runList,l=t.errorList,o=t.configList,i=t.online,s=t.onerror,u=[{nam:"控制数据",source:n},{nam:"运行数据",source:r},{nam:"故障数据",source:l},{nam:"配置数据",source:o}];return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"lcp-status"},c.a.createElement("div",{className:"lcp-status-item lcp-status-item-active"},"在线状态：",c.a.createElement(I.a,{title:be(0,i),placement:"top"},c.a.createElement(D.a,{type:"question-circle-o"}))),c.a.createElement("div",{className:"lcp-status-item"},a?ve:i?c.a.createElement(N.a,{status:"success",text:"在线"}):c.a.createElement(N.a,{status:"error",text:"离线"})),c.a.createElement("div",{className:"lcp-status-item lcp-status-item-active"},"故障状态：",c.a.createElement(I.a,{title:be(1,s),placement:"top"},c.a.createElement(D.a,{type:"question-circle-o"}))),c.a.createElement("div",{className:"lcp-status-item"},a?ve:s?c.a.createElement(N.a,{status:"error",text:"已发生故障"}):c.a.createElement(N.a,{status:"success",text:"未发生故障"}))),u.map((function(t){var n=t.nam,r=t.source;return c.a.createElement("div",{key:n},c.a.createElement("div",{className:"lcp-title marg-top20"},n),c.a.createElement(S.a,{className:"lcp-table-small",loading:a,rowKey:"lcpId",pagination:!1,columns:e.columns,dataSource:r}))})))},e}return t=l,(a=[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this,t=this.state,a=t.tab,n=t.time,r=t.isLoading,l=t.isError,o={showModal:t.showModal,showData:t.showData,isLoadingForModal:t.isLoadingForModal,isErrorForModal:t.isErrorForModal,listForModal:t.listForModal,tryAgain:this.tryAgain,closeModal:this.closeModal,download:this.download};return c.a.createElement("div",{className:"device-shadow-page"},c.a.createElement(O.a,{className:"page-visualization-alert",message:this.alertMsg,type:"info",showIcon:!0}),c.a.createElement("div",{className:"btn-changemod"},c.a.createElement(k.a.Group,null,fe.map((function(t,n){return c.a.createElement(k.a,{type:n===a?"primary":void 0,onClick:function(){return e.toggleTab(n)},key:n+t},t)}))),c.a.createElement("span",{className:"fresh-time"},"最新更新时间：",n,c.a.createElement(D.a,{type:"sync",spin:r,title:"刷新",className:"lcp-refresh",onClick:r?null:this.getData}))),l?c.a.createElement(P.a,{tryAgain:this.getData}):0===a?this.getFormListView():this.getJsonView(),c.a.createElement(te,o))}}])&&ie(t.prototype,a),n&&ie(t,n),l}(i.Component))||z;function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Se(e);if(t){var r=Se(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Oe(this,a)}}function Oe(e,t){return!t||"object"!==Ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ne=o.a.TabPane,Ie=Object(s.connect)((function(e){return{deviceLabelList:e.getIn(["device","deviceLabel"]).toJS(),LabelBaseList:e.getIn(["device","deviceLabelBase"]).toJS(),defaultLabel:e.getIn(["device","defaultLabel"]).toJS(),protocolLists:e.getIn(["product","productProtocolLists"]).toJS()}}),(function(e){return{getDeviceLabelList:function(t){return e(Object(u.b)(t))},getLabelBaseList:function(t){return e(Object(u.e)(t))},getDefaultLabel:function(t){return e(Object(u.a)(t))},getProtocolLists:function(t){return e(Object(d.getProtocolLists)(t))}}}))(pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(u,e);var t,a,i,s=ke(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).toggleShow=function(e){var a={},n=!t.state[e];a[e]=n,t.setState(a)},t.tabChangeHandle=function(e,a){var n=t.props.getProtocolLists;"3"===e&&n(a)},t.state={pageIndex:1,infodata:{productName:"--",productId:"--",productType:"--",productClass:"--",productCode:"--",deviceKey:"--",deviceUniqueId:"--",deviceSecret:"--",deviceMac:"--",activeTime:"",moduleVersion:"--",pcbVersion:"--",gateWay:"--",deviceSite:"--",deviceName:"--",bindUser:"--",macAddress:"无数据",deviceIdentifier:"--",simNumber:"--",online:"--"},showdeviceKey:!1,showdeviceKeyagin:!1,showdeviceSecret:!1,editid:-1,editkey:"",editval:"",addkey:"",addval:"",infoJurisdiction:Object(b.a)("基本信息"),tagJurisdiction:Object(b.a)("设备标签"),delLabelId:"",deleteLoading:!1,dellabelKey:"",dellabelValue:""},t}return t=u,(a=[{key:"componentDidMount",value:function(){this.getDeviceDetailt(),this.getDeviceLabelList(),this.getLabelBaseList(),this.getDefaultLabel()}},{key:"getDeviceDetailt",value:function(){var e=this,t=this.props.match.params.deviceid;Object(p.c)(p.a.getDeviceInfo,{deviceId:t}).then((function(t){0==t.code&&e.setState({infodata:t.data})}))}},{key:"getDeviceLabelList",value:function(){var e=this.state.pageIndex,t=this.props.match.params.deviceid;this.props.getDeviceLabelList({deviceId:t,pageIndex:e,pageRows:10})}},{key:"getDefaultLabel",value:function(){var e=this.props.match.params.deviceid;this.props.getDefaultLabel({deviceId:e,defaultLabel:1})}},{key:"getLabelBaseList",value:function(){this.props.getLabelBaseList({pageIndex:1,pageRows:9999})}},{key:"deleteOkHandle",value:function(){var e=this,t=this.state.delLabelId;this.setState({deleteLoading:!0},(function(){Object(p.d)(p.a.deleteDeviceLabel,{labelId:t}).then((function(t){e.setState({delLabelId:""}),0==t.code&&e.getDeviceLabelList()})).finally((function(){e.setState({deleteLoading:!1})}))}))}},{key:"openDelMod",value:function(e,t,a){this.setState({delLabelId:e,dellabelKey:t,dellabelValue:a})}},{key:"closeDelLabelMod",value:function(){this.setState({delLabelId:""})}},{key:"addConfirm",value:function(){var e=this,t=this.state,a=t.addkey,n=t.addval;if(""==a||""==n)return Object(m.a)({description:"请将添加输入框补充完整",type:"warn"}),!1;var r=this.props.match.params.deviceid;Object(p.d)(p.a.addDeviceLabel,{deviceId:r,labelKey:a,labelValue:n}).then((function(t){0==t.code&&(e.setState({addkey:"",addval:""}),e.getDeviceLabelList(),e.getLabelBaseList())}))}},{key:"editLabel",value:function(e,t,a){this.setState({editid:e,editkey:t,editval:a})}},{key:"onChangeInput",value:function(e,t){if(t&&t.length>50)return!1;var a={};a[e]=t,this.setState(a)}},{key:"editConfirm",value:function(e,t){var a=this,n=this.state,r=n.editid,l=n.editkey,o=n.editval;""==l&&""==o&&Object(m.a)({description:"请将编辑输入框补充完整",type:"warn"}),Object(p.d)(p.a.updateDeviceLabel,{labelId:r,labelKey:l||e,labelValue:o||t}).then((function(e){0==e.code&&(a.setState({editid:-1,editkey:"",editval:""}),a.getDeviceLabelList(),a.getLabelBaseList())}))}},{key:"getDataSource",value:function(e){var t=this.props.LabelBaseList,a=[],n=[];return t.forEach((function(t){a.push(t.labelTypeName||"无法识别的Key"),e&&e==t.labelTypeName&&t.labelDatas.forEach((function(e){n.push(e.labelName||"无法识别的Value")}))})),null==e?a:n}},{key:"getListHtml",value:function(){var e=this,t=this.props.deviceLabelList.list||[],a=this.state,n=a.editid,o=a.editkey,i=a.editval;return t.map((function(t,a){var s=t.id,u=t.labelKey,d=t.labelValue,p=t.labelCategory;return s==n?c.a.createElement("tr",{key:"tr_"+a},c.a.createElement("td",null,c.a.createElement(l.a,{value:o,dataSource:e.getDataSource(),style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editkey"),placeholder:"Key",filterOption:!0})),c.a.createElement("td",null,c.a.createElement(l.a,{value:i,dataSource:e.getDataSource(o),style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editval"),placeholder:"Value",filterOption:!0})),c.a.createElement("td",null,c.a.createElement("a",{href:"javascript:",onClick:e.editConfirm.bind(e,u,d)},"确认"),c.a.createElement(r.a,{type:"vertical"}),c.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,-1,"","")},"取消"))):c.a.createElement("tr",{key:"tr_"+a},c.a.createElement("td",null,u),c.a.createElement("td",null,d),c.a.createElement("td",null,1==p?null:c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,s,u,d)},"编辑"),c.a.createElement(r.a,{type:"vertical"}),c.a.createElement("a",{href:"javascript:",onClick:function(){return e.openDelMod(s,u,d)}},"删除"))))}))}},{key:"changePage",value:function(e){this.setState({pageIndex:e},this.getDeviceLabelList)}},{key:"copyText",value:function(){document.getElementById("copy").select(),document.execCommand("Copy")}},{key:"render",value:function(){var e=this,t=this.state,a=t.infodata,r=t.addkey,i=t.addval,s=t.pageIndex,u=t.infoJurisdiction,d=t.tagJurisdiction,p=t.delLabelId,m=t.deleteLoading,b=t.dellabelKey,k=t.dellabelValue,O=this.props.deviceLabelList.pager,S=a.deviceUniqueId,N=a.deviceMac,I=a.productName,D=a.productType,j=a.productCode,x=a.deviceKey,M=a.deviceSecret,C=a.productId,P=a.productClass,F=a.activeTime,T=a.moduleVersion,H=a.pcbVersion,R=a.gateWay,_=a.deviceName,V=a.deviceSite,K=a.bindUser,A=a.macAddress,B=a.deviceIdentifier,J=a.simNumber,Y=a.online,W=this.props,q=W.defaultLabel,U=W.match.params.deviceid,G=W.protocolLists,z=this.getListHtml(),X=function(e){var t=e.title,a=e.label,n=e.type;return c.a.createElement("p",null,c.a.createElement("span",{className:"title"},t,"："),"visible"===n?c.a.createElement(g.a,{label:a||"",tip:"点击复制",copy:!0}):c.a.createElement("span",null,a))};return c.a.createElement("section",{className:"page-main-wrapper devicepage flex-column"},c.a.createElement(y.a,{title:"设备详情"}),c.a.createElement("div",{className:"headerbox"},c.a.createElement("p",{className:"maintext"},c.a.createElement("span",{className:"keyvalue"},c.a.createElement("span",{className:"key"},"设备ID："),S),c.a.createElement("span",{className:"keyvalue"},c.a.createElement("span",{className:"key"},"物理地址："),N),c.a.createElement("span",{className:"keyvalue"},c.a.createElement("span",{className:"key"},"产品名称："),I),c.a.createElement("span",{className:"keyvalue"},c.a.createElement("span",{className:"key"},"所属分类："),D),c.a.createElement("span",{className:"keyvalue"},c.a.createElement("span",{className:"key"},"在线状态："),Y?"在线":"离线"))),c.a.createElement("div",null,c.a.createElement(o.a,{defaultActiveKey:"1",tabBarStyle:{background:"#fff",padding:"0 24px"},onChange:function(t){return e.tabChangeHandle(t,C)}},u?c.a.createElement(Ne,{tab:"基本信息",key:"1"},c.a.createElement(h.a,{title:"设备信息"},c.a.createElement("div",{className:"device-info"},c.a.createElement(X,{title:"设备ID",label:S}),c.a.createElement(X,{title:"设备秘钥",label:M,type:"visible"}),c.a.createElement(X,{title:"物理地址",label:N}),c.a.createElement(X,{title:"入网时间",label:F&&f.a.utcToDev(F)}),c.a.createElement(X,{title:"模组固件版本",label:T}),c.a.createElement(X,{title:"MCU固件版本",label:H}),c.a.createElement(X,{title:"绑定网关",label:R}),c.a.createElement(X,{title:"设备昵称",label:_}),c.a.createElement(X,{title:"设备位置",label:V}),c.a.createElement(X,{title:"绑定C端账户",label:K}),c.a.createElement(X,{title:"SIM卡号",label:J}),c.a.createElement(X,{title:"IMEI",label:B}))),c.a.createElement(h.a,{title:"产品信息"},c.a.createElement("div",{className:"device-info"},c.a.createElement(X,{title:"产品名称",label:I}),c.a.createElement(X,{title:"产品ID",label:C}),c.a.createElement(X,{title:"所属分类",label:D}),c.a.createElement(X,{title:"产品类型",label:{0:"普通设备",1:"网关设备"}[P]||"--"}),c.a.createElement(X,{title:"产品编码",label:j}),c.a.createElement(X,{title:"产品秘钥",label:x,type:"visible"})))):null,c.a.createElement(Ne,{tab:"topic列表",key:"9"},c.a.createElement(L.a,{productIdHex:j||"${YourProductKey}",type:1})),c.a.createElement(Ne,{tab:"设备影子",key:"2"},c.a.createElement(ge,{deviceId:U})),d?c.a.createElement(Ne,{tab:"设备标签",key:"4"},c.a.createElement(h.a,{title:c.a.createElement(E.a,{label:"默认设备标签",tipPlacement:"right",tip:"设备标签是您给产品设备自定义的标识，标签的结构为：Key：value，您可以使用标签功能实现设备的分类统一管理。"})},c.a.createElement("div",{className:"section-bg tabdevice"},c.a.createElement("table",{className:"labeltable"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{style:{width:"38%"}},"标签Key"),c.a.createElement("th",{style:{width:"62%"}},"标签Value"),c.a.createElement("th",{style:{width:"24%"}}))),c.a.createElement("tbody",null,q.length?q.map((function(e,t){return c.a.createElement("tr",{key:t},c.a.createElement("td",null,e.labelKey),c.a.createElement("td",null,e.labelValue))})):null)))),c.a.createElement(h.a,{title:c.a.createElement(E.a,{label:"自定义设备标签",tipPlacement:"right",tip:"设备标签是您给产品设备自定义的标识，标签的结构为：Key：value，您可以使用标签功能实现设备的分类统一管理。"})},c.a.createElement("div",{className:"section-bg tabdevice"},c.a.createElement("table",{className:"labeltable"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{style:{width:"38%"}},"标签Key"),c.a.createElement("th",{style:{width:"38%"}},"标签Value"),c.a.createElement("th",{style:{width:"24%"}},"管理"))),c.a.createElement("tbody",null,z,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement(l.a,{value:r,dataSource:this.getDataSource(),style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addkey"),placeholder:"Key",maxLength:"100",filterOption:!0})),c.a.createElement("td",null,c.a.createElement(l.a,{value:i,dataSource:this.getDataSource(r),style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addval"),placeholder:"Value",maxLength:"100",filterOption:!0})),c.a.createElement("td",null,c.a.createElement("a",{href:"javascript:",onClick:this.addConfirm.bind(this)},"确认"))))),c.a.createElement("footer",{className:"list-pagination"},O&&O.totalRows>0?c.a.createElement(n.a,{className:"self-pa",total:O.totalRows,current:s,defaultCurrent:1,defaultPageSize:10,onChange:function(t){return e.changePage(t)},showTotal:function(e){return c.a.createElement("span",null,"共 ",c.a.createElement("a",null,e)," 条")},showQuickJumper:!0,hideOnSinglePage:!0}):null)))):null,c.a.createElement(Ne,{tab:"远程配置",key:"3"},c.a.createElement(w.a,{remoteType:"device",productId:C,deviceId:this.props.match.params.deviceid,deviceUniqueId:S,macAddress:A,protocolLists:G})))),c.a.createElement(v.a,{visible:!!p,modalOKHandle:this.deleteOkHandle.bind(this),modalCancelHandle:this.closeDelLabelMod.bind(this),targetName:"key: ".concat(b,", value: ").concat(k),confirmLoading:m,title:"删除标签",needWarnIcon:!0,descText:"即将删除的标签"}))}}])&&we(t.prototype,a),i&&we(t,i),u}(i.PureComponent))||pe}}]);