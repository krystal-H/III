(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+Acz":function(e,t,a){},"/DsP":function(e,t,a){},"8bdq":function(e,t,a){},C8h6:function(e,t,a){},EVkz:function(e,t,a){},"JzY+":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAv0lEQVQ4T+XUSwrCMBAG4H/0QFLpXdy4FzxBpfvSA/QKRY8iuFAP1IxMIVBqJjPZarYZvsyL0K5hRua8eyK5tuIiQVbgH4CxRK2t+4YPARgZ2KZivnqYAy1MHnCDKYyAaZ2pC9Qw2uAYAq7L0k0whz07uq3XLgtaWGrhVbBqueYJ92WPpGdSpmSmbYEKMjNVLQYOOM/Tc2DmlCOKgJOWWVEP5cUZvaB+9fRIlVkM5n6ioqFYULw3M/RC7in/PvgBL+qur9K0TXkAAAAASUVORK5CYII="},OXFO:function(e,t,a){},PvDj:function(e,t,a){},S8ev:function(e,t,a){},ShEY:function(e,t,a){},T8Ho:function(e,t,a){},Z6NE:function(e,t,a){},Z8n2:function(e,t,a){"use strict";a.r(t);a("pNMO"),a("4Brf"),a("07d7"),a("0oug"),a("4mDm"),a("PKPk"),a("3bBZ"),a("+2oP"),a("sMBO"),a("pjDv"),a("tkto"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR"),a("zKZe"),a("L/Qf");var n=a("2/Rp"),r=(a("RKNx"),a("L41K")),l=(a("rB9j"),a("Rm1S"),a("EnZy"),a("2B1R"),a("q1tI")),c=a.n(l),i=a("55Ip"),o=a("/MKj"),u=a("dL2e"),s=a("8QW8"),m=(a("aTcW"),a("FC04")),d=(a("wd/R"),a("+Acz"),a("5s+n"),a("K4yd"),a("9yH6")),p=(a("Y2jk"),a("zeV3")),f=(a("8QGh"),a("2fM7")),y=(a("1vPl"),a("5rEg")),b=(a("tULf"),a("Vl3Y")),E=(a("Re5i"),a("/wGt")),v=(a("AUBz"),a("ZTPi")),g=(a("ls82"),a("JfAA"),a("wlus")),h=a("xvlK"),O=a("Nlzp"),w=a("P2RN"),I=(a("OXFO"),["key","name","fieldKey"]),j=["key","name","fieldKey"];function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function C(e,t,a,n,r,l,c){try{var i=e[l](c),o=i.value}catch(e){return void a(e)}i.done?t(o):Promise.resolve(o).then(n,r)}function k(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function c(e){C(l,n,r,c,i,"next",e)}function i(e){C(l,n,r,c,i,"throw",e)}c(void 0)}))}}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var A=[{value:"bool",label:"布尔型"},{value:"enum",label:"枚举型"},{value:"text",label:"字符型"},{value:"double",label:"数值型"}];var P=[{label:"故障",value:"fault"},{label:"告警",value:"alarm"},{label:"信息",value:"info"}];function F(e){var t=e.rightVisible,a=e.onCloseRight,r=e.onRefreshList,i=e.modelType,o=e.actionData,u=JSON.parse(JSON.stringify(o)),s=v.a.TabPane;Object(l.useEffect)((function(){}),[]);var m=o.funcType,d=Object(l.useRef)(),p=Object(l.useRef)(),f=Object(l.useRef)(),y=function(e){e.funcType=m,e.type="update";var t=JSON.parse(sessionStorage.getItem("productItem"));e.productId=t.productId,e.content.standard=1==i,e.content=JSON.stringify(e.content),Object(O.c)(O.a.PhysicalModelAction,e).then((function(e){r()}))};return c.a.createElement(E.a,{title:"1"===i?"编辑标准功能":"编辑自定义功能",placement:"right",closable:!1,onClose:a,visible:t,destroyOnClose:!0,width:393,footer:c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(n.a,{onClick:a,style:{marginRight:8}},"取消"),c.a.createElement(n.a,{onClick:function(){"properties"===m?d.current.onFinish():"events"===m?p.current.onFinish():"services"===m&&f.current.onFinish()},type:"primary"},"确定"))},c.a.createElement("div",{className:"edit-left-protocol-wrap"}," ",c.a.createElement(v.a,{activeKey:m,defaultActiveKey:o.funcType,renderTabBar:function(e,t){return c.a.createElement("div",null)}},c.a.createElement(s,{tab:"Tab 1",key:"properties"},c.a.createElement(M,{ref:d,currentTab:m,sentReq:y,actionData:u,modelType:i})),c.a.createElement(s,{tab:"Tab 2",key:"events"},c.a.createElement(L,{ref:p,sentReq:y,key:"events",actionData:u,modelType:i})),c.a.createElement(s,{tab:"Tab 3",key:"services"},c.a.createElement(K,{ref:f,sentReq:y,actionData:u,modelType:i})))))}function M(e,t){e.currentTab;var a=e.sentReq,r=e.actionData,i=e.modelType,o=x(b.a.useForm(),1)[0],u=function(){var e=k(regeneratorRuntime.mark((function e(){var t,n,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.validateFields();case 3:t=e.sent,t=JSON.parse(JSON.stringify(t)),(n={}).content={},"bool"===t.type?n.content=t:"enum"===t.type?(r=t.emusList.filter((function(e){if(e.key&&e.value)return e})),l=r.reduce((function(e,t){return e[t.key.toString()]=t.value,e}),{}),t.specs=l,n.content=t):("text"===t.type||"double"===t.type)&&(n.content=t),n.content.dataType={type:n.content.type,specs:n.content.specs},delete n.content.type,delete n.content.specs,a(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),s=Object(l.useMemo)((function(){var e={};return e.name=r.funcName,e.identifier=r.funcIdentifier,e.type=r.dataTypeEN,r.funcParamList.forEach((function(t){if(e.accessMode=t.accessMode,"enum"===t.dataTypeEN){var a=[];for(var n in t.propertyMap)a.push({key:n,value:t.propertyMap[n]});e.emusList=a}else if("double"===t.dataTypeEN){var r={};["interval","min","max","multiple","unit"].forEach((function(e){r[e]=t.propertyMap[e]})),e.specs=r}else if("bool"===t.dataTypeEN){var l={1:t.propertyMap[1],0:t.propertyMap[0]};e.specs=l}})),e}),[]);Object(l.useImperativeHandle)(t,(function(){return{onFinish:u}}));return c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16},form:o,initialValues:s},c.a.createElement(b.a.Item,{label:"功能点名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"标识符",name:"identifier",rules:[{required:!0}]},1==i?c.a.createElement("span",null,r.funcIdentifier):c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"数据类型",name:"type"},c.a.createElement(f.a,{allowClear:!0,onChange:function(e){console.log(e)}},A.map((function(e){return c.a.createElement(f.a.Option,{key:e.value,value:e.value},e.label)})))),c.a.createElement(b.a.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.type!==t.type}},(function(e){var t=e.getFieldValue;return"bool"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"布尔值",rules:[{required:!0}]},c.a.createElement(b.a.Item,{name:["specs","0"],label:"0"},c.a.createElement(y.a,{placeholder:"参数描述"})),c.a.createElement(b.a.Item,{name:["specs","1"],label:"1"},c.a.createElement(y.a,{placeholder:"参数描述"})))):"enum"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"枚举型:",name:"enumus_text",className:"enums-lise-nobottom"},c.a.createElement("span",{style:{marginRight:"50px"}},"参数值"),"-",c.a.createElement("span",{style:{marginLeft:"30px"}},"参数描述")),c.a.createElement("div",{className:"right-list-wrap"},c.a.createElement(b.a.List,{name:"emusList"},(function(e,t){var a=t.add,r=t.remove;return c.a.createElement(c.a.Fragment,null,e.map((function(e){var t=e.key,a=e.name,n=e.fieldKey,l=N(e,I);return c.a.createElement(p.b,{key:t,style:{display:"flex",marginBottom:8},align:"baseline"},c.a.createElement(b.a.Item,S({},l,{name:[a,"key"],fieldKey:[n,"key"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement("span",null,"-"),c.a.createElement(b.a.Item,S({},l,{name:[a,"value"],fieldKey:[n,"value"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement(g.a,{onClick:function(){return r(a)}}))})),c.a.createElement(b.a.Item,null,c.a.createElement(n.a,{type:"dashed",onClick:function(){!function(e,t){t>12?Object(w.a)({description:"不能超过12条数据",type:"warn"}):e()}(a,e.length)},block:!0,icon:c.a.createElement(h.a,null)},"新加")))})))):"double"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"数值范围"},c.a.createElement("div",{className:"number-input-wrap"},c.a.createElement(b.a.Item,{name:["specs","min"],noStyle:!0,rules:[{required:!0,message:"请输入最小值"}]},c.a.createElement(y.a,{style:{width:"40%"}})),c.a.createElement("span",{style:{margin:"0 10px"}},"至"),c.a.createElement(b.a.Item,{name:["specs","max"],noStyle:!0,rules:[{required:!0,message:"请输入最小值"}]},c.a.createElement(y.a,{style:{width:"40%"}})))),c.a.createElement(b.a.Item,{label:"数值间隔",name:["specs","interval"],rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{name:["specs","multiple"],label:"倍数"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"10"},"10"),c.a.createElement(f.a.Option,{value:"100"},"100"),c.a.createElement(f.a.Option,{value:"1000"},"1000"))),c.a.createElement(b.a.Item,{name:["specs","unit"],label:"单位"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"male"},"male"),c.a.createElement(f.a.Option,{value:"female"},"female"),c.a.createElement(f.a.Option,{value:"other"},"other")))):null})),c.a.createElement(b.a.Item,{label:"数据传输类型",name:"accessMode"},c.a.createElement(d.a.Group,null,c.a.createElement(d.a,{value:"rw"},"可下发可上报"),c.a.createElement(d.a,{value:"w"},"可下发"),c.a.createElement(d.a,{value:"r"},"可上报"))))}M=Object(l.forwardRef)(M);var R=0,D=[];function L(e,t){var a=e.actionData,r=e.sentReq,i=e.modelType,o=x(b.a.useForm(),1)[0];Object(l.useImperativeHandle)(t,(function(){return{onFinish:O}}));var u=x(Object(l.useState)(0),2),s=u[0],m=u[1];function p(e){var t=JSON.parse(JSON.stringify(e));if(R++,t&&D.push(t),R===v.length&&D.length===R){var a=o.getFieldsValue(),n={};(a=JSON.parse(JSON.stringify(a))).outputData=D,n.content=a,r(n)}}var f=Object(l.useMemo)((function(){var e={input:[],output:[]};return a.funcParamList.forEach((function(t){var a={name:t.name,identifier:t.identifier,type:t.dataTypeEN};if("enum"===t.dataTypeEN){var n=[];for(var r in t.propertyMap)n.push({key:r,value:t.propertyMap[r]});a.emusList=n}else if("double"===t.dataTypeEN){var l={};["interval","min","max","multiple","unit"].forEach((function(e){l[e]=t.propertyMap[e]})),a.specs=l}else if("bool"===t.dataTypeEN){var c={1:t.propertyMap[1],0:t.propertyMap[0]};a.specs=c}e.output.push(a)})),e}),[]),E=x(Object(l.useState)(f.output),2),v=E[0],g=E[1],O=function(){var e=k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D=[],R=0,o.validateFields().then((function(e){m(s+1)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},form:o,initialValues:{name:a.funcName,identifier:a.funcIdentifier,type:a.eventType}},c.a.createElement(b.a.Item,{label:"功能点名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"标识符",name:"identifier",rules:[{required:!0}]},1==i?c.a.createElement("span",null,a.funcIdentifier):c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"事件类型",name:"type"},c.a.createElement(d.a.Group,{options:P})),c.a.createElement(b.a.Item,{label:"输出参数"},c.a.createElement(n.a,{type:"dashed",onClick:function(){g((function(e){var t=JSON.parse(JSON.stringify(e));return t.push({}),t}))},style:{width:"60%"},icon:c.a.createElement(h.a,null)},"添加参数"))),v.map((function(e,t){return c.a.createElement(U,{sentAddData:p,refIndex:t,isCheck:s,type:!0,key:"params"+t,data:e})})))}L=Object(l.forwardRef)(L);var q=0,V=[],J=[];function K(e,t){var a=e.sentReq,r=e.actionData,i=e.modelType,o=x(b.a.useForm(),1)[0],u=Object(l.useMemo)((function(){var e={input:[],output:[]};return r.funcParamList.forEach((function(t){var a={name:t.name,identifier:t.identifier,type:t.dataTypeEN};if("enum"===t.dataTypeEN){var n=[];for(var r in t.propertyMap)n.push({key:r,value:t.propertyMap[r]});a.emusList=n}else if("double"===t.dataTypeEN){var l={};["interval","min","max","multiple","unit"].forEach((function(e){l[e]=t.propertyMap[e]})),a.specs=l}else if("bool"===t.dataTypeEN){var c={1:t.propertyMap[1],0:t.propertyMap[0]};a.specs=c}"输出"===t.type?e.output.push(a):e.input.push(a)})),e}),[]),s=x(Object(l.useState)(u.input),2),m=s[0],d=s[1],p=x(Object(l.useState)(u.output),2),f=p[0],E=p[1],v=x(Object(l.useState)(0),2),g=v[0],O=v[1],w=function(e){e?d((function(e){var t=JSON.parse(JSON.stringify(e));return t.push({}),t})):E((function(e){var t=JSON.parse(JSON.stringify(e));return t.push({}),t}))},I=function(e,t){var n=JSON.parse(JSON.stringify(e));if(q++,t&&n?V.push(n):n&&J.push(n),q===m.length+f.length&&V.length+J.length===q){var r=o.getFieldsValue(),l={};(r=JSON.parse(JSON.stringify(r))).outputData=J,r.inputData=V,l.content=r,a(l)}},j=function(){var e=k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q=0,V=[],J=[],o.validateFields().then((function(e){O(g+1)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.useImperativeHandle)(t,(function(){return{onFinish:j}})),c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16},form:o,initialValues:{name:r.funcName,identifier:r.funcIdentifier}},c.a.createElement(b.a.Item,{label:"功能点名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"标识符",name:"identifier",rules:[{required:!0}]},1==i?c.a.createElement("span",null,r.funcIdentifier):c.a.createElement(y.a,null))),c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16}},c.a.createElement(b.a.Item,{label:"输入参数"},c.a.createElement(n.a,{type:"dashed",onClick:function(){w(!0)},style:{width:"60%"},icon:c.a.createElement(h.a,null)},"添加参数"))),m.map((function(e,t){return c.a.createElement(U,{sentAddData:I,refIndex:t,isCheck:g,type:!0,key:"input"+t,data:e})})),c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16}},c.a.createElement(b.a.Item,{label:"输出参数"},c.a.createElement(n.a,{type:"dashed",onClick:function(){w(!1)},style:{width:"60%"},icon:c.a.createElement(h.a,null)},"添加参数"))),f.map((function(e,t){return c.a.createElement(U,{sentAddData:I,refIndex:t,isCheck:g,type:!1,key:"outputt"+t,data:e})})))}function U(e,t){var a=e.sentAddData,r=e.type,i=e.data,o=e.isCheck,u=(e.refIndex,x(b.a.useForm(),1)[0]);Object(l.useEffect)((function(){o&&s()}),[o]);var s=function(){var e=k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.validateFields().then((function(e){var t={content:{}};if("bool"===(e=JSON.parse(JSON.stringify(e))).type)t.content=e;else if("enum"===e.type){var n=e.emusList.filter((function(e){if(e.key&&e.value)return e})).reduce((function(e,t){return e[t.key.toString()]=t.value,e}),{});e.specs=n,t.content=e}else("text"===e.type||"double"===e.type)&&(t.content=e);t.content.dataType={type:t.content.type,specs:t.content.specs},delete t.content.type,delete t.content.specs,a(t.content,r)})).catch((function(e){a(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"add-tempele-wrap add-params-wrap"},c.a.createElement(b.a,{form:u,initialValues:i,labelCol:{span:8},wrapperCol:{span:16}},c.a.createElement(b.a.Item,{label:"参数名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"参数标识",name:"identifier",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"数据类型",name:"type",rules:[{required:!0}]},c.a.createElement(f.a,{allowClear:!0},A.map((function(e){return c.a.createElement(f.a.Option,{key:e.value,value:e.value},e.label)})))),c.a.createElement(b.a.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.type!==t.type}},(function(e){var t=e.getFieldValue;return"bool"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"布尔值",rules:[{required:!0}]},c.a.createElement(b.a.Item,{name:["specs","0"],label:"0"},c.a.createElement(y.a,{placeholder:"参数描述"})),c.a.createElement(b.a.Item,{name:["specs","1"],label:"1"},c.a.createElement(y.a,{placeholder:"参数描述"})))):"enum"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"枚举型:",name:"enumus_text",className:"enums-lise-nobottom"},c.a.createElement("span",{style:{marginRight:"50px"}},"参数值"),"-",c.a.createElement("span",{style:{marginLeft:"30px"}},"参数描述")),c.a.createElement("div",{className:"right-list-wrap"},c.a.createElement(b.a.List,{name:"emusList"},(function(e,t){var a=t.add,r=t.remove;return c.a.createElement(c.a.Fragment,null,e.map((function(e){var t=e.key,a=e.name,n=e.fieldKey,l=N(e,j);return c.a.createElement(p.b,{key:t,style:{display:"flex",marginBottom:8},align:"baseline"},c.a.createElement(b.a.Item,S({},l,{name:[a,"key"],fieldKey:[n,"key"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement("span",null,"-"),c.a.createElement(b.a.Item,S({},l,{name:[a,"value"],fieldKey:[n,"value"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement(g.a,{onClick:function(){return r(a)}}))})),c.a.createElement(b.a.Item,null,c.a.createElement(n.a,{type:"dashed",onClick:function(){!function(e,t){t>12?Object(w.a)({description:"不能超过12条数据",type:"warn"}):e()}(a,e.length)},block:!0,icon:c.a.createElement(h.a,null)},"新加")))})))):"double"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"数值范围"},c.a.createElement("div",{className:"number-input-wrap"},c.a.createElement(b.a.Item,{name:["specs","min"],noStyle:!0,rules:[{required:!0,message:"请输入最小值"}]},c.a.createElement(y.a,{style:{width:"40%"}})),c.a.createElement("span",{style:{margin:"0 10px"}},"至"),c.a.createElement(b.a.Item,{name:["specs","max"],noStyle:!0,rules:[{required:!0,message:"请输入最大值"}]},c.a.createElement(y.a,{style:{width:"40%"}})))),c.a.createElement(b.a.Item,{label:"数值间隔",name:["specs","interval"],rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{name:["specs","multiple"],label:"倍数"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"10"},"10"),c.a.createElement(f.a.Option,{value:"100"},"100"),c.a.createElement(f.a.Option,{value:"1000"},"1000"))),c.a.createElement(b.a.Item,{name:["specs","unit"],label:"单位"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"cal"},"卡路里")))):null}))))}K=Object(l.forwardRef)(K);a("k3Gp");var z=a("kLXV"),H=(a("PvDj"),a("mbEz"),a("wCAj")),B=(a("MKzF"),a("kaz8")),_=(a("ma9I"),a("7EV8"));function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return W(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function G(e){var t=e.dataSource,a=e.refreshCount,n=(Object(i.useHistory)(),$(Object(l.useState)([]),2)),r=n[0],o=n[1];Object(l.useEffect)((function(){a(r)}),[r.length]);var u=[{title:"勾选",width:"80px",render:function(e,a,n){var r=Object(_.a)(t,"funcIdentifier",n,a.funcIdentifier,"funcIdentifier");return r.children=c.a.createElement(B.a,{onChange:function(e){!function(e,t){var a=e.target.checked,n=JSON.parse(sessionStorage.getItem("productItem")).productId;o((function(e){var r={id:t.id,funcType:t.funcType,identifier:t.funcIdentifier,productId:n},l=JSON.parse(JSON.stringify(e));return a?l.push(r):l=l.filter((function(e){if(e.identifier!==t.funcIdentifier)return e})),l}))}(e,a)}}),r}},{title:"功能类型",dataIndex:"funcTypeCN",render:function(e,a,n){return Object(_.a)(t,"funcIdentifier",n,e,"funcTypeCN")}},{title:"功能点名称",dataIndex:"funcName",render:function(e,a,n){return Object(_.a)(t,"funcIdentifier",n,e,"funcName")}},{title:"标识符",dataIndex:"funcIdentifier",render:function(e,a,n){return Object(_.a)(t,"funcIdentifier",n,e,"funcIdentifier")}},{title:"参数名称",dataIndex:"name"},{title:"参数标识",dataIndex:"identifier"},{title:"数据传输类型",dataIndex:"accessMode",render:function(e,t){return"rw"==e?"可下发可上报":"w"==e?"可下发":"r"==e?"可上报":""}},{title:"数据类型",dataIndex:"dataType",render:function(e,t){return c.a.createElement("span",null,t.dataTypCN)}},{title:"数据属性",dataIndex:"propertyMap",render:function(e,t){return c.a.createElement("span",null,function(e){var t=null;switch(e.dataTypeEN){case"double":t="数值范围：".concat(e.propertyMap.min,"-").concat(e.propertyMap.max,",间距：").concat(e.propertyMap.interval,",倍数：").concat(e.propertyMap.multiple,",单位：").concat(e.propertyMap.unit);break;case"bool":t="0：".concat(e.propertyMap[0],",1：").concat(e.propertyMap[1]);break;case"enum":var a="";for(var n in e.propertyMap)a+=e.propertyMap[n]+"，";t="枚举值：".concat(a);break;default:return""}return t}(t))}}];return c.a.createElement("div",null,c.a.createElement(H.a,{rowKey:"key",columns:u,dataSource:t,pagination:!1,scroll:{y:440}}))}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){ee(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ee(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function te(e){var t=[];return e.forEach((function(e){e.funcParamList&&e.funcParamList.length&&e.funcParamList.forEach((function(a){var n=JSON.parse(JSON.stringify(e));t.push(X(X({},n),a))}))})),t.forEach((function(e,t){e.key=t})),t}function ae(e){var t=e.isModalVisible,a=e.closeAdd,n=e.CancelAdd,r=JSON.parse(sessionStorage.getItem("productItem"));console.log(r);var i=v.a.TabPane,o=y.a.Search,u=f.a.Option,s=Z(Object(l.useState)("1"),2),m=s[0],d=s[1],p=Z(Object(l.useState)([]),2),b=p[0],E=p[1],g=Z(Object(l.useState)([]),2),h=g[0],I=g[1],j=Z(Object(l.useState)([]),2),S=j[0],N=j[1];Object(l.useEffect)((function(){var e;e={deviceTypeId:r.deviceTypeId,productId:r.productId,eq:!0},Object(O.c)(O.a.PhysicalModelList,e).then((function(e){E(te(e.data))})),function(){var e={productId:r.productId,eq:!0,deviceTypeId:14};Object(O.c)(O.a.PhysicalModelList,e).then((function(e){I(te(e.data))}))}(),Object(O.c)(O.a.getThirdCategory).then((function(e){N(e.data)}))}),[]);var C=Z(Object(l.useState)(14),2),k=C[0],x=C[1],T=Z(Object(l.useState)(""),2),A=T[0],P=T[1],F=function(){var e={deviceTypeId:k,eq:!0,productId:r.productId,funcName:A};Object(O.c)(O.a.PhysicalModelList,e).then((function(e){I(te(e.data))}))},M=Z(Object(l.useState)([]),2),R=M[0],D=M[1],L=Z(Object(l.useState)([]),2),q=L[0],V=L[1];return c.a.createElement("div",null,c.a.createElement(z.a,{title:"新增标准功能",visible:t,onOk:function(){R.length||q.length?"1"===m?Object(O.c)(O.a.addPhticalStard,R).then((function(e){a()})):Object(O.c)(O.a.addPhticalStard,q).then((function(e){a()})):Object(w.a)({description:"至少勾选一条数据",type:"warn"})},onCancel:n,width:"1200px",wrapClassName:"add-protocols-wrap"},c.a.createElement(v.a,{activeKey:m,onChange:function(e){d(e)}},c.a.createElement(i,{tab:"本品类",key:"1"},c.a.createElement("div",{className:"add-protocols-count"},"已选择".concat(R.length,"项")),c.a.createElement(G,{dataSource:b,refreshCount:function(e){D(e)}})),c.a.createElement(i,{tab:"其他品类",key:"2"},c.a.createElement("div",{className:"other-product-top"},c.a.createElement(o,{placeholder:"搜索功能点名称",value:A,onChange:function(e){P(e.target.value)},onSearch:F,style:{width:465}}),c.a.createElement(f.a,{style:{width:142},onChange:function(e){x(e),F()}},S.map((function(e){return c.a.createElement(u,{value:e.deviceTypeId,key:e.deviceTypeId},e.deviceTypeName)})))),c.a.createElement("div",null,c.a.createElement(G,{dataSource:h,refreshCount:function(e){V(e)}}))))))}var ne=["key","name","fieldKey"],re=["key","name","fieldKey"];function le(){return(le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ce(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function ie(e,t,a,n,r,l,c){try{var i=e[l](c),o=i.value}catch(e){return void a(e)}i.done?t(o):Promise.resolve(o).then(n,r)}function oe(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function c(e){ie(l,n,r,c,i,"next",e)}function i(e){ie(l,n,r,c,i,"throw",e)}c(void 0)}))}}function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var me=[{label:"属性",value:"properties"},{label:"事件",value:"events"},{label:"服务",value:"services"}],de=[{value:"bool",label:"布尔型"},{value:"enum",label:"枚举型"},{value:"text",label:"字符型"},{value:"double",label:"数值型"}],pe=[{label:"故障",value:"fault"},{label:"告警",value:"alarm"},{label:"信息",value:"info"}];function fe(e){var t=e.rightVisible,a=e.onCloseRight,r=e.onRefreshList,i=v.a.TabPane;Object(l.useEffect)((function(){}),[]);var o=ue(Object(l.useState)("properties"),2),u=o[0],s=o[1],m=function(e){s(e.target.value)},p=Object(l.useRef)(),f=Object(l.useRef)(),y=Object(l.useRef)(),b=function(e){e.funcType=u,e.type="add";var t=JSON.parse(sessionStorage.getItem("productItem"));e.productId=t.productId,e.content.standard=!1,console.log(e,"要提交的数据"),e.content=JSON.stringify(e.content),Object(O.c)(O.a.PhysicalModelAction,e).then((function(e){r()}))};return c.a.createElement(E.a,{title:"新增自定义功能",placement:"right",closable:!1,onClose:a,visible:t,destroyOnClose:!0,width:393,footer:c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(n.a,{onClick:a,style:{marginRight:8}},"取消"),c.a.createElement(n.a,{onClick:function(){"properties"===u?p.current.onFinish():"events"===u?f.current.onFinish():"services"===u&&y.current.onFinish()},type:"primary"},"确定"))},c.a.createElement("div",{className:"edit-left-protocol-wrap"}," ",c.a.createElement(v.a,{activeKey:u,defaultActiveKey:"properties",renderTabBar:function(e,t){var a=[];return e.panes.forEach((function(e){a.push({key:e.key,title:e.props.tab})})),c.a.createElement("div",{className:"addcus-tab"}," ",c.a.createElement(d.a.Group,{buttonStyle:"solid",optionType:"button",value:u,onChange:m,options:me}))}},c.a.createElement(i,{tab:"Tab 1",key:"properties"},c.a.createElement(ye,{ref:p,currentTab:u,sentReq:b})),c.a.createElement(i,{tab:"Tab 2",key:"events"},c.a.createElement(ve,{ref:f,sentReq:b,key:"events"})),c.a.createElement(i,{tab:"Tab 3",key:"services"},c.a.createElement(we,{ref:y,sentReq:b})))))}function ye(e,t){e.currentTab;var a=e.sentReq,r=ue(b.a.useForm(),1)[0],i=function(){var e=oe(regeneratorRuntime.mark((function e(){var t,n,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.validateFields();case 3:t=e.sent,t=JSON.parse(JSON.stringify(t)),(n={}).content={},"bool"===t.type?n.content=t:"enum"===t.type?(l=t.emusList.filter((function(e){if(e.key&&e.value)return e})),c=l.reduce((function(e,t){return e[t.key.toString()]=t.value,e}),{}),t.specs=c,n.content=t):("text"===t.type||"double"===t.type)&&(n.content=t),n.content.dataType={type:n.content.type,specs:n.content.specs},delete n.content.type,delete n.content.specs,a(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();Object(l.useImperativeHandle)(t,(function(){return{onFinish:i}}));return c.a.createElement(b.a,{name:"numberT",labelCol:{span:8},wrapperCol:{span:16},form:r},c.a.createElement(b.a.Item,{label:"功能点名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"标识符",name:"identifier",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"数据类型",name:"type"},c.a.createElement(f.a,{allowClear:!0,onChange:function(e){console.log(e)}},de.map((function(e){return c.a.createElement(f.a.Option,{key:e.value,value:e.value},e.label)})))),c.a.createElement(b.a.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.type!==t.type}},(function(e){var t=e.getFieldValue;return"bool"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"布尔值",rules:[{required:!0}]},c.a.createElement(b.a.Item,{name:["specs","0"],label:"0"},c.a.createElement(y.a,{placeholder:"参数描述"})),c.a.createElement(b.a.Item,{name:["specs","1"],label:"1"},c.a.createElement(y.a,{placeholder:"参数描述"})))):"enum"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"枚举型:",name:"enumus_text",className:"enums-lise-nobottom"},c.a.createElement("span",{style:{marginRight:"50px"}},"参数值"),"-",c.a.createElement("span",{style:{marginLeft:"30px"}},"参数描述")),c.a.createElement("div",{className:"right-list-wrap"},c.a.createElement(b.a.List,{name:"emusList"},(function(e,t){var a=t.add,r=t.remove;return c.a.createElement(c.a.Fragment,null,e.map((function(e){var t=e.key,a=e.name,n=e.fieldKey,l=ce(e,ne);return c.a.createElement(p.b,{key:t,style:{display:"flex",marginBottom:8},align:"baseline"},c.a.createElement(b.a.Item,le({},l,{name:[a,"key"],fieldKey:[n,"key"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement("span",null,"-"),c.a.createElement(b.a.Item,le({},l,{name:[a,"value"],fieldKey:[n,"value"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement(g.a,{onClick:function(){return r(a)}}))})),c.a.createElement(b.a.Item,null,c.a.createElement(n.a,{type:"dashed",onClick:function(){!function(e,t){t>12?Object(w.a)({description:"不能超过12条数据",type:"warn"}):e()}(a,e.length)},block:!0,icon:c.a.createElement(h.a,null)},"新加")))})))):"double"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"数值范围"},c.a.createElement("div",{className:"number-input-wrap"},c.a.createElement(b.a.Item,{name:["specs","min"],noStyle:!0,rules:[{required:!0,message:"请输入最小值"}]},c.a.createElement(y.a,{style:{width:"40%"}})),c.a.createElement("span",{style:{margin:"0 10px"}},"至"),c.a.createElement(b.a.Item,{name:["specs","max"],noStyle:!0,rules:[{required:!0,message:"请输入最小值"}]},c.a.createElement(y.a,{style:{width:"40%"}})))),c.a.createElement(b.a.Item,{label:"数值间隔",name:["specs","interval"],rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{name:["specs","multiple"],label:"倍数"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"10"},"10"),c.a.createElement(f.a.Option,{value:"100"},"100"),c.a.createElement(f.a.Option,{value:"1000"},"1000"))),c.a.createElement(b.a.Item,{name:["specs","unit"],label:"单位"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"male"},"male"),c.a.createElement(f.a.Option,{value:"female"},"female"),c.a.createElement(f.a.Option,{value:"other"},"other")))):null})),c.a.createElement(b.a.Item,{label:"数据传输类型",name:"accessMode"},c.a.createElement(d.a.Group,null,c.a.createElement(d.a,{value:"rw"},"可下发可上报"),c.a.createElement(d.a,{value:"w"},"可下发"),c.a.createElement(d.a,{value:"r"},"可上报"))))}ye=Object(l.forwardRef)(ye);var be=0,Ee=[];function ve(e,t){e.currentTab;var a=e.sentReq,r=ue(b.a.useForm(),1)[0];Object(l.useImperativeHandle)(t,(function(){return{onFinish:E}}));var i=ue(Object(l.useState)(0),2),o=i[0],u=i[1];function s(e){var t=JSON.parse(JSON.stringify(e));if(be++,t&&Ee.push(t),be===p.length&&Ee.length===be){var n=r.getFieldsValue(),l={};(n=JSON.parse(JSON.stringify(n))).outputData=Ee,l.content=n,a(l)}}var m=ue(Object(l.useState)([]),2),p=m[0],f=m[1],E=function(){var e=oe(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ee=[],be=0,r.validateFields().then((function(e){u(o+1)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},form:r},c.a.createElement(b.a.Item,{label:"功能点名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"标识符",name:"identifier",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"事件类型",name:"type"},c.a.createElement(d.a.Group,{options:pe})),c.a.createElement(b.a.Item,{label:"输出参数"},c.a.createElement(n.a,{type:"dashed",onClick:function(){f((function(e){var t=JSON.parse(JSON.stringify(e));return t.push({}),t}))},style:{width:"60%"},icon:c.a.createElement(h.a,null)},"添加参数"))),p.map((function(e,t){return c.a.createElement(Ie,{sentAddData:s,refIndex:t,isCheck:o,type:!0,key:"params"+t,data:e})})))}ve=Object(l.forwardRef)(ve);var ge=0,he=[],Oe=[];function we(e,t){var a=e.sentReq,r=ue(b.a.useForm(),1)[0],i=ue(Object(l.useState)([]),2),o=i[0],u=i[1],s=ue(Object(l.useState)([]),2),m=s[0],d=s[1],p=ue(Object(l.useState)(0),2),f=p[0],E=p[1],v=function(e){e?u((function(e){var t=JSON.parse(JSON.stringify(e));return t.push({}),t})):d((function(e){var t=JSON.parse(JSON.stringify(e));return t.push({}),t}))},g=function(e,t){var n=JSON.parse(JSON.stringify(e));if(ge++,t&&n?he.push(n):n&&Oe.push(n),ge===o.length+m.length&&he.length+Oe.length===ge){var l=r.getFieldsValue(),c={};(l=JSON.parse(JSON.stringify(l))).outputData=Oe,l.inputData=he,c.content=l,a(c)}},O=function(){var e=oe(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ge=0,he=[],Oe=[],r.validateFields().then((function(e){E(f+1)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.useImperativeHandle)(t,(function(){return{onFinish:O}})),c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16},form:r},c.a.createElement(b.a.Item,{label:"功能点名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"标识符",name:"identifier",rules:[{required:!0}]},c.a.createElement(y.a,null))),c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16}},c.a.createElement(b.a.Item,{label:"输入参数"},c.a.createElement(n.a,{type:"dashed",onClick:function(){v(!0)},style:{width:"60%"},icon:c.a.createElement(h.a,null)},"添加参数"))),o.map((function(e,t){return c.a.createElement(Ie,{sentAddData:g,refIndex:t,isCheck:f,type:!0,key:"input"+t,data:e})})),c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16}},c.a.createElement(b.a.Item,{label:"输出参数"},c.a.createElement(n.a,{type:"dashed",onClick:function(){v(!1)},style:{width:"60%"},icon:c.a.createElement(h.a,null)},"添加参数"))),m.map((function(e,t){return c.a.createElement(Ie,{sentAddData:g,refIndex:t,isCheck:f,type:!1,key:"outputt"+t,data:e})})))}function Ie(e,t){var a=e.sentAddData,r=e.type,i=(e.data,e.isCheck),o=(e.refIndex,ue(b.a.useForm(),1)[0]);Object(l.useEffect)((function(){i&&u()}),[i]);var u=function(){var e=oe(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.validateFields().then((function(e){var t={content:{}};if("bool"===(e=JSON.parse(JSON.stringify(e))).type)t.content=e;else if("enum"===e.type){var n=e.emusList.filter((function(e){if(e.key&&e.value)return e})).reduce((function(e,t){return e[t.key.toString()]=t.value,e}),{});e.specs=n,t.content=e}else("text"===e.type||"double"===e.type)&&(t.content=e);t.content.dataType={type:t.content.type,specs:t.content.specs},delete t.content.type,delete t.content.specs,a(t.content,r)})).catch((function(e){a(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"add-tempele-wrap add-params-wrap"},c.a.createElement(b.a,{form:o,labelCol:{span:8},wrapperCol:{span:16}},c.a.createElement(b.a.Item,{label:"参数名称",name:"name",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"参数标识",name:"identifier",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"数据类型",name:"type",rules:[{required:!0}]},c.a.createElement(f.a,{allowClear:!0},de.map((function(e){return c.a.createElement(f.a.Option,{key:e.value,value:e.value},e.label)})))),c.a.createElement(b.a.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.type!==t.type}},(function(e){var t=e.getFieldValue;return"bool"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"布尔值",rules:[{required:!0}]},c.a.createElement(b.a.Item,{name:["specs","0"],label:"0"},c.a.createElement(y.a,{placeholder:"参数描述"})),c.a.createElement(b.a.Item,{name:["specs","1"],label:"1"},c.a.createElement(y.a,{placeholder:"参数描述"})))):"enum"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"枚举型:",name:"enumus_text",className:"enums-lise-nobottom"},c.a.createElement("span",{style:{marginRight:"50px"}},"参数值"),"-",c.a.createElement("span",{style:{marginLeft:"30px"}},"参数描述")),c.a.createElement("div",{className:"right-list-wrap"},c.a.createElement(b.a.List,{name:"emusList"},(function(e,t){var a=t.add,r=t.remove;return c.a.createElement(c.a.Fragment,null,e.map((function(e){var t=e.key,a=e.name,n=e.fieldKey,l=ce(e,re);return c.a.createElement(p.b,{key:t,style:{display:"flex",marginBottom:8},align:"baseline"},c.a.createElement(b.a.Item,le({},l,{name:[a,"key"],fieldKey:[n,"key"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement("span",null,"-"),c.a.createElement(b.a.Item,le({},l,{name:[a,"value"],fieldKey:[n,"value"],className:"enums-lise-nobottom",noStyle:!0}),c.a.createElement(y.a,null)),c.a.createElement(g.a,{onClick:function(){return r(a)}}))})),c.a.createElement(b.a.Item,null,c.a.createElement(n.a,{type:"dashed",onClick:function(){!function(e,t){t>12?Object(w.a)({description:"不能超过12条数据",type:"warn"}):e()}(a,e.length)},block:!0,icon:c.a.createElement(h.a,null)},"新加")))})))):"double"===t("type")?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a.Item,{label:"数值范围"},c.a.createElement("div",{className:"number-input-wrap"},c.a.createElement(b.a.Item,{name:["specs","min"],noStyle:!0,rules:[{required:!0,message:"请输入最小值"}]},c.a.createElement(y.a,{style:{width:"40%"}})),c.a.createElement("span",{style:{margin:"0 10px"}},"至"),c.a.createElement(b.a.Item,{name:["specs","max"],noStyle:!0,rules:[{required:!0,message:"请输入最大值"}]},c.a.createElement(y.a,{style:{width:"40%"}})))),c.a.createElement(b.a.Item,{label:"数值间隔",name:["specs","interval"],rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{name:["specs","multiple"],label:"倍数"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"10"},"10"),c.a.createElement(f.a.Option,{value:"100"},"100"),c.a.createElement(f.a.Option,{value:"1000"},"1000"))),c.a.createElement(b.a.Item,{name:["specs","unit"],label:"单位"},c.a.createElement(f.a,{allowClear:!0},c.a.createElement(f.a.Option,{value:"cal"},"卡路里")))):null}))))}we=Object(l.forwardRef)(we);var je=a("JzY+"),Se=a.n(je),Ne=a("rwTb"),Ce=c.a.createContext(0);function ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xe(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Te(e){var t=e.dataSource,a=e.reFreshData,r=e.type,i=ke(Object(l.useState)({pageIndex:1,totalRows:0,pageRows:10}),2),o=i[0],u=i[1],s=Object(l.useMemo)((function(){var e=[];return t.forEach((function(t){e.indexOf(t.funcIdentifier)<0&&e.push(t.funcIdentifier)})),e}),[t]),d=ke(Object(l.useState)(!1),2),f=d[0],y=d[1],b=ke(Object(l.useState)({}),2),E=b[0],v=b[1],g=ke(Object(l.useState)(!1),2),h=g[0],I=g[1],j=function(){var e=(o.pageIndex-1)*o.pageRows;return t.slice(e,e+10)},S=[{title:"DP ID",dataIndex:"key",render:function(e,t,a){var n=Object(_.a)(j(),"funcIdentifier",a,t.funcIdentifier,"funcIdentifier");return n.children=c.a.createElement("span",null,s.indexOf(t.funcIdentifier)+1),n}},{title:"功能类型",dataIndex:"funcTypeCN",render:function(e,t,a){return Object(_.a)(j(),"funcIdentifier",a,e,"funcTypeCN")}},{title:"功能点名称",dataIndex:"funcName",render:function(e,t,a){return Object(_.a)(j(),"funcIdentifier",a,e,"funcName")}},{title:"标识符",dataIndex:"funcIdentifier",render:function(e,t,a){return Object(_.a)(j(),"funcIdentifier",a,e,"funcIdentifier")}},{title:"参数名称",dataIndex:"name",render:function(e,t){return e}},{title:"参数标识",dataIndex:"identifier"},{title:"数据传输类型",dataIndex:"accessMode",render:function(e,t){return"rw"==e?"可下发可上报":"w"==e?"可下发":"r"==e?"可上报":""}},{title:"数据类型",dataIndex:"dataType",render:function(e,t){return c.a.createElement("span",null,t.dataTypCN)}},{title:"数据属性",dataIndex:"propertyMap",render:function(e,t){return c.a.createElement("span",null,function(e){var t=null;switch(e.dataTypeEN){case"double":t="数值范围：".concat(e.propertyMap.min,"-").concat(e.propertyMap.max,",间距：").concat(e.propertyMap.interval,",倍数：").concat(e.propertyMap.multiple,",单位：").concat(e.propertyMap.unit);break;case"bool":t="0：".concat(e.propertyMap[0],",1：").concat(e.propertyMap[1]);break;case"enum":var a="";for(var n in e.propertyMap)a+=e.propertyMap[n]+"，";t="枚举值：".concat(a);break;default:return""}return t}(t))}},{title:"操作",render:function(e,t,a){var r=Object(_.a)(j(),"funcIdentifier",a,t.funcIdentifier,"funcIdentifier");return r.children=c.a.createElement(p.b,{size:"middle"},c.a.createElement(n.a,{type:"link",onClick:function(){v(t),I(!0)}},"编辑"),c.a.createElement(n.a,{type:"link",onClick:function(){v(t),y(!0)}},"删除")),r}}];return c.a.createElement("div",null,c.a.createElement(H.a,{rowKey:"key",columns:S,dataSource:t,locale:{emptyText:"1"==r?"暂无标准功能":"暂无自定义功能"},pagination:{defaultCurrent:1,current:o.pageIndex,onChange:function(e,t){t===o.pageRows?u((function(a){var n=JSON.parse(JSON.stringify(a));return Object.assign(n,{pageIndex:e,pageRows:t})})):u((function(e){var a=JSON.parse(JSON.stringify(e));return Object.assign(a,{pageIndex:1,pageRows:t})}))},pageSize:o.pageRows,total:o.totalRows,showQuickJumper:!1,pageSizeOptions:[10],showTotal:function(){return c.a.createElement("span",null,"共 ",c.a.createElement("a",null,s.length)," 条")}}}),h&&c.a.createElement(F,{rightVisible:h,onCloseRight:function(){I(!1)},onRefreshList:function(){I(!1),Object(w.a)({type:"success",description:"编辑成功！"}),a()},actionData:E,modelType:r}),f&&c.a.createElement(m.a,{visible:f,modalOKHandle:function(){var e=JSON.stringify({identifier:E.funcIdentifier}),t={productId:JSON.parse(sessionStorage.getItem("productItem")).productId,type:"delete",content:e,funcType:E.funcType};Object(O.c)(O.a.PhysicalModelAction,t).then((function(e){Object(w.a)({type:"success",description:"删除成功！"}),y(!1),a()}))},modalCancelHandle:function(){y(!1)},targetName:E.funcName,title:"删除",descGray:!0,needWarnIcon:!0,descText:"确定删除此功能"}))}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(a),!0).forEach((function(t){Re(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Re(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function De(e){var t=[];return e.forEach((function(e){e.funcParamList&&e.funcParamList.length&&e.funcParamList.forEach((function(a){var n=JSON.parse(JSON.stringify(e));t.push(Me(Me({},n),a))}))})),t.forEach((function(e,t){e.key=t})),t}function Le(e,t){var a=e.nextStep,r=e.productId,i=Ae(Object(l.useState)([]),2),o=i[0],u=i[1],s=Ae(Object(l.useState)([]),2),m=s[0],d=s[1],p=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(O.c)(O.a.standardFnList,{productId:r},{loading:e}).then((function(e){d(De(e.data.standard));var t=De(e.data.custom);u(t)}))};Object(l.useEffect)((function(){p()}),[]);var f=Ae(Object(l.useState)(!1),2),y=f[0],b=f[1],E=Ae(Object(l.useState)(!1),2),v=E[0],g=E[1],h=function(){a()},I=Object(l.useRef)();return Object(l.useImperativeHandle)(t,(function(){return{onFinish:h}})),c.a.createElement("div",{className:"Protocol-wrap",ref:I},c.a.createElement("div",{className:"Protocol-label"},c.a.createElement("div",null,"独立MCU方案，需选择下载MCU开发资料包等，进行相应开发"),c.a.createElement("div",{className:"Protocol-download",onClick:function(){var e=O.a.downPhysicalModel+"?productId="+r;window.open(e)}},c.a.createElement("a",null,"导出物模型"),c.a.createElement("img",{src:Se.a,alt:""}))),c.a.createElement("div",{className:"Protocol-download"},c.a.createElement("div",null,"标准功能",c.a.createElement(Ne.a,{tip:"支持用户编辑修改功能点名称以及数值范围，但是不能修改功能点的数据标识、数据类型，数据传输类型。"})),c.a.createElement(n.a,{type:"primary",onClick:function(){g(!0)}},"新建标准功能")),c.a.createElement("div",{className:"Protocol-table"},c.a.createElement(Te,{dataSource:m,reFreshData:p,type:"1"})),c.a.createElement("div",{className:"Protocol-download"},c.a.createElement("div",null,"自定义功能",c.a.createElement(Ne.a,{tip:"支持在标准功能的基础上，自定义适合客户自己硬件特色的定制功能点。"})),c.a.createElement("div",null,c.a.createElement("a",null,"导出协议"),c.a.createElement("img",{src:Se.a,style:{marginRight:"15px"},alt:""}),c.a.createElement(n.a,{type:"primary",onClick:function(){b(!0)}},"新建自定义功能"))),c.a.createElement("div",null,c.a.createElement(Te,{dataSource:o,reFreshData:p,type:"2"})),y&&c.a.createElement(fe,{rightVisible:y,onCloseRight:function(){b(!1)},onRefreshList:function(){b(!1),Object(w.a)({type:"success",description:"新增成功！"}),p()}}),v&&c.a.createElement(ae,{closeAdd:function(){g(!1),Object(w.a)({type:"success",description:"新增成功！"}),p()},CancelAdd:function(){g(!1)},isModalVisible:v}))}var qe=Le=Object(l.forwardRef)(Le),Ve=a("MeRu"),Je=(a("TfFZ"),a("3S7+")),Ke=(a("oVuX"),a("NBAS"),a("SuFq"),a("X72a")),Ue=a("Lyp1");a("SYor"),a("ShEY");function ze(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function He(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(a),!0).forEach((function(t){Be(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ze(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $e(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $e(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var We=y.a.Search;var Ge=function(e){var t=e.title,a=e.desc,n=void 0===a?"":a,r=e.type,i=e.replaceModalVisible,o=e.handleOk,u=e.handleCancel,s=e.schemeId,m=e.moduleId,d=_e(Object(l.useState)("radio"),1)[0],p=[{title:"模组",dataIndex:"moduleName"},{title:"芯片",dataIndex:"originalModuleTypeName"},{title:"尺寸",key:"",render:function(e,t,a){return c.a.createElement("div",null,c.a.createElement("span",null,t.sizeWidth,"x",t.sizeHeight,"x",t.sizeThickness))}},{title:"适用说明",dataIndex:"applyScope"},{title:"调试价格",dataIndex:"price"},{title:"操作",dataIndex:"",render:function(e,t,a){return c.a.createElement("a",null,"说明书")}}],f=_e(Object(l.useState)([]),2),y=f[0],b=f[1],E=_e(Object(l.useState)([m]),2),v=E[0],g=E[1],h={onChange:function(e,t){g(e)}},w=function(e){Object(O.c)(O.a.replaceModuleList,{schemeId:s,moduleName:e},{loading:!0}).then((function(e){console.log(e),b(e.data)}))};return Object(l.useEffect)((function(){w("")}),[]),c.a.createElement(z.a,{title:t,visible:i,onOk:function(){return o(v)},onCancel:function(){return u(r)},maskClosable:!1,width:857,wrapClassName:"replace-module-modal"},n&&c.a.createElement("div",{className:"replace-firmware-desc"},n),c.a.createElement(We,{className:"search-input",placeholder:"输入模组名称",allowClear:!0,onSearch:function(e){e&&e.trim()?w(e.trim()):w("")},style:{width:674}}),c.a.createElement(H.a,{rowSelection:He({type:d,selectedRowKeys:v},h),rowKey:"moduleId",columns:"module"===r?p:[{title:"方案",dataIndex:"name"},{title:"版本",dataIndex:"id"},{title:"适用说明",dataIndex:""}],dataSource:y,pagination:!1}))};a("TWNs"),a("wkzE");function Ze(){return(Ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(a),!0).forEach((function(t){Xe(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ye(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Xe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return tt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var at=JSON.parse(sessionStorage.getItem("productItem"))||{};var nt=function(e){var t=e.freeApplyVisible,a=e.handleFreeApply,n=e.type,r=e.moduleName,i=e.firmwareName,o=et(b.a.useForm(),1)[0],u=et(Object(l.useState)({}),2),s=u[0],m=u[1];return Object(l.useEffect)((function(){Object(O.c)(O.a.showFirmware,{productId:at.productId},{loading:!0}).then((function(e){m(e.data)}))}),[]),c.a.createElement(z.a,{title:"免费申请",visible:t,onOk:function(){o.submit()},onCancel:a,maskClosable:!1,destroyOnClose:!0,width:857,wrapClassName:"replace-module-modal free-apply-modal"},c.a.createElement("div",{className:"free-apply-modal-top"},c.a.createElement("div",{className:"confirm-tip"},"请确认以下信息："),c.a.createElement("div",{className:"f-module-box"},c.a.createElement("div",{className:"f-module-title"},"模组名称：",r||"-"),c.a.createElement("div",{className:"pad22"},c.a.createElement("div",{className:"firmware-msg"},"固件信息"),c.a.createElement("div",null,c.a.createElement(b.a,{labelCol:{span:5},wrapperCol:{span:12}},c.a.createElement(b.a.Item,{label:"固件名称/固件Key",className:"txt-color"},s.burnFileName||"-"),c.a.createElement(b.a.Item,{label:"固件版本",className:"txt-color"},s.burnFileVersion||"-"),s.firmwareModuleList&&s.firmwareModuleList.map((function(e){return e.firmwareFuncList&&e.firmwareFuncList.map((function(e,t){return c.a.createElement(c.a.Fragment,null,"int"===e.dataType.type&&c.a.createElement(b.a.Item,{key:e.funcName,label:e.funcName,className:"txt-color"},e.dataType.specs.defaultValue),"enum"===e.dataType.type&&c.a.createElement(b.a.Item,{key:e.funcName,label:e.funcName,className:"txt-color"},e.dataType.specs.defaultValue[0].k))}))}))))))),c.a.createElement("div",{className:"free-apply-modal-form"},c.a.createElement(b.a,Ze({},{labelCol:{md:{span:3}},wrapperCol:{md:{span:8}}},{form:o,name:"freeApply-form",onFinish:function(e){var t={type:n,moduleName:r,firmwareName:i,productName:at.productName,schemeType:at.schemeType};Object(O.c)(O.a.freeApplyModule,Qe(Qe({},t),e),{loading:!0}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),a()}))}}),c.a.createElement(b.a.Item,{name:"account",label:"产品联系人",rules:[{required:!0,message:"请输入联系人名称"}]},c.a.createElement(y.a,{maxLength:50,placeholder:"请输入联系人名称"})),c.a.createElement(b.a.Item,{name:"tel",label:"联系方式",rules:[{required:!0,pattern:/^(((\d{3,4}-)?\d{7,8})|(1\d{10}))$/,message:"请输入联系方式"}]},c.a.createElement(y.a,{placeholder:"请输入联系方式"})),c.a.createElement(b.a.Item,{name:"address",label:"邮寄地址",rules:[{required:!0,message:"请输入联系邮寄地址"}]},c.a.createElement(y.a,{maxLength:50,placeholder:"请输入联系邮寄地址"})),c.a.createElement(b.a.Item,{name:"num",label:"申请数量",rules:[{required:!0,pattern:new RegExp(/^[0-9]+$/,"g"),message:"请输入申请数量，仅支持数字"}]},c.a.createElement(y.a,{placeholder:"请输入申请数量"})))))};a("B6y2"),a("/DsP");function rt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function lt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return it(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return it(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ot=f.a.Option;function ut(e){var t=e.modifyFirmwareVisible,a=e.handleCancelFirmware,n=e.firmwareId,r=e.productId,i=ct(b.a.useForm(),1)[0],o=ct(Object(l.useState)({}),2),u=o[0],s=o[1],m=ct(Object(l.useState)(""),2),d=m[0],p=m[1];return Object(l.useEffect)((function(){Object(O.c)(O.a.modifyFirmware,{id:n}).then((function(e){e.data.firmwareModuleList.forEach((function(e){e.firmwareFuncList.forEach((function(e){"int"===e.dataType.type&&i.setFieldsValue(lt({},"".concat(e.funcName,"#").concat(e.identifier),e.dataType.specs.defaultValue)),"enum"===e.dataType.type&&(i.setFieldsValue(lt({},"".concat(e.funcName,"#").concat(e.identifier),e.dataType.specs.defaultValue[0].k)),p(e.dataType.specs.defaultValue[0].k))}))})),s(e.data)}))}),[]),c.a.createElement(z.a,{title:"修改固件",visible:t,onOk:function(){i.submit()},onCancel:a,maskClosable:!1,destroyOnClose:!0,width:857,okText:"重新生成固件",wrapClassName:"replace-module-modal"},c.a.createElement("div",{className:"modify-firmware-modal"},c.a.createElement("div",{className:"modify-firmware-modal-left"},c.a.createElement(b.a,{form:i,onFinish:function(e){var t=Object.keys(e),l=Object.values(e),c=t.map((function(e,t){return{funcModule:e.split("#")[0],identifier:e.split("#")[1],value:l[t]}})),i={productId:r,id:n,firmwareConfigReqList:c};console.log("提交的数据",i),Object(O.c)(O.a.saveFirmwareSetting,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(a),!0).forEach((function(t){lt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},i)).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),a()}))},labelCol:{span:8},wrapperCol:{span:15},name:"modify-firmware-form",initialValues:{}},u.firmwareModuleList&&u.firmwareModuleList.map((function(e){return c.a.createElement(c.a.Fragment,{key:e.funcModule},c.a.createElement("div",{className:"modify-firmware-title"},e.funcModule),e.firmwareFuncList&&e.firmwareFuncList.map((function(e){return c.a.createElement(c.a.Fragment,{key:e.identifier},"int"===e.dataType.type&&c.a.createElement(b.a.Item,{label:e.funcName,name:"".concat(e.funcName,"#").concat(e.identifier),key:e.identifier,rules:[{required:!0,message:"请输入".concat(e.funcName)}]},c.a.createElement(y.a,null)),"enum"===e.dataType.type&&c.a.createElement("div",{className:"parent-item"},c.a.createElement(b.a.Item,{label:e.funcName,name:"".concat(e.funcName,"#").concat(e.identifier),key:e.identifier,wrapperCol:{span:10},rules:[{required:!0,message:"选择".concat(e.funcName)}]},c.a.createElement(f.a,{onChange:function(e){return p(e)},allowClear:!0},e.dataType.specs.def&&e.dataType.specs.def.map((function(e){return c.a.createElement(ot,{key:e.k,value:e.k},e.v)})))),c.a.createElement(y.a,{className:"son-item",value:d,disabled:!0,style:{width:100}})))})))})))),c.a.createElement("div",{className:"modify-firmware-modal-right"},c.a.createElement("img",{src:u.pinDiagram,alt:""}))))}a("C8h6");function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=yt(e);if(t){var r=yt(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return ft(this,a)}}function ft(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bt=JSON.parse(sessionStorage.getItem("productItem"))||{},Et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(i,e);var t,n,r,l=pt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=l.call(this,e)).getMoudleInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(O.c)(O.a.getMoudleInfo,{productId:t.props.productId,moduleId:e},{loading:!0}).then((function(e){t.setState({allInfo:e.data}),e.data.firmwareDefList&&(t.setState({dataSource:e.data.firmwareDefList}),t.setState({currentModuleId:e.data.moduleId}),bt.moduleId=e.data.moduleId,sessionStorage.setItem("productItem",JSON.stringify(bt)))}))},t.onFinish=function(e){console.log("验证是否通过:",e),t.props.nextStep()},t.modifyFirmware=function(e,a){console.log(e,"-----"),t.setState({firmwareId:e},(function(){t.setState({modifyFirmwareVisible:!0})}))},t.handleModalOk=function(e,a){console.log("确定选中的id",e),"module"===a&&t.getMoudleInfo(e.join("")),t.setState({replaceModalVisible:!1})},t.handleModalCancel=function(e){console.log("取消"),"module"===e&&t.setState({replaceModalVisible:!1})},t.downInstructions=function(){alert("暂无！")},t.getSchemeType=function(){if(!bt.schemeType)return"";switch(bt.schemeType){case 1:return"免开发方案，只需选择推荐模组以及配置固件信息，快速实现硬件智能化。";case 2:return"独立MCU方案，需选择下载MCU开发资料包等，进行相应开发。";case 3:return"SoC方案，不提供通用固件程序，需自行开发模组固件。"}},t.downloadData=function(){Object(O.c)(O.a.downloadData,{productId:t.props.productId,moduleId:t.state.currentModuleId}).then((function(e){e.data?window.location=e.data:alert("暂无数据！")}))},t.columns=[{title:"固件名称/固件Key",dataIndex:"burnFileName"},{title:"关联硬件",dataIndex:"moduleName"},{title:"芯片平台",dataIndex:"originalModuleTypeName"},{title:"固件类型",dataIndex:"type"},{title:"当前版本",dataIndex:"burnFileVersion"},{title:"操作",render:function(e,a,n){return c.a.createElement("div",{className:"table-operation",onClick:function(e){return t.modifyFirmware(a.id,e)}},"修改固件")}}],t.state={replaceModalVisible:!1,freeApplyVisible:!1,modifyFirmwareVisible:!1,dataSource:[],allInfo:{},currentModuleId:"",firmwareId:""},t}return t=i,(n=[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this),this.getMoudleInfo(bt.moduleId)}},{key:"render",value:function(){var e=this,t=this.state,n=t.replaceModalVisible,r=t.freeApplyVisible,l=t.modifyFirmwareVisible,i=(t.replaceFirmwareVisible,t.dataSource),o=t.allInfo,u=t.currentModuleId,s=t.firmwareId;return c.a.createElement("div",{className:"hardware-page"},c.a.createElement("div",{className:"hardware-wrap"},c.a.createElement("div",{className:"desc"},this.getSchemeType()),c.a.createElement("div",{className:"module-box"},c.a.createElement("div",{className:"module-header"},c.a.createElement("div",{className:"module-tip"},"已选模组"),c.a.createElement("div",{className:"replace-btn",onClick:function(){return e.setState({replaceModalVisible:!0})}},"更换模组")),c.a.createElement("div",{className:"module-cont"},c.a.createElement("div",{className:"flex-s"},c.a.createElement("div",{className:"module-cont-left"},c.a.createElement("img",{src:o.modulePicture||a("jt+J"),alt:""})),c.a.createElement("div",{className:"module-cont-right"},c.a.createElement("div",{className:"module-title"},o.moduleName||"-"),c.a.createElement("div",{className:"flex"},c.a.createElement("div",{className:"desc-item"},c.a.createElement("span",{className:"desc-item-title"},"芯片："),o.originalModuleTypeName||"-"),c.a.createElement("div",{className:"desc-item"},c.a.createElement("span",{className:"desc-item-title"},"尺寸："),o.sizeWidth,"x",o.sizeHeight,"x",o.sizeThickness),c.a.createElement("div",{className:"desc-item"},c.a.createElement("span",{className:"desc-item-title"},"适用："),o.applyScope||"-")),c.a.createElement("div",{className:"desc-item"},c.a.createElement("span",{className:"desc-item-title"},"特性："),"1.配网方式: ",o.netTypeName||"-","； 2.支持协议: ",o.bindTypeName||"-","； 3.通信通讯速率: ",o.communicateSpeed||"-","bps； 4.是否支持文件传输: ",0===o.supportFileTransfer?"否":"是"),c.a.createElement("div",{className:"more",onClick:this.downInstructions},"说明书",c.a.createElement(Ke.a,null)))),c.a.createElement("div",{className:"module-right-box"},o.price&&c.a.createElement("div",{className:"price"},"¥",o.price,"/个"),c.a.createElement("div",{className:"apply-btn",onClick:function(){e.setState({freeApplyVisible:!0})}},"免费申请")))),c.a.createElement("div",{className:"module-box"},c.a.createElement("div",{className:"module-tip mar-t-b"},"已生成固件"),o.firmwareDefList&&c.a.createElement(H.a,{rowKey:"burnFileVersion",columns:this.columns,dataSource:i,pagination:!1,size:"small"}),0===!o.firmwareDefList&&c.a.createElement("div",{className:"no-match-firmware"},c.a.createElement("div",{className:"no-match-firmware-img"},c.a.createElement("img",{src:a("e35r"),alt:""})),c.a.createElement("div",{className:"no-match-firmware-tip"},"您选择的模组暂无通用固件程序，请自行开发模组固件。"))),c.a.createElement("div",{className:"module-box"},c.a.createElement("div",{className:"module-tip mar30"},"开发调试"),c.a.createElement("div",{className:"debug"},c.a.createElement("div",{className:"flex-c"},c.a.createElement("img",{className:"debug-icon",src:a("idcQ"),alt:""}),1===bt.schemeType&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"设计PCB"),c.a.createElement("div",{className:"blue",onClick:function(){return e.downloadData()}},"参考电路原理图")),2===bt.schemeType&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"MCU模组 SDK开发"),c.a.createElement("div",{className:"blue"},c.a.createElement("span",{onClick:function(){return e.downloadData()}},"下载MCU开发资料包"),c.a.createElement(Je.a,{title:"包含MCU SDK、串口协议、模组调试助手等。SDK根据您产品的基本信息和功能定义生成对应的模组代码。若您的产品信息和功能定义发生变化，请重新生成。重新生成。",placement:"top"},c.a.createElement(Ue.a,{className:"tooltip-icon"})))),3===bt.schemeType&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"模组SDK开发"),c.a.createElement("div",{className:"blue"},c.a.createElement("span",{onClick:function(){return e.downloadData()}},"下载模组SDK开发资料包"),c.a.createElement(Je.a,{title:"包含模组 SDK、Bin文件等",placement:"top"},c.a.createElement(Ue.a,{className:"tooltip-icon"}))))),c.a.createElement("div",{className:"line"},c.a.createElement("img",{src:a("Lz/R"),alt:""})),c.a.createElement("div",{className:"flex-c"},c.a.createElement("img",{className:"debug-icon",src:a("iNUt"),alt:""}),c.a.createElement("div",null,"功能测试"),c.a.createElement("div",{className:"mar8"},"（请先完成第四步中配网以及通信安全机制的配置）")),c.a.createElement("div",{className:"line"},c.a.createElement("img",{src:a("Lz/R"),alt:""})),c.a.createElement("div",{className:"flex-c"},c.a.createElement("img",{className:"debug-icon",src:a("e11v"),alt:""}),c.a.createElement("div",null,"联网验证"),c.a.createElement("div",{className:"blue"},"下载“数联智能”App"))))),n&&c.a.createElement(Ge,{title:"更换模组",type:"module",replaceModalVisible:n,handleOk:function(t){return e.handleModalOk(t,"module")},handleCancel:this.handleModalCancel,schemeId:bt.schemeId,moduleId:u}),r&&c.a.createElement(nt,{type:"1",firmwareName:o.burnFileName||"",moduleName:o.moduleName||"",freeApplyVisible:r,handleFreeApply:function(){e.setState({freeApplyVisible:!1}),e.getMoudleInfo(u)}}),l&&c.a.createElement(ut,{modifyFirmwareVisible:l,firmwareId:s,productId:this.props.productId,handleCancelFirmware:function(){e.setState({modifyFirmwareVisible:!1}),e.getMoudleInfo(u)}}))}}])&&mt(t.prototype,n),r&&mt(t,r),i}(l.Component),vt=a("g4q9"),gt=a("BkRI"),ht=a.n(gt),Ot=(a("UxlC"),a("TL2v"));function wt(){return c.a.createElement(c.a.Fragment,null)}a("S8ev");var It=a("rVDo");a("EVkz");function jt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function St(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ct(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var kt=y.a.TextArea;var xt=function(e){var t=e.releaseVisible,a=e.cancelHandle,n=e.productId,r=Nt(b.a.useForm(),1)[0],o=Object(l.useRef)(),u=Object(i.useHistory)(),s=function(e){};return c.a.createElement(z.a,{title:"发布产品",visible:t,width:740,onOk:function(){r.submit()},onCancel:a,okText:"确认发布",maskClosable:!1,wrapClassName:"replace-module-modal"},c.a.createElement("div",{className:"release-product-modal"},c.a.createElement(b.a,{form:r,name:"release-product-form",labelCol:{span:5},wrapperCol:{span:14},onFinish:function(e){console.log("Received values of form: ",e);var t=e.instruction.length&&e.instruction.map((function(e){return{file:null,filename:e.name,filesrc:e.url}}));e.instruction=JSON.stringify(t),e.productPic=e.productPic&&e.productPic[0].url,e.productIcon=e.productIcon&&e.productIcon[0].url,e.productId=n,console.log("请求接口的参数"),Object(O.c)(O.a.publishProduct,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(a),!0).forEach((function(t){St(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)).then((function(e){Object(w.a)({description:"发布成功！",type:"success"}),u.push("/open/product/proManage/list")}))},autoComplete:"off",initialValues:{portName:"IOT"}},c.a.createElement("div",null,c.a.createElement("div",{className:"release-item-title"},"公司信息"),c.a.createElement(b.a.Item,{label:"产品所属公司名称",name:"supplier",rules:[{required:!0,message:"请输入公司名称"},{pattern:new RegExp(/^[a-zA-Z\u4e00-\u9fa5]+$/,"g"),message:"请输入中文/英文品牌名称"}]},c.a.createElement(y.a,{placeholder:"请输入公司名称"})),c.a.createElement(b.a.Item,{label:"产品联系人",name:"contact",rules:[{required:!0,message:"请输入联系人名称"},{pattern:new RegExp(/^[a-zA-Z\u4e00-\u9fa5]+$/,"g"),message:"请输入联系人名称"}]},c.a.createElement(y.a,{placeholder:"请输入联系人名称"})),c.a.createElement(b.a.Item,{label:"联系方式",name:"tel",rules:[{required:!0,message:"请输入联系人手机号码"},{pattern:/^(((\d{3,4}-)?\d{7,8})|(1\d{10}))$/,message:"请输入正确的联系人手机号码"}]},c.a.createElement(y.a,{placeholder:"请输入联系人手机号码"})),c.a.createElement("div",{className:"release-item-title"},"产品信息"),c.a.createElement("div",{className:"unit-box"},c.a.createElement(b.a.Item,{label:"产品尺寸",name:"size",rules:[{required:!0,message:"请输入产品尺寸，如50*30*30"}]},c.a.createElement(y.a,{placeholder:"请输入产品尺寸，如50*30*30",style:{width:366}})),c.a.createElement("span",{className:"unit-box-item"},"  mm")),c.a.createElement("div",{className:"unit-box"},c.a.createElement(b.a.Item,{label:"产品重量",name:"weight",rules:[{required:!0,pattern:new RegExp(/^(?!0+(?:\.0+)?$)(?:[1-9]\d*|0)(?:\.\d{1,2})?$/,"g"),message:"请输入产品重量，如2"}]},c.a.createElement(y.a,{placeholder:"请输入产品重量，如2",style:{width:366}})),c.a.createElement("span",{className:"unit-box-item"},"  kg")),c.a.createElement(b.a.Item,{label:"产品参数",name:"productParam",rules:[{required:!0,message:"请输入产品参数"}]},c.a.createElement(kt,{showCount:!0,maxLength:100,placeholder:"请输入产品参数",autoSize:{minRows:4},onChange:s})),c.a.createElement(b.a.Item,{label:"产品介绍",name:"introduction",rules:[{required:!0,message:"请输入产品介绍"}]},c.a.createElement(kt,{showCount:!0,maxLength:100,placeholder:"请输入产品介绍",autoSize:{minRows:4},onChange:s})),c.a.createElement("div",{className:"release-item-title"},"产品附件"),c.a.createElement(b.a.Item,{className:"upload-file",label:"产品说明书",name:"instruction",rules:[{required:!0,message:"请上传产品说明书"}]},c.a.createElement(It.b,{ref:o,isNotImg:!0,format:".doc,.docx,.pdf,.jpg,.png",maxSize:20,maxCount:5})),c.a.createElement(b.a.Item,{className:"upload-file",label:"产品图标",name:"productIcon"},c.a.createElement(It.b,{ref:o,isNotImg:!1,format:".gif,.jpeg,.jpg,.png",preferSize:"64*64",maxSize:.512,maxCount:1})),c.a.createElement(b.a.Item,{className:"upload-file",label:"成品图片",name:"productPic"},c.a.createElement(It.b,{ref:o,isNotImg:!1,format:".gif,.jpeg,.jpg,.png",preferSize:"192*192",maxSize:.512,maxCount:1}))))))};function Tt(e){return function(e){if(Array.isArray(e))return Ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Pt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||Pt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){if(e){if("string"==typeof e)return Ft(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ft(e,t):void 0}}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Mt=v.a.TabPane,Rt=[{title:"序列号",dataIndex:"name",key:"name",render:function(e){return c.a.createElement("a",null,e)}},{title:"topic数据内容",dataIndex:"age",key:"age"},{title:"物理地址",dataIndex:"address",key:"address"},{title:"DID",dataIndex:"DID",key:"DID"}],Dt=null,Lt=null;function qt(e,t){e.nextStep;var a=e.productId,r=At(Object(l.useState)(!1),2),i=r[0],o=r[1],u=At(Object(l.useState)([]),2),s=u[0],m=u[1],d=At(Object(l.useState)(["",""]),2),p=d[0],f=d[1],b=At(Object(l.useState)(""),2),E=b[0],g=b[1],h=At(Object(l.useState)(""),2),I=h[0],j=h[1],S=At(Object(l.useState)(0),2),N=(S[0],S[1]),C=At(Object(l.useState)(0),2),k=C[0],x=C[1];Object(l.useEffect)((function(){return Object(O.b)(O.a.queryServerConfig,{productId:a},{loading:!0}).then((function(e){var t=e.data;g((void 0===t?{}:t).ip)})),T(),function(){Dt&&Dt.close(),clearInterval(Lt),Dt=null}}),[a]),Object(l.useEffect)((function(){k&&F()}),[I]),Object(l.useImperativeHandle)(t,(function(){return{showRelease:A}}));var T=function(){Object(O.b)(O.a.accessToken,{},{loading:!0}).then((function(e){var t=e.data;j(void 0===t?"":t)}))},A=function(){o(!0)},P=function(e,t){var a=Tt(p);a[t]=e.target.value,f(Tt(a))},F=function(){var e;e=window.location.protocol.replace(/https?/,"wss"),(Dt=new WebSocket(e+"//"+E)).onopen=function(){x(1),N(1),clearInterval(Lt),Lt=setInterval((function(){Dt.send("")}),5e3);var e=JSON.parse(sessionStorage.getItem("productItem")),t=e.customerCode,a=e.deviceTypeId,n=e.deviceSubTypeId,r=e.productVersion,l="[".concat(I,"|").concat(t,"|").concat(a,"#").concat(n,"#").concat(r,"#").concat(p[0],"#").concat(p[1],"]");Dt.send(l)},Dt.onmessage=function(e){var t=JSON.parse(e.data),a=ht()(s);901==a.unshift(t)&&a.pop(),m(a)},Dt.onclose=function(e){N(0),clearInterval(Lt),k&&"1006"==e.code&&setTimeout(T,5e3),Dt=null}},M=At(p,2),R=M[0],D=M[1];return c.a.createElement("div",{id:"product-edit-validation"},c.a.createElement("div",{className:"validation-top"},"在真实设备调试的配置调试信息步骤，添加设备物理地址后，既默认此设备在clife平台注册，不受通信安全校验机制（如一机一密）的影响"),c.a.createElement("div",{className:"validation-tab"},c.a.createElement(v.a,{defaultActiveKey:"1"},c.a.createElement(Mt,{tab:"真实设备调试",key:"1"},c.a.createElement("div",{className:"tab-one-title"},c.a.createElement("div",{className:"tab-one-title-left"},c.a.createElement("div",{className:"btn-label"},"配置调试信息",c.a.createElement(Ne.a,{tip:"WiFi蓝牙设备需先登录数联智能App，并搜索绑定需要调试的设备，蜂窝设备不需要。"}),"："),c.a.createElement(y.a,{value:R,onChange:function(e){return P(e,0)},placeholder:"请输入数联智能App登录账号"}),c.a.createElement(y.a,{value:D,onChange:function(e){return P(e,1)},placeholder:"输入设备物理地址"}),c.a.createElement(n.a,{type:"primary",onClick:function(){""!=R&&""!=D?F():Object(w.a)({description:"账号和设备物理地址都不能为空",type:"warn"})}},"确定调试"),c.a.createElement(n.a,{onClick:function(){f(["",""])}},"重置")),c.a.createElement("a",null,"历史调试信息")),c.a.createElement("div",{className:"tab-one-content"},c.a.createElement("div",{className:"left-content"},c.a.createElement("div",{className:"left-content-title"},c.a.createElement("h3",null,"原始数据"),c.a.createElement("div",null,c.a.createElement(n.a,{type:"primary",ghost:!0},"清空当前信息"),c.a.createElement(n.a,{type:"primary",ghost:!0},"导出数据"))),c.a.createElement("div",null,c.a.createElement(H.a,{columns:Rt,dataSource:s}))),c.a.createElement("div",{className:"right-content"},c.a.createElement("h3",null,"解析数据"),c.a.createElement("div",null)))),c.a.createElement(Mt,{tab:"虚拟设备调试",key:"2"},c.a.createElement(Ot.a,{style:{marginBottom:8,width:"100%"},desc:["WiFi蓝牙设备需先登录数联智能App，并搜索绑定需要调试的设备，蜂窝设备不需要。"]})))),c.a.createElement(wt,null),i&&c.a.createElement(xt,{productId:a,releaseVisible:i,cancelHandle:function(){o(!1)}}))}var Vt=qt=Object(l.forwardRef)(qt);a("pDQq"),a("yq1k"),a("Z6NE");function Jt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Kt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ht=f.a.Option,Bt=a("HILT"),_t=a("96C7");var $t=function(e){var t=e.networkModalVisible,a=e.productId,r=e.isGateWayDevice,i=(e.isedited,e.cancelHandle),o=Ut(b.a.useForm(),1)[0],u=Object(l.useRef)(),s=Object(l.useRef)(),m=Ut(Object(l.useState)(""),2),d=m[0],p=m[1],E=Ut(Object(l.useState)(""),2),v=E[0],g=E[1],h=Ut(Object(l.useState)({}),2),I=h[0],j=h[1];Object(l.useEffect)((function(){Object(O.c)(O.a.getNetDataByProductId,{productId:a}).then((function(e){j(e.data),u.current.setFieldsValue({baseTypeId:e.data.baseTypeId,guidePage:e.data.guidePage.guidePage,bindFailPage:e.data.guidePage.bindFailPage,imageUrlList:e.data.helpPage.imageUrls,radiocastName:e.data.radiocastName||"",ssid:e.data.ssid||""}),p(e.data.guidePage.guidePage),g(e.data.guidePage.bindFailPage),s.current.setFileList(e.data.helpPage.imageUrls.filter((function(e){return e})).map((function(e){return{url:e,status:"done"}})))}))}),[]);var S=function(e){"guidePage"===e&&p(""),"bindFailPage"===e&&g("")},N=function(e,t){var a=t.target.files[0];if("image/png"!==a.type&&"image/jpeg"!==a.type&&"image/gif"!==a.type)return Object(w.a)({description:"请上传gif、jpeg、jpg、png格式图片!",type:"warn"}),t.target.value="",void S(e);if(a.size>512e3)return Object(w.a)({description:"文件大小不能超过500KB",type:"warn"}),t.target.value="",void S(e);var n={appId:31438,domainType:4,file:a};Object(O.c)(O.a.upFileUrl,n,{needFormData:!0,loading:!0},{timeout:3e4}).then((function(t){0===t.code&&("guidePage"===e&&p(t.data.url),"bindFailPage"===e&&g(t.data.url),u.current.setFieldsValue(Kt({},e,t.data.url)))}))};return c.a.createElement(z.a,{title:"配网信息",visible:t,width:875,onOk:function(){o.submit()},onCancel:i,maskClosable:!1,wrapClassName:"replace-module-modal"},c.a.createElement("div",{className:"network-info-modal"},c.a.createElement(b.a,{ref:u,form:o,onFinish:function(e){var t=e.imageUrlList&&e.imageUrlList.filter((function(e){return e})).map((function(e){return e.url||e}));e.productId=a,e.imageUrlList=t||[],e.isGateWayDevice=r||"",e.guidePage=e.guidePage||"",e.bindFailPage=e.bindFailPage||"",console.log("提交的数据****",e),Object(O.c)(O.a.saveNetworkConfig,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(a),!0).forEach((function(t){Kt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Jt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),{loading:!0}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),i()}))},labelCol:{span:5},wrapperCol:{span:19},initialValues:{}},c.a.createElement("div",{className:"network-info-modal-title"},"配网方式"),c.a.createElement(b.a.Item,{label:"已选通信协议"},c.a.createElement("span",null,I.bindTypeName)),c.a.createElement(b.a.Item,{label:"配网方式",name:"baseTypeId",rules:[{required:!0,message:"请选择配网方式！"}]},c.a.createElement(f.a,{style:{width:380}},I.bindTypeList&&I.bindTypeList.map((function(e){return c.a.createElement(Ht,{key:e.baseTypeId,value:e.baseTypeId},e.baseTypeName)})))),1===I.bindTypeId&&c.a.createElement(b.a.Item,{label:"AP-SSID",name:"ssid",rules:[{required:!0,message:"请输入AP-SSID！"}]},c.a.createElement(y.a,{maxLength:50,style:{width:380}})),(1===I.bindTypeId||2===I.bindTypeId)&&c.a.createElement(b.a.Item,{label:"广播名",name:"radiocastName",rules:[{required:!0,message:"请输入广播名！"}]},c.a.createElement(y.a,{maxLength:50,style:{width:380}})),(1===I.bindTypeId||2===I.bindTypeId)&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"network-info-modal-title"},"配网图片引导",c.a.createElement("span",{className:"tip"},"（需产品支持WiFi或蓝牙配置能力）")),c.a.createElement("div",{className:"flex"},c.a.createElement(b.a.Item,{label:"默认联网指引",name:"guidePage",labelCol:{span:10},wrapperCol:{span:10},className:"upload-img"},c.a.createElement("div",{className:"native-upload"},c.a.createElement("div",{className:"img-wrap"},c.a.createElement("img",{src:d||Bt,alt:""})),c.a.createElement("label",{htmlFor:"upLoadImg"},c.a.createElement(n.a,{type:"primary",className:"upload-btn"},"上传图片",c.a.createElement("input",{type:"file",accept:"image/*",id:"upLoadImg",name:"guideImg",className:"hidden",onInput:function(e){return N("guidePage",e)}}))),c.a.createElement("div",{className:"tip-text"},"支持gif、jpeg、jpg、png格式，大小不超过500k，推荐尺寸110*154px，150*267px"))),c.a.createElement(b.a.Item,{label:"默认联网失败提示",name:"bindFailPage",labelCol:{span:10},wrapperCol:{span:10},className:"upload-img"},c.a.createElement("div",{className:"native-upload"},c.a.createElement("div",{className:"img-wrap"},c.a.createElement("img",{src:v||_t,alt:""})),c.a.createElement("label",{htmlFor:"upLoadImg"},c.a.createElement(n.a,{type:"primary",className:"upload-btn"},"上传图片",c.a.createElement("input",{type:"file",accept:"image/*",id:"upLoadImg",name:"guideImg",className:"hidden",onInput:function(e){return N("bindFailPage",e)}}))),c.a.createElement("div",{className:"tip-text"},"支持gif、jpeg、jpg、png格式，大小不超过500k，推荐尺寸110*154px，150*267px")))),c.a.createElement(b.a.Item,{label:"图片轮播帮助信息",name:"imageUrlList",className:"upload-img",labelCol:{span:5},wrapperCol:{span:20}},c.a.createElement(It.b,{ref:s,maxCount:5,preferSize:"150*267",format:".gif,.jpeg,.jpg,.png",maxSize:.5}))))))},Wt=(a("qePV"),a("zueq"));a("ggmS");function Gt(){return(Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Yt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Yt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Qt=function(e){var t=e.securityVisible,a=e.productId,n=e.cancelHandle,r=e.isGateWayDevice,i=e.isConfigedFunc,o=e.productExtend,u=Zt(b.a.useForm(),1)[0],s=Zt(Object(l.useState)("0"),2),m=s[0],p=s[1];return c.a.createElement(z.a,{title:"通信安全机制",visible:t,width:740,onOk:function(){u.submit()},onCancel:n,maskClosable:!1,wrapClassName:"replace-module-modal"},c.a.createElement("div",{className:"communication-security-modal"},c.a.createElement("div",{className:"tip-desc"},c.a.createElement(Wt.a,null),c.a.createElement("span",{className:"tip-text"},"数据在产品发布后可在设备注册模块查看")),c.a.createElement(b.a,Gt({form:u},{labelCol:{span:5},wrapperCol:{span:14}},{onFinish:function(e){Object(O.c)(O.a.saveProductSecurityConfig,{productId:a,authorityType:Number(m),isGateWayDevice:r||""}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),i()}))},initialValues:{authorityType:o+""}}),c.a.createElement(b.a.Item,{name:"authorityType",label:"验证方式",rules:[{required:!0,message:"请选择验证方式！"}]},c.a.createElement(d.a.Group,{onChange:function(e){return p(e.target.value)}},c.a.createElement(d.a,{value:"0"},c.a.createElement(Je.a,{title:"设备通信时，仅校验烧录的产品密钥，设备安全性较低。",placement:"bottom"}," 一型一密 ")),c.a.createElement(d.a,{value:"1"},c.a.createElement(Je.a,{title:"设备通信时，需校验烧录的产品密钥以及Clife平台设备注册的设备ID，较为安全。",placement:"bottom"},"一型一密pro")),c.a.createElement(d.a,{value:"2"},c.a.createElement(Je.a,{title:"设备通信时，需校验烧录的设备密钥和设备ID，安全性最高。",placement:"bottom"},"一机一密")))))))},Xt=a("/MfK"),ea=(a("jXZW"),["key","name","fieldKey"]);function ta(){return(ta=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function aa(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ra(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ra(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var la=function(e){var t=e.productId,a=e.firmwareVisible,n=e.cancelHandle,r=e.type,i=e.editData,o=e.confirmHandle,u=e.customCount,s=na(b.a.useForm(),1)[0];return Object(l.useEffect)((function(){"edit"===r&&s.setFieldsValue({firmwareTypeMark:i.firmwareTypeMark,firmwareTypeName:i.firmwareTypeName})}),[]),c.a.createElement(z.a,{title:"edit"===r?"编辑产品固件模块":"配置产品固件模块",visible:a,width:555,onOk:function(){s.submit()},onCancel:n,maskClosable:!1,wrapClassName:"replace-module-modal"},c.a.createElement("div",{className:"config-firmware-modal"},c.a.createElement(b.a,{form:s,name:"config-firmware-form",onFinish:function(e){if(console.log("Received values of form: ",e,r,"type"),"edit"===r)Object(O.c)(O.a.updateFirmwareModule,{id:i.id,firmwareTypeName:e.firmwareTypeName,firmwareTypeMark:e.firmwareTypeMark}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),o()}));else{var a=[{deviceVersionType:5,productId:t,firmwareTypeMark:e.firmwareTypeMark,firmwareTypeName:e.firmwareTypeName}];e.list&&e.list.length&&e.list.forEach((function(e){a.push({deviceVersionType:5,productId:t,firmwareTypeMark:e.firmwareTypeMark,firmwareTypeName:e.firmwareTypeName})})),Object(O.c)(O.a.addFirmwareModule,a).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),o()}))}},autoComplete:"off"},c.a.createElement("div",{className:"form-item-block"},c.a.createElement(b.a.Item,{label:"配置固件模块标识",name:"firmwareTypeMark",rules:[{required:!0,message:"请输入英文字符"},{pattern:new RegExp(/^[a-zA-Z]+$/,"g"),message:"请输入英文字符"}]},c.a.createElement(y.a,{maxLength:50,placeholder:"请输入英文字符"})),c.a.createElement(b.a.Item,{label:"配置固件模块名称",name:"firmwareTypeName",rules:[{required:!0,message:"请输入中文名称"},{pattern:new RegExp(/^[\u2E80-\u9FFF]+$/,"g"),message:"请输入中文产品名称"}]},c.a.createElement(y.a,{maxLength:50,placeholder:"请输入中文名称"}))),"add"===r&&c.a.createElement(b.a.List,{name:"list"},(function(e,t){var a=t.add,n=t.remove;return c.a.createElement(c.a.Fragment,null,e.map((function(e){var t=e.key,a=e.name,r=e.fieldKey,l=aa(e,ea);return c.a.createElement("div",{className:"form-item-block",key:t},c.a.createElement(b.a.Item,ta({label:"配置固件模块标识"},l,{name:[a,"firmwareTypeMark"],fieldKey:[r,"firmwareTypeMark"],rules:[{required:!0,message:"请输入英文字符"},{pattern:new RegExp(/^[a-zA-Z]+$/,"g"),message:"请输入英文字符"}]}),c.a.createElement(y.a,{maxLength:50,placeholder:"请输入英文字符"})),c.a.createElement(b.a.Item,ta({label:"配置固件模块名称"},l,{name:[a,"firmwareTypeName"],fieldKey:[r,"firmwareTypeName"],rules:[{required:!0,message:"请输入中文名称"},{pattern:new RegExp(/^[\u2E80-\u9FFF]+$/,"g"),message:"请输入中文产品名称"}]}),c.a.createElement(y.a,{maxLength:50,placeholder:"请输入中文名称"})),c.a.createElement("div",{className:"delete-btn",onClick:function(){return n(a)}},c.a.createElement(Xt.a,null),"  删除"))})),4-e.length-Number(u)>0&&c.a.createElement("div",{className:"add-btn",onClick:function(){return a()}},"新增"))})))))};a("sTEO");f.a.Option;a("qNb/");var ca=a("PArb");a("fAKH");var ia=function(e){var t=e.productId,a=e.firmwareDetailData,r=void 0===a?[]:a,l=e.firmwareDetailVisible,i=e.cancelHandle,o=e.showAddFirmware,u=e.showEditFirmware,s=e.getFirmwareList,m=[{title:"配置的固件模块标识",dataIndex:"firmwareTypeMark",key:"firmwareTypeMark"},{title:"配置的固件模块名称",dataIndex:"firmwareTypeName",key:"firmwareTypeName"},{title:"配置时间",dataIndex:"createTime",key:"createTime"},{title:"操作",render:function(e,t,a){return c.a.createElement("div",{className:"edit-ope"},0===t.isCustom&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{onClick:function(){return u(t)}},"编辑"),c.a.createElement(ca.a,{type:"vertical"}),c.a.createElement("span",{onClick:function(){return d(t)}},"删除")))}}],d=function(e){Object(O.c)(O.a.delFirmwareModule,{productId:t,id:e.id}).then((function(e){Object(w.a)({description:"操作成功！",type:"success"}),s()}))};return c.a.createElement(z.a,{title:"配置产品固件模块",visible:l,width:857,onOk:i,onCancel:i,maskClosable:!1,wrapClassName:"replace-module-modal"},c.a.createElement("div",{className:"configfirmware-detail-modal"},c.a.createElement(n.a,{type:"primary",className:"mar22",onClick:function(){return o("add")}},"新增产品固件模块"),c.a.createElement(H.a,{rowKey:"firmwareTypeNo",columns:m,dataSource:r,pagination:!1,size:"small"})))};a("8bdq");function oa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ua(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ua(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var sa=JSON.parse(sessionStorage.getItem("productItem"))||{};function ma(e,t){var n=e.productId,r=e.nextStep,o=oa(Object(l.useState)([{title:"配网信息",desc:"选择设备联网方式，设置配网引导图，相关指引等",isConfiged:!1,type:"network",url:a("2mZb")},{title:"通信安全机制",desc:"配置设备通信的安全机制，兼顾客户的便利以及安全需求",isConfiged:!1,type:"security",url:a("sfQM")}]),2),u=o[0],s=o[1],m=oa(Object(l.useState)([{title:"配置产品固件模块",desc:"支持配置OTA升级模块，比如区分控制板、驱动板、显示板等不同模块",isConfiged:!1,type:"addFirmware",url:a("sxCh")},{title:"固件升级",desc:"MCU固件或SDK估计配置远程升级，无需烧录。需控制板支持。",isConfiged:!1,type:"firmwareUpdate",routePath:"/open/product/otaUpdate",url:a("YKHW")},{title:"场景联动配置",desc:"配置自动化联动的条件动作，以便加入场景，跟其他设备联动控制。",isConfiged:!1,type:"scene",routePath:"/open/product/ruleEngine",url:a("JGhx")},{title:"云端定时",desc:"云端设定开关时间及周循环，无需硬件嵌入式开发",isConfiged:!1,type:"cloud",routePath:"/open/product/cloudTimer",url:a("hGad")},{title:"设备告警",desc:"可定义配置设备预警消息推送，方便随时随地的设备监控",isConfiged:!1,type:"deviceWarning",routePath:"/open/device/devMsg",url:a("mBzF")}]),2),d=m[0],p=m[1],f=oa(Object(l.useState)(""),2),y=(f[0],f[1]),b=oa(Object(l.useState)(""),2),E=b[0],v=b[1],g=oa(Object(l.useState)(!1),2),h=g[0],I=g[1],j=oa(Object(l.useState)(!1),2),S=j[0],N=j[1],C=oa(Object(l.useState)(!1),2),k=C[0],x=C[1],T=oa(Object(l.useState)(!1),2),A=(T[0],T[1]),P=oa(Object(l.useState)(!1),2),F=P[0],M=P[1],R=oa(Object(l.useState)(""),2),D=R[0],L=R[1],q=oa(Object(l.useState)([]),2),V=q[0],J=q[1],K=oa(Object(l.useState)("add"),2),U=K[0],z=K[1],H=oa(Object(l.useState)({}),2),B=H[0],_=H[1],$=oa(Object(l.useState)(0),2),W=$[0],G=$[1],Z=function(){var e=u.filter((function(e){return!0===e.isConfiged}));console.log("required-list",e),e.length?r():Object(w.a)({description:"请完善必选配置信息！",type:"warn"})};Object(l.useImperativeHandle)(t,(function(){return{onFinish:Z}}));var Y=function(){N(!1),Object(O.c)(O.a.getSecurityConfigStatus,{productId:n},{loading:!0}).then((function(e){var t=ht()(u);e.data.gatewayConfigflag&&(t[0].isConfiged=!0,s(t),y(e.data.productConfig)),e.data.securityConfigflag&&(t[1].isConfiged=!0,s(t),v(e.data.productExtend.authorityType))}))},Q=function(){Object(O.c)(O.a.getProductExtendInfo,{productId:n},{loading:!0}).then((function(e){L(e.data.productClassId)}))},X=function(){Object(O.c)(O.a.getFirmwareList,{productId:n},{loading:!0}).then((function(e){if(e.data&&e.data.length>0){var t=e.data.filter((function(e){return 0===e.isCustom}));console.log(t.length,"customList.length"),G(t.length),J(e.data);var a=ht()(d);a[0].isConfiged=!0,p(a)}}))};Object(l.useEffect)((function(){Y(),Q(),function(){if(sa.schemeType)if(1==sa.schemeType){var e=ht()(d);e.splice(0,1),p(e)}else X()}()}),[]);var ee=function(e){switch(e){case"network":I(!0);break;case"security":N(!0);break;case"addFirmware":W>=5?Object(w.a)({description:"产品固件模块最多配置5个！",type:"warn"}):x(!0);break;case"gateway":A(!0)}};return c.a.createElement("div",{className:"service-config-page"},c.a.createElement("div",{className:"desc"},function(){if(!sa.schemeType)return"";switch(sa.schemeType){case 1:return"免开发方案，只需选择推荐模组以及配置固件信息，快速实现硬件智能化。";case 2:return"独立MCU方案，需选择下载MCU开发资料包等，进行相应开发。";case 3:return"SoC方案，不提供通用固件程序，需自行开发模组固件。"}}()),c.a.createElement("div",{className:"service-config-title"},"必选配置"),c.a.createElement("div",{className:"service-config-cont"},u&&u.map((function(e,t){return c.a.createElement("div",{className:"config-card",key:t},c.a.createElement("div",{className:"config-card-left"},c.a.createElement("img",{src:e.url,alt:"图片"})),c.a.createElement("div",{className:"config-card-right"},c.a.createElement("div",{className:"config-card-right-title"},e.title),c.a.createElement("div",{className:"config-card-right-desc"},e.desc),c.a.createElement("div",{className:"config-card-right-btn",onClick:function(){ee(e.type)}},e.isConfiged?"修改":"配置")),e.isConfiged&&c.a.createElement("div",{className:"configured-logo"},"已配置"))}))),c.a.createElement("div",{className:"service-config-title"},"可选配置"),c.a.createElement("div",{className:"service-config-cont"},d.map((function(e,t){return c.a.createElement("div",{className:"config-card",key:t},c.a.createElement("div",{className:"config-card-left"},c.a.createElement("img",{src:e.url,alt:"图片"})),c.a.createElement("div",{className:"config-card-right"},c.a.createElement("div",{className:"config-card-right-title"},e.title),c.a.createElement("div",{className:"config-card-right-desc"},e.desc),c.a.createElement("div",{className:"flex-start"},e.isConfiged?"":["firmwareUpdate","cloud","deviceWarning","scene"].includes(e.type)?c.a.createElement("div",{className:"config-card-right-btn"},c.a.createElement(i.Link,{to:e.routePath,target:"_blank"},"配置")):c.a.createElement("div",{className:"config-card-right-btn",onClick:function(){ee(e.type)}},"配置"),e.isConfiged?"addFirmware"===e.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"config-card-right-btn",onClick:function(){ee(e.type),z("add")}},"配置"),c.a.createElement("div",{className:"config-card-right-btn mar6",onClick:function(){M(!0)}},"详情")):c.a.createElement("div",{className:"config-card-right-btn",onClick:function(){ee(e.type)}},"修改"):"")),e.isConfiged&&c.a.createElement("div",{className:"configured-logo"},"已配置"))}))),h&&c.a.createElement($t,{networkModalVisible:h,productId:n,isGateWayDevice:D,isedited:u[0].isConfiged,cancelHandle:function(){I(!1),Y(),Q()}}),S&&c.a.createElement(Qt,{securityVisible:S,productId:n,isGateWayDevice:D,productExtend:E,isConfigedFunc:Y,cancelHandle:function(){N(!1)}}),k&&c.a.createElement(la,{productId:n,type:U,editData:B,customCount:W,firmwareVisible:k,confirmHandle:function(){x(!1),X()},cancelHandle:function(){x(!1)}}),F&&c.a.createElement(ia,{productId:n,firmwareDetailVisible:F,firmwareDetailData:V,getFirmwareList:X,cancelHandle:function(){M(!1)},showAddFirmware:function(e){x(!0),z(e)},showEditFirmware:function(e){x(!0),z("edit"),_(e)}}))}var da=Object(l.forwardRef)(ma),pa=a("S18n");a("T8Ho");function fa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ya(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ya(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ya(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function ba(e){var t=e.titleVisible,a=e.onCloseTitle,r=e.onOkClose,i={};sessionStorage.getItem("productItem")&&(i=JSON.parse(sessionStorage.getItem("productItem")));var o=fa(b.a.useForm(),1)[0],u=Object(l.useRef)(),s=fa(Object(l.useState)([]),2),m=s[0],d=s[1];Object(l.useEffect)((function(){Object(O.c)(O.a.getProductBrand).then((function(e){d(e.data)}))}),[]);return c.a.createElement(E.a,{title:"产品信息",placement:"right",closable:!1,onClose:a,visible:t,destroyOnClose:!0,width:393,footer:c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(n.a,{onClick:a,style:{marginRight:8}},"取消"),c.a.createElement(n.a,{onClick:function(){o.validateFields().then((function(e){var t={productId:i.productId,productName:e.productName,brandId:e.brandId,productIcon:e.productIcon[0].url,productCode:e.productCode};Object(O.c)(O.a.editProductInfo,t).then((function(t){var a={productName:e.productName,brandId:e.brandId,productIcon:e.productIcon[0].url,productCode:e.productCode,modifyTime:t.data.modifyTime};r(a)}))}))},type:"primary"},"确定"))},c.a.createElement("div",{className:"edit-left-protocol-wrap"},c.a.createElement(b.a,{labelCol:{span:8},wrapperCol:{span:16},form:o,initialValues:{productIcon:[{url:i.productIcon}],productName:i.productName,brandId:i.brandId,productCode:i.productCode}},c.a.createElement(b.a.Item,{label:"产品名称",name:"productName",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"产品ID"},c.a.createElement("span",null,i.productId)),c.a.createElement(b.a.Item,{label:"品类"},c.a.createElement("span",null,i.deviceType)),c.a.createElement(b.a.Item,{label:"品牌",name:"brandId",rules:[{required:!0}]},c.a.createElement(f.a,null,m.map((function(e){return c.a.createElement(f.a.Option,{value:e.brandId,key:e.brandId},e.fullName)})))),c.a.createElement(b.a.Item,{label:"产品型号",name:"productCode",rules:[{required:!0}]},c.a.createElement(y.a,null)),c.a.createElement(b.a.Item,{label:"通信协议"},c.a.createElement("span",null,i.bindTypeStr)),c.a.createElement(b.a.Item,{label:"智能化方案"},c.a.createElement("span",null,i.schemeName)),c.a.createElement(b.a.Item,{label:"产品编码"},c.a.createElement("span",null,i.code)),c.a.createElement(b.a.Item,{label:"产品密钥"},c.a.createElement("span",null,c.a.createElement(pa.a,{label:i.deviceKey,tip:"",copy:!1}))),c.a.createElement(b.a.Item,{label:"产品图片",name:"productIcon"},c.a.createElement(It.b,{ref:u,maxSize:10,format:".gif,.jpeg,.jpg,.png"})),c.a.createElement(b.a.Item,{label:"创建时间"},c.a.createElement("span",null,i.createTime)),c.a.createElement(b.a.Item,{label:"更新时间"},c.a.createElement("span",null,i.modifyTime)))))}var Ea=a("DgvE"),va=a("739K"),ga=a("DeUx");function ha(){return(ha=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Oa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function wa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(a),!0).forEach((function(t){Ia(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ia(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ja(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],c=!0,i=!1;try{for(a=a.call(e);!(c=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Sa(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Sa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sa(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.default=Object(o.connect)((function(e){return{productBaseInfo:e.getIn(["product","productBaseInfo"]).toJS()}}),(function(e){return{getProductBaseInfo:function(t){return e(Object(u.f)(t))}}}))((function(e){var t=e.productBaseInfo,a=e.getProductBaseInfo,o=e.match,u=e.location,m=ja(Object(l.useState)(sessionStorage.getItem("productItem")?JSON.parse(sessionStorage.getItem("productItem")):{}),2),d=m[0],p=m[1],f=Object(i.useHistory)(),y=o.path,b=function(e){return+e.params.id}(o),E=0===t.mode,v=r.a.Step,g=[{title:"定义功能",content:"protocols"},{title:"确定面板",content:"firmpanel"},{title:"开发硬件",content:"projectSelect"},{title:"配置服务",content:"configService"},{title:"调试验证",content:"validation"}],h=0;g.forEach((function(e,t){e.content==u.pathname.split("/")[6]&&(h=t)}));var O=ja(Object(l.useState)(h),2),I=O[0],j=O[1],S={active_0:Object(l.useRef)(),active_1:Object(l.useRef)(),active_2:Object(l.useRef)(),active_3:Object(l.useRef)(),active_4:Object(l.useRef)()},N=ja(Object(l.useState)(!1),2),C=N[0],k=(N[1],Object(l.useCallback)((function(){j(I+1)})));if(Object(l.useEffect)((function(){u.pathname.split("/")[6]!=g[I].content&&f.push(o.url+"/"+g[I].content)}),[I]),!b)return c.a.createElement(s.a,{tipText:"没有传入产品ID哦"});var x,T=ja(Object(l.useState)(!1),2),A=T[0],P=T[1],F=ja(Object(l.useState)(!1),2),M=F[0],R=F[1],D=c.a.createElement("div",{className:"product_title_baseinfo_list"},c.a.createElement("div",null,c.a.createElement("div",null,"品类："),c.a.createElement("div",null,d.deviceType)),c.a.createElement("div",null,c.a.createElement("div",null,"产品ID："),c.a.createElement("div",null,d.productId)),c.a.createElement("div",null,c.a.createElement("div",null,"通讯协议："),c.a.createElement("div",null,d.bindTypeStr)),c.a.createElement("div",null,c.a.createElement("div",null,"产品编码："),c.a.createElement("div",null,d.code)),c.a.createElement("div",null,c.a.createElement("div",null,"产品密钥："),c.a.createElement("div",null,(x=d.deviceKey,x=A?x:Object(Ea.l)(x,10)),c.a.createElement("span",{onClick:function(){P(!A)}},A?c.a.createElement(va.a,null):c.a.createElement(ga.a,null)))));return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"eidt-wrapper"},c.a.createElement(Ve.a,{title:d.productName,titleTag:d.schemeName,btnTxt:"编辑",backHandle:function(){f.push("/open/product/proManage/list")},backTitle:"开发流程",btnClickHandle:function(){R(!0)}},D),c.a.createElement("div",{className:"product-main-wrap comm-shadowbox"},c.a.createElement("div",{className:"product-main-wrap_step"},c.a.createElement(r.a,{current:I},g.map((function(e){return c.a.createElement(v,{key:e.title,title:e.title})})))),c.a.createElement(Ce.Provider,{value:{productIdInRoutePath:b}},c.a.createElement(i.Switch,null,c.a.createElement(i.Route,{path:"".concat(y,"/protocols"),render:function(e){return c.a.createElement(qe,ha({ref:S.active_0,isContinue:C},e,{nextStep:k,canOperate:E,productId:b}))}}),c.a.createElement(i.Route,{path:"".concat(y,"/firmpanel"),render:function(e){return c.a.createElement(vt.a,ha({ref:S.active_1,isContinue:C},e,{nextStep:k,canOperate:E,getProductBaseInfo:a,productId:b}))}}),c.a.createElement(i.Route,{path:"".concat(y,"/projectSelect"),render:function(e){return c.a.createElement(Et,ha({ref:function(e){return S.active_2=e},isContinue:C},e,{nextStep:k,canOperate:E,productId:b}))}}),c.a.createElement(i.Route,{path:"".concat(y,"/configService"),render:function(e){return c.a.createElement(da,ha({ref:S.active_3,isContinue:C},e,{nextStep:k,canOperate:E,productId:b}))}}),c.a.createElement(i.Route,{path:"".concat(y,"/validation"),render:function(e){return c.a.createElement(Vt,ha({ref:S.active_4,isContinue:C},e,{nextStep:k,canOperate:E,productId:b}))}}),c.a.createElement(i.Redirect,{to:"".concat(y,"/protocols")})))),c.a.createElement("div",{className:"product-main-footer"},I>0&&c.a.createElement(n.a,{style:{margin:"0 8px"},onClick:function(){j(I-1)},type:"primary",ghost:!0},"上一步"),I<g.length-1&&c.a.createElement(n.a,{type:"primary",onClick:function(){2===I?S["active_"+I].onFinish():S["active_"+I].current.onFinish()}},"下一步"),I===g.length-1&&c.a.createElement(n.a,{type:"primary",onClick:function(){S["active_"+I].current.showRelease()}},"发布产品"))),M&&c.a.createElement(ba,{titleVisible:M,onCloseTitle:function(){R(!1)},onOkClose:function(e){var t=wa(wa({},JSON.parse(sessionStorage.productItem)),e);p(t),sessionStorage.setItem("productItem",JSON.stringify(t)),Object(w.a)({type:"success",description:"更新成功！"}),R(!1)}}))}))},fAKH:function(e,t,a){},ggmS:function(e,t,a){},jXZW:function(e,t,a){},sTEO:function(e,t,a){},wkzE:function(e,t,a){}}]);