(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+ch6":function(e,t,n){"use strict";n("ef1R"),n("Ra8s"),n("HsXu"),n("bs69"),n("Lm8M"),n("ryEf"),n("qgAm"),n("Ck9u"),n("MNU5");var a=n("YeX6"),r=(n("UdMA"),n("ViyK")),o=(n("xzjF"),n("PeP6")),c=(n("sSxo"),n("I9ul"),n("pckg"),n("sfoS"),n("gAA8"),n("0Us0"),n("JiFE"),n("62KB"),n("9b3Y"),n("T9Mk")),i=n.n(c),l=n("El68");function u(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return o}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var f=o.a.Option,m=["按产品","按分组"];t.a=function(e){var t=e.list,n=e.searchedData,d=e.multiple,p=void 0!==d&&d,y=e.onRef,v=e.inputkey,g=s(Object(c.useState)(0),2),h=g[0],b=g[1],E=s(Object(c.useState)([-1]),2),O=E[0],I=E[1],P=s(Object(c.useState)(""),2),S=P[0],w=P[1],C=s(Object(c.useState)(!1),2),x=C[0],j=C[1],D=s(Object(c.useState)(!1),2),L=D[0],k=D[1];Object(c.useEffect)((function(){y&&y(N)}));var R=function(e,t){var n=e.findIndex((function(e){return t==e})),a=u(e);return n>-1&&a.splice(n,1),a},N=function(){var e={type:h};return S&&(e[v]=S),O.length>0&&-1!==O[0]&&(e.productIds=O.join(",")),e};return i.a.createElement("div",{className:"comm-search-box"},i.a.createElement(r.a.Group,{compact:!0,className:"inputgroup"},i.a.createElement(o.a,{value:h,onChange:function(e){b(e),I([-1])}},m.map((function(e,t){return i.a.createElement(f,{key:t,value:t},e)}))),i.a.createElement(o.a,{showSearch:!0,optionFilterProp:"children",mode:p?"multiple":"",defaultValue:[-1],value:O,onChange:!p&&function(e){I([e])}||void 0,onSelect:p&&function(e){I(-1==e?[-1]:function(t){var n=R(t,-1);return[].concat(u(n),[e])})}||void 0,onDeselect:p&&function(e){I((function(t){return R(t,e)}))}||void 0,style:{width:250}},i.a.createElement(f,{value:-1},"全部".concat(0==h?"产品":"分组")),t[h].map((function(e,t){var n=e.productId,a=e.id,r=e.name,o=e.productName;return i.a.createElement(f,{key:t,value:[n,a][h]},[o,r][h])}))),v&&i.a.createElement(r.a,{value:S,maxLength:30,placeholder:"请输入设备ID查询",style:{width:200},onChange:function(e){w(e.target.value)}})),i.a.createElement(a.a,{type:"primary",className:"btn",onClick:function(){j(!0),n(N()).finally((function(e){console.log("---rrr--",e),j(!1)}))},loading:x,icon:i.a.createElement(l.a,null)},"查询"),i.a.createElement(a.a,{type:"default",className:"btn",loading:L,onClick:function(){b(0),I([-1]),w(""),k(!0),n({}).finally((function(){k(!1)}))}},"重置"))}},C46E:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Ke}));n("bs69"),n("sfoS"),n("gAA8"),n("Lm8M"),n("ryEf"),n("J2lP"),n("DJj6");var a,r=n("T9Mk"),o=n.n(r),c=n("q5+0"),i=n("etip"),l=(n("SlgS"),n("lf9m"),n("IHDg"),n("ef1R"),n("P37N"),n("vV4J"),n("av3G"),n("RfWx"),n("Ra8s"),n("HsXu"),n("g+24"),n("BZgz")),u=(n("QcZr"),n("b+L2")),s=(n("MNU5"),n("YeX6")),d=(n("UdMA"),n("ViyK")),p=(n("kt2P"),n("enwP")),f=(n("xzjF"),n("PeP6")),m=(n("V9IP"),n("pckg"),n("B1aJ"),n("ivud")),y=n("DndG"),v=n("SRGg"),g=n("Nlzp"),h=n("Per8"),b=n("cu44"),E=n("MeRu"),O=n("+ch6"),I=n("P2RN");function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=k(e);if(t){var r=k(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return L(this,n)}}function L(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=f.a.Option,N={1:void 0,2:!0,3:!1},T=Object(m.b)((function(e){return{productList:e.getIn(["device","productList"]).toJS(),deviceStat:e.getIn(["device","deviceStat"]).toJS(),deviceList:e.getIn(["device","deviceList"]).toJS(),freshStatu:e.getIn(["device","freshStatu"])}}),(function(e){return{getProductList:function(t){return e(Object(h.f)(t))},getDeviceStat:function(t){return e(Object(h.d)(t))},getDeviceList:function(t){return e(Object(h.c)(t))}}}))(a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(c,e);var t,n,a,r=D(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).getProductList=function(){t.props.getProductList({pageIndex:1,pageRows:9999})},t.getGroupList=function(){Object(g.c)(g.a.getGroupList,{pageIndex:1,pageRows:9999}).then((function(e){t.setState({groupList:e.data&&e.data.list||[]})}))},t.getCountDataParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"classType",n=t.state.countDataParams,a=n.classType,r=n.productId,o=n.subgroupId,c=C({},e,a);return 1==a?c.productId=r:2==a&&(c.subgroupId=o),c},t.getListParams=function(){var e=w({},t.state.listParams),n=e.innet,a=e.online;return e.innet=N[n],e.online=N[a],e},t.getDeviceStat=function(){return t.props.getDeviceStat(t.getCountDataParams("type"))},t.getDeviceList=function(){var e=t.getCountDataParams("classType"),n=t.getListParams();return t.props.getDeviceList(w(w({},e),n))},t.onChangeListParams=function(e,n){console.log(e,n);var a=w({},t.state.listParams);a[e]=n.trim&&n.trim()||n||void 0,t.setState({listParams:a})},t.inquireDeviceList=function(){var e=w({},t.state.listParams);e.pageIndex=1,t.setState({listParams:e},t.getDeviceList)},t.searchedData=function(e){var n=e.type,a=void 0===n?0:n,r=e.productIds;return console.log(99,e),t.setState({countDataParams:{classType:++a,productId:r,subgroupId:r}},(function(){t.getDeviceList(),t.getDeviceStat()})),Promise.resolve(1)},t.changePage=function(e){var n=w({},t.state.listParams);n.pageIndex=e,t.setState({listParams:n},t.getDeviceList)},t.resetSearch=function(){t.setState({listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},t.getDeviceList)},t.exportData=function(){var e=w(w({superInstanceId:localStorage.getItem("superInstanceId")},t.getCountDataParams()),t.getListParams()),n="?";for(var a in e)void 0!==e[a]&&(n+="".concat(a,"=").concat(e[a],"&"));var r=window.location.origin+g.a.exportDeviceList+n.replace(/&$/,"");try{window.open(r)}catch(e){Object(I.a)({description:e,type:"error"})}},t.state={groupList:[],countDataParams:{classType:1,productId:void 0,subgroupId:void 0},listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},t}return t=c,(n=[{key:"componentDidMount",value:function(){this.getProductList(),this.getGroupList(),this.getDeviceStat(),this.getDeviceList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.listParams,a=t.groupList,r=this.props,c=r.productList,i=r.deviceStat,m=r.deviceList,g=r.freshStatu,h=m.pager,I=void 0===h?{}:h,P=m.list,S=void 0===P?[]:P,w=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"物理地址",dataIndex:"deviceMac",key:"deviceMac"},{title:"产品",dataIndex:"productName",key:"productName"},{title:"分类",dataIndex:"productType",key:"productType"},{title:"所属分组",dataIndex:"groupName",key:"groupName"},{title:"类型",dataIndex:"productClass",key:"productClass",render:function(e){return{0:"普通设备",1:"网关设备"}[e]||"--"}},{title:"操作",key:"opt_detail",render:function(e,t){return o.a.createElement("span",null,o.a.createElement(y.b,{key:"detail",to:"/open/base/device/onlineDevice/details/"+t.deviceId},"查看"))}}],C=i.exception,x=i.total,j=i.totalActive,D=i.todayActive,L=n.pageIndex,k=n.pageRows,N=n.infoType,T=n.field,_=n.labelKey,A=n.labelValue,K=n.innet,M=n.online;return o.a.createElement("section",{className:"page-main-wrapper flex-column devicelistpage"},o.a.createElement(E.a,{noback:!0,title:"设备管理"}),o.a.createElement("header",{className:"page-content-header"},o.a.createElement(O.a,{list:[c,a],searchedData:this.searchedData}),o.a.createElement("div",{className:"count-data-box"},o.a.createElement("ul",{className:"device-inine-data"},o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"当前异常数"),o.a.createElement("span",{className:"count"},C||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"累计设备总数"),o.a.createElement("span",{className:"count"},x||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"累计入网总数"),o.a.createElement("span",{className:"count"},j||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"今日入网总数"),o.a.createElement("span",{className:"count"},D||0))),o.a.createElement("div",{className:"device-refresh",onClick:this.getDeviceStat},o.a.createElement("span",null,"刷新"),o.a.createElement(v.a,{className:"device-refresh-icon",spin:!g})))),o.a.createElement("div",{className:"flex-column flex1"},o.a.createElement(b.a,{title:"联网设备列表"},o.a.createElement("div",{className:"alone-section-content-default"},o.a.createElement(p.a,{title:"最多导出1千条数据",placement:"top"},o.a.createElement("a",{href:"javascript:void(0)",className:"btn-exportdata",onClick:this.exportData},"导出数据")),o.a.createElement("div",{className:"lineSearchBox"},o.a.createElement("div",{className:"search-info-box"},o.a.createElement("div",{className:"searchBox"},o.a.createElement(d.a.Group,{compact:!0},o.a.createElement(f.a,{className:"type-select",value:N,onChange:function(t){e.onChangeListParams("infoType",t)}},o.a.createElement(R,{value:1},"设备ID"),o.a.createElement(R,{value:2},"物理地址")),o.a.createElement(d.a,{className:"input",maxLength:100,value:T,placeholder:"请输入设备ID号",onChange:function(t){e.onChangeListParams("field",t.target.value)}}))),o.a.createElement("span",{className:"margin-left-10px"},"设备标签："),o.a.createElement(d.a,{className:"input",placeholder:"请输入标签Key",maxLength:100,value:_,onChange:function(t){e.onChangeListParams("labelKey",t.target.value)}}),o.a.createElement(d.a,{className:"input margin-left-10px",placeholder:"请输入标签Value",maxLength:100,value:A,onChange:function(t){e.onChangeListParams("labelValue",t.target.value)}}),o.a.createElement(f.a,{className:"type-select margin-left-10px",value:K,onChange:function(t){e.onChangeListParams("innet",t)}},o.a.createElement(R,{value:1},"已/未入网"),o.a.createElement(R,{value:2},"已入网"),o.a.createElement(R,{value:3},"未入网")),o.a.createElement(f.a,{className:"type-select margin-left-10px",value:M,onChange:function(t){e.onChangeListParams("online",t)}},o.a.createElement(R,{value:1},"在/离线"),o.a.createElement(R,{value:2},"在线"),o.a.createElement(R,{value:3},"离线"))),o.a.createElement("div",{className:"searchBut"},o.a.createElement(s.a,{className:"btn",type:"primary",onClick:this.inquireDeviceList},"查询"),o.a.createElement(s.a,{className:"btn",onClick:this.resetSearch},"重置"))),o.a.createElement(u.a,{className:"devicetablelist",rowKey:"deviceUniqueId",dataSource:S,columns:w,pagination:!1})),o.a.createElement("div",{className:"list-pagination"},I&&I.totalRows>0&&o.a.createElement(l.a,{className:"self-pa",total:I.totalRows,current:L,defaultCurrent:1,defaultPageSize:k,onChange:function(t){return e.changePage(t)},showTotal:function(e){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,e)," 条")},showQuickJumper:!0,hideOnSinglePage:!0})))))}}])&&x(t.prototype,n),a&&x(t,a),c}(r.PureComponent))||a,_=(n("UTJx"),n("dVdO")),A=(n("SmMv"),n("DTgQ")),K=(n("9b3Y"),n("hz08"),n("FC04")),M=n("R2s5"),V=n("M7r8");function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Y(e);if(t){var r=Y(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return B(this,n)}}function B(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(c,e);var t,n,a,r=G(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).state={},t}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e={labelCol:{span:4},wrapperCol:{span:20}},t=this.props.form,n=t.getFieldDecorator,a=t.getFieldValue;return o.a.createElement(M.a,e,o.a.createElement(M.a.Item,{label:"分组名称"},n("name",{rules:[{required:!0,message:"请输入分组名称"},{max:50,message:"最大输入长度为50"}]})(o.a.createElement(d.a,{placeholder:"请输入分组名称"}))),o.a.createElement(V.a,{label:"分组描述",formId:"remark",astrictNub:"50",rows:"4",placeholder:"分组描述",getFieldDecorator:n,getFieldValue:a}))}}])&&U(t.prototype,n),a&&U(t,a),c}(r.Component),J=M.a.create({name:"caseAdd"})(H),Q=(n("ECLI"),n("yq+b")),W=n.n(Q);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ne(e);if(t){var r=ne(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return ee(this,n)}}function ee(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?te(e):t}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(c,e);var t,n,a,r=$(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.c)(g.a.getGroupList,e).then((function(e){t.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})}))},t.addCase=function(){t.setState({addCaseVisible:!0})},t.openDel=function(e,n){t.setState({id:e,name:n})},t.delOkCancel=function(e){if("ok"==e){var n=t.state,a=n.id,r=n.pageIndex;r=r||1,Object(g.c)(g.a.deleteGroup,{id:a}).then((function(e){0==e.code&&t.setState({loading:!0,id:""},(function(){t.getList({pageIndex:r,pageRows:10})}))}))}else t.setState({id:""})},t.searchCase=function(e){t.setState({loading:!0,searchName:e},(function(){t.pagerIndex(1)}))},t.updateModal=function(e){1==e?(0,t.addFormRefs.props.form.validateFieldsAndScroll)((function(e,n){var a=n.name,r=n.remark;e||Object(g.d)(g.a.updateGroup,{name:a,remark:r}).then((function(e){0==e.code&&(Object(I.a)({type:"success",description:"新增成功！"}),t.addCancel(),t.pagerIndex(1))}))})):t.addCancel()},t.addCancel=function(){t.setState({addCaseVisible:!1}),t.addFormRefs.props.form.resetFields()},t.pagerIndex=function(e){t.setState({pageIndex:e,loading:!0},(function(){t.getList({pageIndex:e,pageRows:10,name:t.state.searchName||void 0})}))},t.state={loading:!0,caseList:[],pager:{},searchName:"",name:"",id:"",addCaseVisible:!1,pageIndex:"1"},t.columns=[{title:"分组名称",dataIndex:"name",key:"name"},{title:"分组ID",dataIndex:"id",key:"id"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"添加时间",dataIndex:"createTime",key:"createTime",render:function(e){return o.a.createElement("span",null,e&&W()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"140px",render:function(e,n){return o.a.createElement("span",null,o.a.createElement(y.b,{to:"/open/base/device/groupDetails/".concat(n.id,"/").concat(n.groupId)},"查看"),o.a.createElement(A.a,{type:"vertical"}),o.a.createElement("a",{onClick:t.openDel.bind(te(t),n.id,n.name)},"删除"))}}],t}return t=c,(n=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.addCaseVisible,r=t.caseList,c=t.pager,i=t.id,l=t.name;return o.a.createElement("div",{className:"devicegroup-box"},o.a.createElement("header",{className:"page-content-header"},o.a.createElement(E.a,{noback:!0,title:"设备分组管理"}),o.a.createElement("div",null,o.a.createElement("div",{className:"searchBox"},o.a.createElement(d.a.Search,{placeholder:"请输入分组名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}})),o.a.createElement("div",{className:"butFloatRight"},o.a.createElement(s.a,{className:"but-add",type:"primary",onClick:this.addCase},"新增分组")))),o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(u.a,{rowKey:"id",columns:this.columns,dataSource:r,pagination:{defaultCurrent:c.pageIndex,total:c.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:c.pageIndex},loading:n}))),o.a.createElement(_.a,{title:"新增分组",visible:a,width:600,onOk:this.updateModal.bind(this,1),onCancel:this.updateModal.bind(this,2),maskClosable:!1,className:"self-modal"},o.a.createElement(J,{onRef:function(t){return e.addFormRefs=t}})),o.a.createElement(K.a,{visible:!!i,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"删除分组",descText:"即将删除分组",targetName:l}))}}])&&Z(t.prototype,n),a&&Z(t,a),c}(r.Component),re=(n("miF7"),n("QnTe")),oe=n("CvKH"),ce=n.n(oe),ie=(n("JiFE"),n("cFqh"),n("9RSv")),le=(n("oENA"),n("uTCA")),ue=(n("0Us0"),n("62KB"),n("FIdd"));n("sSxo"),n("I9ul"),n("qgAm"),n("Ck9u");function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);c=!0);}catch(e){i=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw r}}return o}(e,t)||de(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var fe=function(e){var t=e.productList,n=e.changedfunc,a=e.searchedFunc,c=se(Object(r.useState)([-1]),2);c[0],c[1];return o.a.createElement("div",{className:"search-box"},o.a.createElement(d.a.Group,{compact:!0},o.a.createElement(f.a,{showSearch:!0,optionFilterProp:"children",defaultValue:[-1],onChange:n,style:{width:200}},o.a.createElement(f.a.Option,{value:-1},"全部产品"),t.map((function(e,t){return o.a.createElement(f.a.Option,{key:t,value:e.productId},e.productName)}))),o.a.createElement(d.a.Search,{enterButton:!0,maxLength:30,placeholder:"请输入设备ID查询",onSearch:a,style:{width:300}})))};function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Ie(e);if(t){var r=Ie(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(c,e);var t,n,a,r=Ee(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).getCreateProduct=function(){Object(g.c)(g.a.getCreateProduct,{pageRows:999}).then((function(e){var n=e.data.list;n&&n.length&&n.length>0&&t.setState({addProductList:n})}))},t.getGroupAddDevList=function(){t.setState({listLoading:!0});var e=ve({},t.state.addListParams);-1==e.productId&&delete e.productId,Object(g.c)(g.a.getGroupSlctDev,e).then((function(e){var n=e.data||{},a=n.list,r=n.pager;0==e.code&&t.setState({list:a,pager:r})})).finally((function(){t.setState({listLoading:!1})}))},t.setQuestParams=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=ve({},t.state.addListParams);r[e]=n||void 0,"pageIndex"!==e&&(r.pageIndex=1),t.setState({addListParams:r},!a&&t.getGroupAddDevList||void 0)},t.onSelectRowKeys=function(e){t.setState({selectedRowKeys:e})},t.addDeviceOk=function(){var e=t.state,n=e.addWay,a=e.selectedRowKeys;if(1==n){var r=a;r.length>0&&Object(g.d)(g.a.addGroupDevice,{id:t.props.id,deviceIds:r.join(",")}).then((function(e){t.setState({selectedRowKeys:[]}),t.props.openCloseAdd(!0)}))}else 2==n&&t.publicTypeForm()},t.addUPload=function(e){e.groupId=t.props.groupid,e.type=1,Object(g.d)(g.a.addDevice,e).then((function(e){t.props.openCloseAdd(!0)}))},t.changeAddWay=function(e){var n=e.target.value;t.setState({addWay:n})},t.state={addWay:1,listLoading:!1,list:[],pager:{},selectedRowKeys:[],addListParams:{pageIndex:1,pageRows:8,id:e.id,productId:-1,deviceUniqueId:void 0},addProductList:[]},t.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return o.a.createElement("span",null,e&&W()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}}],t}return t=c,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this),this.getCreateProduct()}},{key:"render",value:function(){var e=this,t=this.props,n=t.addVisiable,a=t.openCloseAdd,r=this.state,c=r.selectedRowKeys,i=r.list,l=r.pager,s=r.addWay,d=r.listLoading,p=r.addProductList,f={selectedRowKeys:c,onChange:this.onSelectRowKeys};return o.a.createElement(_.a,{title:"添加设备到分组",visible:n,width:750,onOk:this.addDeviceOk,onCancel:function(){a(!1)},maskClosable:!1,closable:!1,className:"groupadd-device-modal"},o.a.createElement("div",{className:"addtype"},o.a.createElement(le.a.Group,{value:s,onChange:this.changeAddWay},o.a.createElement(le.a,{value:1},"查找选择"),o.a.createElement(le.a,{value:2},"本地导入"))),1==s?o.a.createElement("div",{className:""},o.a.createElement(fe,{productList:p,changedfunc:function(t){e.setQuestParams("productId",t,!0)},searchedFunc:function(t){e.setQuestParams("deviceUniqueId",t)}}),o.a.createElement("div",{className:"list-content"},o.a.createElement(u.a,{rowKey:"deviceId",columns:this.columns,dataSource:i,rowSelection:f,loading:!!d,pagination:{defaultCurrent:l.pageIndex,total:l.totalRows,onChange:function(t){e.setQuestParams("pageIndex",t)},current:l.pageIndex}}))):o.a.createElement(Se,{productList:p,onRef:function(t){return e.publicTypeForm=t},addUPload:this.addUPload}))}}])&&he(t.prototype,n),a&&he(t,a),c}(r.PureComponent),Se=M.a.create({name:"form-upload-device"})((function(e){var t=e.form,n=e.productList,a=e.onRef,c=e.addUPload;Object(r.useEffect)((function(){a(u)}),[]);var i=t.getFieldDecorator,l=t.validateFields,u=function(){l((function(e,t){if(console.log(3333,t),!e){var n=t.data,a=t.productId,r="";if(n&&n.fileList&&n.fileList.length){var o=n.fileList[0];o&&o.response&&o.response.data&&(r=o.response.data.url)}c({productId:a,data:r})}}))},d={labelCol:{span:6},wrapperCol:{span:10}};return o.a.createElement("div",null,o.a.createElement(M.a,d,o.a.createElement(M.a.Item,{label:"产品"},i("productId",{rules:[{required:!0,message:"请选择产品！"}],initialValue:""})(o.a.createElement(f.a,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择产品"},o.a.createElement(f.a.Option,{value:"",disabled:!0,selected:!0},"请选择产品"),n.map((function(e){var t=e.productName,n=e.productId;return o.a.createElement(f.a.Option,{key:n,value:n},t)}))))),o.a.createElement(M.a.Item,{label:"上传文件"},i("data",{rules:[{required:!0,message:"请上传文件！"}]})(o.a.createElement(ie.a,{accept:".xls,.xlsx",action:g.a.upFileUrl,data:{appId:31438,domainType:4}},o.a.createElement(s.a,{type:"primary",icon:o.a.createElement(ue.a,null)},"上传文件"),o.a.createElement("span",{style:{marginLeft:"15px"}},"仅支持.xls,.xlsx格式文件"))),o.a.createElement("a",{href:"http://skintest.hetyj.com/31438/6b0b20891e06ac31d0eed37a5083cca9.xlsx"},"下载模板"))))}));function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ke(e);if(t){var r=ke(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return De(this,n)}}function De(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?Le(e):t}function Le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(c,e);var t,n,a,r=je(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).openDel=function(e,n){t.setState({delVisable:!0}),e&&(console.log(e),t.setState({delid:e,deldeviceUniqueId:n}))},t.getDetail=function(){Object(g.c)(g.a.getGroupDetail,{id:t.id}).then((function(e){var n=e.data,a=n.name,r=n.createTime,o=n.remark,c=n.deviceCount,i=n.activeCount,l=n.groupId;t.setState({name:a,remark:o,deviceCount:c,activeCount:i,groupId:l,createTime:W()(r).add(8,"h").format("YYYY-MM-DD HH:mm:ss")})}))},t.getDownProduct=function(){Object(g.c)(g.a.getDownProduct,{pageRows:999}).then((function(e){var n=e.data.list;n&&n.length&&n.length>0&&t.setState({productList:n})}))},t.getGroupDevList=function(){var e=ce()(t.state.listParams);-1==e.productId&&delete e.productId,Object(g.c)(g.a.getGroupDeviceList,e).then((function(e){var n=e.data||{},a=n.list,r=n.pager;t.setState({groupDevList:a,pager:r})}))},t.setParams=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=ce()(t.state.listParams);r[e]=n||void 0,"pageIndex"!==e&&(r.pageIndex=1),t.setState({listParams:r},!a&&t.getGroupDevList||void 0)},t.openCloseAdd=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!t.state.addVisiable;t.setState({addVisiable:n}),n?(t.addListRefs.setQuestParams("pageIndex",1),t.addListRefs.setState({addWay:1})):e&&t.getGroupDevList()},t.onSelectRowKeys=function(e){t.setState({selectedRowKeys:e})},t.delOkCancel=function(e){var n=t.state,a=n.delid,r=n.selectedRowKeys;"ok"==e?Object(g.d)(g.a.delGroupDevice,{id:t.id,deviceIds:a||r.join(",")}).then((function(e){0==e.code&&(t.getGroupDevList(),t.setState({delid:"",delVisable:!1,selectedRowKeys:[]}))})):t.setState({delid:"",delVisable:!1})},t.id=e.match.params.groupid,t.groupidid=e.match.params.groupidid,t.defaultListParams={pageIndex:1,pageRows:10,id:t.id,productId:-1,deviceUniqueId:void 0},t.addListRefs=null,t.state={listParams:ce()(t.defaultListParams),name:"--",groupId:"--",createTime:"--",remark:"--",deviceCount:"--",activeCount:"--",groupDevList:[],pager:{},productList:[],addVisiable:!1,addProductList:[],selectedRowKeys:[],delid:"",deldeviceUniqueId:"",delVisable:!1},t.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"设备类型",dataIndex:"productClass",key:"productClass",render:function(e){return o.a.createElement("span",null,0==e?"普通设备":"网关设备")}},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return o.a.createElement("span",null,e&&W()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"200px",render:function(e,n){return o.a.createElement("span",null,o.a.createElement(y.b,{key:"detail",to:"/open/base/device/onlineDevice/details/"+n.deviceId},"查看"),o.a.createElement(A.a,{type:"vertical"}),o.a.createElement("a",{onClick:t.openDel.bind(Le(t),n.deviceId,n.deviceUniqueId)},"从分组中删除"))}}],t}return t=c,(n=[{key:"componentDidMount",value:function(){this.getDetail(),this.getDownProduct(),this.getGroupDevList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,a=t.createTime,r=t.remark,c=t.deviceCount,i=t.activeCount,l=t.groupId,d=t.productList,p=t.groupDevList,f=t.addVisiable,m=t.selectedRowKeys,y=t.pager,v=t.delVisable,g=t.delid,h=t.deldeviceUniqueId,O=t.addProductList,I={selectedRowKeys:m,onChange:this.onSelectRowKeys};return o.a.createElement("section",{className:"page-main-wrapper groupdetailpage flex-column"},o.a.createElement(E.a,{title:"设备分组详情"}),o.a.createElement("header",{className:"page-content-header"},o.a.createElement(re.b,{title:"",className:"descriptions",column:2},o.a.createElement(re.b.Item,{label:"分组名称"},n),o.a.createElement(re.b.Item,{label:"分组ID"},l),o.a.createElement(re.b.Item,{label:"创建时间"},a),o.a.createElement(re.b.Item,{label:"描述"},r)),o.a.createElement("ul",{className:"device-inine-data"},o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"设备总数"),o.a.createElement("span",{className:"count"},c)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"激活设备数"),o.a.createElement("span",{className:"count"},i)))),o.a.createElement(b.a,{title:"设备列表"},o.a.createElement("div",{className:"alone-section-content-default"},o.a.createElement(fe,{productList:d,changedfunc:function(t){e.setParams("productId",t,!0)},searchedFunc:function(t){e.setParams("deviceUniqueId",t)}}),o.a.createElement("div",{className:"search-box"},o.a.createElement(s.a,{className:"but-add",type:"primary",onClick:this.openCloseAdd},"添加设备到分组")),o.a.createElement("div",null,o.a.createElement(s.a,{disabled:0==m.length,className:"but-del",type:"primary",onClick:this.openDel.bind(this,0)},"删除"),o.a.createElement(u.a,{rowKey:"deviceId",columns:this.columns,dataSource:p,rowSelection:I,pagination:{defaultCurrent:y.pageIndex,total:y.totalRows,hideOnSinglePage:!1,onChange:function(t){e.setParams("pageIndex",t)},current:y.pageIndex}})))),o.a.createElement(Pe,{addVisiable:f,onRef:function(t){e.addListRefs=t},productList:O,id:this.id,groupid:this.groupidid,openCloseAdd:this.openCloseAdd}),o.a.createElement(K.a,{visible:v,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"从分组中删除",descText:"即将删除".concat(g?"设备":"选中的"),targetName:g?"".concat(h):"".concat(m.length,"个设备")}))}}])&&Ce(t.prototype,n),a&&Ce(t,a),c}(r.PureComponent),Ne=(n("Zy8g"),Object(i.a)((function(){return Promise.all([n.e("common"),n.e("vendor"),n.e(2),n.e(14)]).then(n.bind(null,"kZcz"))}))),Te=Object(i.a)((function(){return n.e(15).then(n.bind(null,"R4Qp"))})),_e=Object(i.a)((function(){return Promise.all([n.e("common"),n.e("vendor"),n.e(17)]).then(n.bind(null,"vT3+"))})),Ae=Object(i.a)((function(){return Promise.all([n.e("common"),n.e("vendor"),n.e(16)]).then(n.bind(null,"lunQ"))}));function Ke(e){var t=e.match.path;return o.a.createElement(c.e,null,o.a.createElement(c.c,{path:"".concat(t,"/onlineDevice/list"),component:T}),o.a.createElement(c.c,{path:"".concat(t,"/onlineDevice/details/:deviceid"),component:Ne}),o.a.createElement(c.c,{path:"".concat(t,"/deviceSecret"),component:Te}),o.a.createElement(c.c,{path:"".concat(t,"/groups"),component:ae}),o.a.createElement(c.c,{path:"".concat(t,"/groupDetails/:groupid/:groupidid"),component:Re}),o.a.createElement(c.c,{path:"".concat(t,"/deviceWarning"),component:_e}),o.a.createElement(c.c,{path:"".concat(t,"/addWarningConfig"),component:Ae}),o.a.createElement(c.c,{path:"".concat(t,"/warningConfig/:id"),component:Ae}),o.a.createElement(c.b,{to:"".concat(t,"/onlineDevice/list")}))}},ECLI:function(e,t,n){},Zy8g:function(e,t,n){}}]);