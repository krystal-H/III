(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"0eIn":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAACB0lEQVQ4T32ST2sTQRjGn9nZTTEKBeOtbv1T7zUHi8vmZMCw/QCBYsGT+DH88wEUeoseVTx4USyJFWpVYldaEJQEFROxCVqbi1Q0oWZnXpmZ3XRz0IXd2d2Z9/c+7/s+7HmzFzBChUi4RACZBwgYX6X6p/bQJViXS2fcmjrCXjS+d6QkdywoDdBAA44BitwtzZ2Y1oC1d9uUZDVJyagAYDGrcC4/9Up/AHi6ueVLIepqNzh7kmnAs7ffVISWTFI/RxDObb+Yn1pPA4QCEGHem0kAXzskyTWZk7pjFUlP0srUIYbuvHfKlLD6ZjsgiAqRdEe1GpIGDiWwvjOJ97uHMIhsHJ6IkJsYLu9QtvygzAZaxr8u7wYdsA5i1bbgZSzAYYATrxmOcJhB8b+Awm26agNXksCFWeBRA9Awc19jK5tfAoBVSKoS4mbGXrj1aRq/hw4cbrI/vAhcuLuvwrHQZisbWx1Vf9pAyfvSxxlwMCzmgYXT+4U+bgC1plbyhz15/Vm3jBMvnPeOjWZeDVv+nZZb74uMzq5k31sELt03CjKqHxxtVg3b2jWcc780d3w08+rLD/7Gj1y9uXtk1LzyLLDcMOUooK16UAvb2srGpuPzjyTDWu8ofkbZ8QmY4HBPoMiqYSsgQRWpfBAbJu0HQQytXzn09iYhyEaWiz5jfKkfWddvltngL3uXRG6qfr/OAAAAAElFTkSuQmCC"},"5pZq":function(e,t,n){},Dldd:function(e,t,n){},"WO/V":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Y}));n("pNMO"),n("4Brf"),n("07d7"),n("0oug"),n("4mDm"),n("PKPk"),n("3bBZ"),n("+2oP"),n("sMBO"),n("pjDv"),n("tkto"),n("TeQF"),n("5DmW"),n("FZtP"),n("27RR"),n("mbEz");var r=n("wCAj"),a=(n("L/Qf"),n("2/Rp")),c=(n("qNb/"),n("PArb")),o=(n("1vPl"),n("5rEg")),i=(n("RKNx"),n("L41K")),l=(n("8QGh"),n("2fM7")),u=n("BkRI"),s=n.n(u),p=(n("2B1R"),n("zKZe"),n("q1tI")),d=n.n(p),m=n("MeRu"),f=n("0eIn"),b=n.n(f),y=n("mU7p"),v=n("Nlzp"),E=(n("k3Gp"),n("kLXV")),O=(n("TfFZ"),n("3S7+")),g=(n("tULf"),n("Vl3Y")),j=n("zqxM"),h=n.n(j),w=(n("ma9I"),n("pDQq"),n("Lyp1")),A=n("/MfK"),S=n("Ue1A"),I=n("P2RN");n("5pZq");function k(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,c=[],o=!0,i=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(c.push(r.value),!t||c.length!==t);o=!0);}catch(e){i=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(i)throw a}}return c}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=l.a.Option;function Z(e){var t=e.visible,n=e.onCancel,r=e.type,c=e.allProductList,i=e.editData,u=P(g.a.useForm(),1)[0],m=P(Object(p.useState)(!1),2),f=m[0],b=m[1],y=P(Object(p.useState)(""),2),j=y[0],C=y[1],N=P(Object(p.useState)([]),2),x=N[0],T=N[1],Z=P(Object(p.useState)([]),2),z=Z[0],B=Z[1];Object(p.useEffect)((function(){"edit"===r&&(L(i.productId),u.setFieldsValue(i),T(i.timeServerDetails))}),[]),Object(p.useEffect)((function(){console.log(x)}),[x]),Object(p.useEffect)((function(){console.log(j,"protocolItemIndex--------")}),[j]);var L=function(e){Object(v.c)(v.a.getPhysicalModel,{productId:e}).then((function(e){console.log(e),B(e.data.properties)}))},Q=function(){var e=s()(z).map((function(e){return e.identifier})),t=[];"add"===r&&(t=s()(x).map((function(e){return e.identifier}))),"edit"===r&&(t=s()(x).map((function(e){return e.property})));var n=h()(e,t),a=[];return s()(z).forEach((function(e){n.forEach((function(t){e.identifier==t&&a.push(e)}))})),a};return d.a.createElement(E.a,{title:"add"===r?"添加云端定时功能":"编辑云端定时功能",width:655,visible:t,onOk:function(){u.submit()},onCancel:n,maskClosable:!1,destroyOnClose:!0,wrapClassName:"replace-module-modal"},d.a.createElement("div",{className:"cloud-manage-modal"},d.a.createElement(g.a,{form:u,onFinish:function(e){var t=[];"add"===r?t=x.map((function(e){return{property:e.identifier,propertyName:e.name,functionDataType:e.dataType.type}})):(t=x.map((function(e){return{property:e.property||e.identifier,propertyName:e.propertyName||e.name,functionDataType:e.functionDataType||e.dataType.type}})),e.serviceId=i.serviceId),e.timeServerDetails=t,console.log("提交的参数",D({},e)),Object(v.c)(v.a.saveTimeService,D({},e),{loading:!0}).then((function(e){Object(I.a)({description:"操作成功！",type:"success"}),n()}))},labelCol:{span:4},wrapperCol:{span:19}},d.a.createElement(g.a.Item,{label:"功能名称",name:"serviceName",rules:[{required:!0,message:"请输入功能名称"},{max:20,message:"最大输入长度为20"}]},d.a.createElement(o.a,{placeholder:"不超过20个字符"})),d.a.createElement(g.a.Item,{label:"归属产品",name:"productId",rules:[{required:!0,message:"请选择归属产品"}]},d.a.createElement(l.a,{onChange:function(e){return L(e)}},c&&c.map((function(e){return d.a.createElement(R,{key:e.productId,value:e.productId},e.productName)})))),d.a.createElement(g.a.Item,{label:d.a.createElement(d.a.Fragment,null,"关联协议",d.a.createElement(O.a,{title:"仅支持可下发类型数据",placement:"top"},d.a.createElement(w.a,null)))},x.length>0&&d.a.createElement("div",{className:"show-protocol-box"},x.map((function(e,t){return d.a.createElement("div",{className:"protocol-bar",key:t},d.a.createElement("p",{className:"protocol-bar-title"},e.name||e.propertyName),d.a.createElement("div",null,d.a.createElement("span",null,e.identifier||e.property)),d.a.createElement("span",{className:"protocol-bar-del",onClick:function(){return function(e){var t=s()(x);t.splice(e,1),T(t)}(t)}},d.a.createElement(A.a,null)," 删除"))}))),f&&d.a.createElement("div",{className:"select-protocol-box"},d.a.createElement("div",null,d.a.createElement(l.a,{value:j,onChange:function(e){C(e)},style:{width:365}},d.a.createElement(R,{key:"",value:""},"请选择需要相关的协议"),Q().map((function(e,t){return d.a.createElement(R,{key:e.identifier,value:e.identifier},e.name)})))),d.a.createElement("div",{className:"control-btns"},d.a.createElement("div",{className:"confirm-btn",onClick:function(){return function(){if(""===j)return Object(I.a)({type:"error",message:"参数缺失",description:"请先选择一个控制协议字段"});T((function(e){var t=s()(e),n=z.filter((function(e){return e.identifier===j}));return[].concat(k(t),k(n))})),b(!1),C("")}()}},d.a.createElement(S.a,null)," 确定"),d.a.createElement("div",{className:"del-btn",onClick:function(){return b(!1),void C("")}},d.a.createElement(A.a,null)," 删除"))),d.a.createElement(a.a,{className:"add-btn",onClick:function(){b(!0)}},"添加功能点")))))}var z=n("FC04");function B(e){var t=e.operate,n=e.visible,r=e.updateOkHandle,a=e.updateCancelHandle,c=(e.changeStatus,null);switch(t){case 1:c={title:"发布云端定时功能",desc:"即将发布的功能",tip:"功能发布后，APP上可以看到并启用，是否确认发布？",needWarnIcon:!1};break;case 2:c={title:"删除云端定时功能",desc:"即将删除的功能",tip:"功能删除后将无法找回，是否确认删除？",needWarnIcon:!0};break;case 0:c={title:"下线云端定时功能",desc:"即将下线的功能",tip:"功能下线后将无法看到，是否确认下线？",needWarnIcon:!0}}return d.a.createElement(z.a,{visible:n,modalOKHandle:function(){return r(t)},modalCancelHandle:a,targetName:"test",title:c.title,descGray:!0,needWarnIcon:c.needWarnIcon,descText:c.desc,tipText:c.tip})}n("Dldd");function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,c=[],o=!0,i=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(c.push(r.value),!t||c.length!==t);o=!0);}catch(e){i=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(i)throw a}}return c}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H=l.a.Option,V=i.a.Step,K=o.a.Search;function Y(){var e=W(Object(p.useState)(null),2),t=e[0],n=e[1],o=W(Object(p.useState)(!1),2),u=o[0],f=o[1],E=W(Object(p.useState)(!1),2),O=E[0],g=E[1],j=W(Object(p.useState)([]),2),h=j[0],w=j[1],A=W(Object(p.useState)(""),2),S=A[0],I=A[1],k=W(Object(p.useState)(""),2),C=k[0],D=k[1],N=W(Object(p.useState)(!1),2),P=N[0],x=N[1],T=W(Object(p.useState)([]),2),R=T[0],z=T[1],U=W(Object(p.useState)([]),2),Y=U[0],q=U[1],F=[{title:"功能名称",dataIndex:"serviceName",key:"serviceName"},{title:"关联协议",dataIndex:"propertyName",key:"propertyName",render:function(e,t){return d.a.createElement("div",null,t.timeServerDetails&&t.timeServerDetails.map((function(e,t){return d.a.createElement("div",{key:t},e.propertyName)})))}},{title:"协议数据标识",dataIndex:"property",key:"property",render:function(e,t){return d.a.createElement("div",null,t.timeServerDetails&&t.timeServerDetails.map((function(e,t){return d.a.createElement("div",{key:t},e.property)})))}},{title:"归属产品名称",dataIndex:"productName",key:"productName"},{title:"协议数据类型",dataIndex:"functionDataType",key:"functionDataType",render:function(e,t){return d.a.createElement("div",null,t.timeServerDetails&&t.timeServerDetails.map((function(e,t){return d.a.createElement("div",{key:t},e.functionDataType)})))}},{title:"状态",dataIndex:"status",key:"status",width:120,render:function(e,t){return d.a.createElement("span",null,y.b[t.status])}},{title:"操作",key:"action",width:200,render:function(e,t){return d.a.createElement("span",null,1!==t.status?d.a.createElement(d.a.Fragment,null,d.a.createElement("a",{onClick:function(){ee(t)}},"编辑"),d.a.createElement(c.a,{type:"vertical"}),d.a.createElement("a",{onClick:function(){re(t,1)}},"发布"),d.a.createElement(c.a,{type:"vertical"}),d.a.createElement("a",{onClick:function(){re(t,2)}},"删除")):d.a.createElement("a",{onClick:function(){re(t,0)}},"下线"))}}],M=W(Object(p.useState)([]),2),G=M[0],X=M[1],J=W(Object(p.useState)({pageIndex:1,totalRows:0,pageRows:6}),2),$=J[0],_=J[1];Object(p.useEffect)((function(){te()}),[]),Object(p.useEffect)((function(){ne()}),[$.pageIndex,$.pageRows,C,S]);var ee=function(e){z(e),x(!0)},te=function(){Object(v.b)(v.a.cloudGetProductList).then((function(e){w(e.data)}),(function(){return w([])}))},ne=function(){Object(v.c)(v.a.getTimeServiceList,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({serviceName:C||"",productId:S||""},$),{loading:!0}).then((function(e){X(e.data.list),_((function(t){return Object.assign(s()(t),{totalRows:e.data.pager.totalRows})}))}))},re=function(e,t){q(e),g(!0),n(t)};return d.a.createElement("div",{id:"cloud-time"},d.a.createElement(m.a,{title:"云端定时"},d.a.createElement("div",{className:"top-select"},d.a.createElement(l.a,{style:{width:200},allowClear:!0,onChange:function(e){return I(e)}},h&&h.map((function(e){return d.a.createElement(H,{key:e.productId,value:e.productId},e.productName)}))))),d.a.createElement("div",{className:"comm-shadowbox setp-tip"},d.a.createElement("div",{className:"step-title"},d.a.createElement("img",{src:b.a,alt:""}),d.a.createElement("span",null,"云端定时步骤")),d.a.createElement(i.a,{current:-1,initial:0},d.a.createElement(V,{title:"创建定时功能",description:"可以使用产品的控制数据功能的点，创建定时功能。"}),d.a.createElement(V,{title:"发布定时功能",description:"定时功能确认无误后，可以发布到Clife或您创建的App上。"}),d.a.createElement(V,{title:"App端配置",description:"在App端基于已经发布的定时功能，配置定时任务。"}),d.a.createElement(V,{title:"App端应用",description:"满足定时任务的触发条件后，自动发送指令控制设备。"}))),d.a.createElement("div",{className:"comm-shadowbox device-content"},d.a.createElement("div",{className:"content-top"},d.a.createElement("div",{className:"content-top-left"},d.a.createElement(K,{placeholder:"请输入功能名称",allowClear:!0,enterButton:!0,style:{width:465},onSearch:function(e){return D(e)}})),d.a.createElement(a.a,{type:"primary",onClick:function(){return f(!0)}},"创 建")),d.a.createElement(r.a,{rowKey:"serviceId",dataSource:G,columns:F,pagination:{defaultCurrent:1,current:$.pageIndex,onChange:function(e,t){_((function(n){return Object.assign(s()(n),{pageIndex:t===$.pageRows?e:1,pageRows:t})}))},pageSize:$.pageRows,total:$.totalRows,showQuickJumper:!0}})),u&&d.a.createElement(Z,{visible:u,type:"add",allProductList:h,onCancel:function(){f(!1),ne()}}),P&&d.a.createElement(Z,{visible:P,type:"edit",allProductList:h,editData:R,onCancel:function(){x(!1),ne()}}),O&&d.a.createElement(B,{visible:O,operate:t,changeStatus:Y,updateOkHandle:function(){return e=t,Object(v.c)(v.a.updateTimeServiceStatus,{serviceId:Y.serviceId,productId:Y.productId,status:e},{loading:!0}).then((function(e){})),g(!1),void ne();var e},updateCancelHandle:function(){return g(!1)}}))}},mU7p:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r={0:"开发中",1:"已发布",2:"审核中"},a={1:"草稿",2:"审核中",3:"灰度版本",4:"正式版本"},c={1:"SDK开发",2:"在线拖拽"},o={0:"草稿",1:"已发布",2:"删除"},i=[{value:"已入网 ",key:"1 "},{key:"0 ",value:"未入网 "}]}}]);